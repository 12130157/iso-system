
# Table "THANH VIEN"
#********************************
iso.sql.getThanhVienByTenDangNhapAndMatKhau = SELECT A.ID AS MaThanhVien, A.Ten_DN AS TenDangNhap, A.Mat_khau AS MatKhau, A.Ma_vai_tro AS MaVaiTro, A.Ngay_tao AS NgayTao, A.Ngay_truy_cap_cuoi AS NgayTruyCapCuoi, A.Ngay_cap_nhat_cuoi AS NgayCapNhatCuoi, A.User1,A.User2,A.User3,A.User4,A.User5, A.Ma_bo_phan AS MaBoPhan, B.Ten AS TenBoPhan FROM ThanhVien A INNER JOIN Khoa_TrungTam AS B ON A.Ma_bo_phan = B.ID WHERE A.Ten_DN=? AND A.Mat_khau=? 
iso.sql.getMatKhauByTenDangNhap = select Mat_khau from thanhvien where ten_dn = ?
iso.sql.getThanhVienByMaVaiTro = SELECT A.ID AS MaThanhVien, A.Ten_DN AS TenDangNhap, A.Mat_khau AS MatKhau, B.Ho as Ho, B.Ten_lot as TenLot, B.Ten AS Ten, C.Ten_vai_tro As TenVaiTro,A.Ma_vai_tro AS MaVaiTro, B.Tinh_trang as TinhTrang, B.Email As Email, A.Ngay_tao AS NgayTao, A.Ngay_truy_cap_cuoi AS NgayTruyCapCuoi, A.Ngay_cap_nhat_cuoi AS NgayCapNhatCuoi, A.User1,A.User2,A.User3,A.User4,A.User5 FROM ThanhVien A INNER JOIN ChiTietThanhVien B ON A.Ten_DN=B.Ten_dang_nhap INNER JOIN VaiTro C ON A.Ma_vai_tro=C.ID WHERE A.Ma_vai_tro=?
admin.sql.getAllThanhVien = SELECT A.ID AS MaThanhVien, A.Ten_DN AS TenDangNhap, A.Mat_khau AS MatKhau, B.Ho as Ho, B.Ten_lot as TenLot, B.Ten AS Ten, C.Ten_vai_tro As TenVaiTro,A.Ma_vai_tro AS MaVaiTro, B.Tinh_trang as TinhTrang, B.Email As Email, A.Ngay_tao AS NgayTao, A.Ngay_truy_cap_cuoi AS NgayTruyCapCuoi, A.Ngay_cap_nhat_cuoi AS NgayCapNhatCuoi, A.User1,A.User2,A.User3,A.User4,A.User5, A.Ma_bo_phan As MaBoPhan FROM ThanhVien A INNER JOIN ChiTietThanhVien B ON A.Ten_DN=B.Ten_dang_nhap INNER JOIN VaiTro C ON A.Ma_vai_tro=C.ID 
admin.sql.TimThanhVienByMaVaiTro = SELECT A.ID AS MaThanhVien, A.Ten_DN AS TenDangNhap, A.Mat_khau AS MatKhau, B.Ho as Ho, B.Ten_lot as TenLot, B.Ten AS Ten, C.Ten_vai_tro As TenVaiTro,A.Ma_vai_tro AS MaVaiTro, B.Tinh_trang as TinhTrang, B.Email As Email, A.Ngay_tao AS NgayTao, A.Ngay_truy_cap_cuoi AS NgayTruyCapCuoi, A.Ngay_cap_nhat_cuoi AS NgayCapNhatCuoi, A.User1,A.User2,A.User3,A.User4,A.User5 FROM ThanhVien A INNER JOIN ChiTietThanhVien B ON A.Ten_DN=B.Ten_dang_nhap INNER JOIN VaiTro C ON A.Ma_vai_tro=C.ID where A.Ma_vai_tro=? and ((B.Ho + ' ' + B.Ten_lot + ' ' + B.Ten) like N'%'+?+'%' or B.Email like N'%'+ ? +'%')
admin.sql.TimThanhVien = SELECT A.ID AS MaThanhVien, A.Ten_DN AS TenDangNhap, A.Mat_khau AS MatKhau, B.Ho as Ho, B.Ten_lot as TenLot, B.Ten AS Ten, C.Ten_vai_tro As TenVaiTro,A.Ma_vai_tro AS MaVaiTro, B.Tinh_trang as TinhTrang, B.Email As Email, A.Ngay_tao AS NgayTao, A.Ngay_truy_cap_cuoi AS NgayTruyCapCuoi, A.Ngay_cap_nhat_cuoi AS NgayCapNhatCuoi, A.User1,A.User2,A.User3,A.User4,A.User5 FROM ThanhVien A INNER JOIN ChiTietThanhVien B ON A.Ten_DN=B.Ten_dang_nhap INNER JOIN VaiTro C ON A.Ma_vai_tro=C.ID where (B.Ho + ' ' + B.Ten_lot + ' ' + B.Ten) like N'%'+?+'%' or B.Email like N'%'+ ? +'%'
admin.sql.getChiTietThanhVienByMaThanhVien = SELECT A.ID AS MaThanhVien, A.Ten_DN AS TenDangNhap, A.Mat_khau AS MatKhau,G.ID AS MaKhoa, B.chung_minh_nhan_dan AS CMNN,F.So_tai_khoan AS SoTaiKhoan,F.Ngan_hang AS NganHang,F.Ngay_lap_the AS NgayLapThe, B.Ho AS Ho, B.Ten_lot AS TenLot, B.Ten AS Ten, C.Ten_vai_tro AS TenVaiTro,A.Ma_vai_tro AS MaVaiTro, B.ngay_sinh AS NgaySinh, B.Tinh_trang AS TinhTrang, B.Email AS Email, D.so_nha AS SoNha, D.duong AS Duong, D.Phuong_xa AS PhuongXa, D.Quan_huyen AS QuanHuyen, D.Tinh_Thanhpho AS ThanhPho,B.dien_thoai_dd AS DienThoaiDD, D.dien_thoai_nha AS DienThoaiNha, E.Loai_bang AS LoaiBang, E.Truong_cap AS TruongCap, E.Nam_tot_nghiep AS NamTotNghiep, E.Loai_tot_nghiep AS LoaiTotNghiep,A.Ngay_tao AS NgayTao, A.Ngay_truy_cap_cuoi AS NgayTruyCapCuoi, A.Ngay_cap_nhat_cuoi AS NgayCapNhatCuoi FROM ThanhVien A INNER JOIN ChiTietThanhVien B ON A.Ten_DN = B.Ten_dang_nhap INNER JOIN VaiTro C ON A.Ma_vai_tro = C.ID LEFT JOIN diachi D ON B.Ma_dia_chi = D.ID LEFT JOIN bangcap E ON B.Ma_bang_cap = E.ID LEFT JOIN  taikhoan F ON B.Ma_tai_khoan = F.ID INNER JOIN Khoa_TrungTam G ON A.Ma_bo_phan = G.ID WHERE a.id = ?
admin.sql.updateTinhTrangByTenDangNhap = update chitietthanhvien set tinh_trang = ? where ten_dang_nhap = ?
admin.sql.getAllThanhVienByVaiTro = SELECT A.ID AS MaThanhVien, A.Ten_DN AS TenDangNhap, A.Mat_khau AS MatKhau, B.Ho as Ho, B.Ten_lot as TenLot, B.Ten AS Ten, C.Ten_vai_tro As TenVaiTro,A.Ma_vai_tro AS MaVaiTro, B.Tinh_trang as TinhTrang, B.Email As Email, A.Ngay_tao AS NgayTao, A.Ngay_truy_cap_cuoi AS NgayTruyCapCuoi, A.Ngay_cap_nhat_cuoi AS NgayCapNhatCuoi, A.User1,A.User2,A.User3,A.User4,A.User5 FROM ThanhVien A INNER JOIN ChiTietThanhVien B ON A.Ten_DN=B.Ten_dang_nhap INNER JOIN VaiTro C ON A.Ma_vai_tro=C.ID WHERE C.ID = ? or C.ID = ? or C.ID = ?
admin.sql.getAllThanhVienByVaiTroSV = SELECT A.ID AS MaThanhVien, A.Ten_DN AS TenDangNhap, A.Mat_khau AS MatKhau, B.Ho as Ho, B.Ten_lot as TenLot, B.Ten AS Ten, C.Ten_vai_tro As TenVaiTro,A.Ma_vai_tro AS MaVaiTro, B.Tinh_trang as TinhTrang, B.Email As Email, A.Ngay_tao AS NgayTao, A.Ngay_truy_cap_cuoi AS NgayTruyCapCuoi, A.Ngay_cap_nhat_cuoi AS NgayCapNhatCuoi, A.User1,A.User2,A.User3,A.User4,A.User5 FROM ThanhVien A INNER JOIN ChiTietThanhVien B ON A.Ten_DN=B.Ten_dang_nhap INNER JOIN VaiTro C ON A.Ma_vai_tro=C.ID WHERE C.ID = ?
admin.sql.ShowChiTietThanhVienByMaCar = select A.Ten_dang_nhap AS TenDangNhap, A.Ho As hoThanhVien, A.Ten_lot As TenLot, A.Ten As TenThanhVien, A.Ngay_sinh AS NgaySinh, A.Ma_dia_chi AS MaDiaChi, A.Email As Email, A.Dien_thoai_dd As DienThoaiDiDong, A.Ma_bang_cap AS MaBangCap, A.Ngay_bat_dau AS NgayBatDau, A.Ngay_ket_thuc AS NgayKetThuc, A.Ma_tai_khoan AS MaTaiKhoan, A.Tinh_trang AS TinhTrang,A.Chung_minh_nhan_dan AS ChungMinhNhanDan, A.Ma_lop_hoc AS MaLopHoc, A.User1,A.User2,A.User3,A.User4,A.User5 FROM ChiTietThanhVien A INNER JOIN ThanhVien B ON B.Ten_DN = A.Ten_dang_nhap where B.user1 = ? 

admin.sql.countThanhVien = select COUNT(*) AS TotalRows from ThanhVien
iso.sql.getAllGiaoVienOrderByTen = SELECT A.ID AS MaThanhVien, B.Ho AS Ho, B.Ten_Lot As TenLot, B.Ten As Ten, C.ID AS MaBoPhan FROM ThanhVien AS A INNER JOIN ChiTietThanhVien As B on A.Ten_DN = B.Ten_dang_nhap INNER JOIN Khoa_TrungTam AS C ON A.Ma_bo_phan = C.ID WHERE A.Ma_vai_tro <> ? ORDER BY B.Ho, B.Ten_lot, B.Ten

diemDanh.sql.getMaGiaoVienByMaThe = select ID AS MaThanhVien from thanhvien where User1 = ?

iso.sql.getThanhVienByMaKhoa=SELECT A.ID,B.Ho,B.Ten_lot,B.Ten FROM THANHVIEN AS A,CHITIETTHANHVIEN AS B WHERE A.TEN_DN=B.TEN_DANG_NHAP AND A.MA_BO_PHAN=?



# Table "PHAN LOP HOC CHO SINH VIEN"
#********************************
admin.sql.getAllKhoaCoSinhVien = SELECT B.ID AS MaKhoa, B.Ten AS TenKhoa FROM thanhvien A INNER JOIN khoa_trungtam B ON A.Ma_bo_phan = B.ID INNER JOIN chitietthanhvien C ON A.Ten_DN = C.Ten_dang_nhap WHERE A.Ma_vai_tro = 9
admin.sql.getAllSinhVienByMaKhoa = SELECT C.Ho AS HoThanhVien, C.Ten_lot AS TenLot, C.Ten AS TenThanhVien FROM thanhvien A INNER JOIN khoa_trungtam B ON A.Ma_bo_phan = B.ID INNER JOIN chitietthanhvien C ON A.Ten_DN = C.Ten_dang_nhap WHERE A.Ma_vai_tro = 9 AND B.ID = ?
admin.sql.getAllLopByMaKhoa = SELECT A.ID AS MaLop, B.Ten_chuyen_nganh AS TenChuyenNganh, B.Ki_hieu AS KiHieu FROM LOPHOC A INNER JOIN CHUYENNGANH B ON A.MA_CHUYEN_NGANH = B.ID WHERE B.MA_KHOATT = ?

# Table "VAI TRO"
#********************************
iso.sql.getVaiTroByID = SELECT A.ID AS MaVaiTro, A.Ten_vai_tro AS TenVaiTro, A.Ngay_cap_nhat_cuoi AS NgayCapNhatCuoi, A.User1,A.User2,A.User3,A.User4,A.User5 FROM VaiTro A WHERE ID=? 
iso.sql.getAllVaiTro = SELECT A.ID AS MaVaiTro, A.Ten_vai_tro AS TenVaiTro, A.Ngay_cap_nhat_cuoi AS NgayCapNhatCuoi, A.User1,A.User2,A.User3,A.User4,A.User5 FROM VaiTro A ORDER BY A.Ten_vai_tro
admin.sql.getAllVaiTro = select A.ID AS MaVaiTro,  A.ten_vai_tro AS TenVaiTro, A.ngay_cap_nhat_cuoi AS NgayCapNhatCuoi from vaitro A order by A.ten_vai_tro
admin.sql.getVaiTroBayTenVaiTro = select A.ID AS MaVaiTro,  A.ten_vai_tro AS TenVaiTro, A.ngay_cap_nhat_cuoi AS NgayCapNhatCuoi from vaitro A where A.ten_vai_tro = ?

# Table "KHOA TRUNG TAM"
#********************************
admin.sql.getKhoaByTenKhoa = select A.ID AS MaKhoa,  A.Ten AS TenKhoa, A.Ma_truong_khoa AS MaTruongKhoa, A.Ngay_tao AS NgayTao, A.Nguoi_tao AS NguoiTao, A.ngay_cap_nhat_cuoi AS NgayCapNhatCuoi from Khoa_TrungTam A where A.ten = ?
admin.sql.getAllKhoa =  SELECT A.ID AS MaKhoa,  A.Ten AS TenKhoa , C.Ho + ' ' + C.Ten_lot +' ' + C.Ten As TenTruongKhoa, B.Ten_DN AS NguoiTao FROM Khoa_TrungTam AS A INNER JOIN thanhvien AS B ON A.ma_truong_khoa = B.ID INNER JOIN ChiTietThanhVien AS C ON B.Ten_DN=C.Ten_dang_nhap

# Table "CHI TIET THANH VIEN"
#********************************
iso.sql.getChiTietThanhVienByTenDangNhap = SELECT A.Ten_dang_nhap AS TenDangNhap, A.Ho As hoThanhVien, A.Ten_lot As TenLot, A.Ten As TenThanhVien, A.Ngay_sinh AS NgaySinh, A.Ma_dia_chi AS MaDiaChi, A.Email As Email, A.Dien_thoai_dd As DienThoaiDiDong, A.Ma_bang_cap AS MaBangCap, A.Ngay_bat_dau AS NgayBatDau, A.Ngay_ket_thuc AS NgayKetThuc, A.Ma_tai_khoan AS MaTaiKhoan, A.Tinh_trang AS TinhTrang,A.Chung_minh_nhan_dan AS ChungMinhNhanDan, ISNULL(A.Ma_lop_hoc,'') AS MaLopHoc, ISNULL(B.Ki_Hieu,'') AS KiHieuLop, A.User1,A.User2,A.User3,A.User4,A.User5 FROM ChiTietThanhVien A LEFT JOIN LopHoc AS B ON B.ID = A.Ma_lop_hoc WHERE A.Ten_dang_nhap=? 
iso.sql.getEmailByMaVaiTro = SELECT ISNULL(B.Email,'') AS EMAIL FROM THANHVIEN A INNER JOIN ChiTietThanhVien B ON A.Ten_DN=B.Ten_dang_nhap WHERE A.Ma_vai_tro=?
iso.sql.getEmailByMaThanhVien = SELECT ISNULL(B.Email,'') AS EMAIL FROM THANHVIEN A INNER JOIN ChiTietThanhVien B ON A.Ten_DN=B.Ten_dang_nhap WHERE A.ID=?
iso.sql.getThanhVienByTenDangNhap = SELECT A.Ten_dang_nhap AS TenDangNhap,A.Email As Email, A.Ho As hoThanhVien, A.Ten_lot As TenLot, A.Ten As TenThanhVien  FROM ChiTietThanhVien A WHERE A.Ten_dang_nhap=?
iso.sql.getMatKhauByTenDangNhap = select mat_khau AS MatKhau from thanhvien where ten_dn =?
iso.sql.getTenThanhVien=SELECT Ho,Ten_lot,Ten FROM THANHVIEN,CHITIETTHANHVIEN where id=? and Ten_dang_nhap=ten_dn
iso.sql.getThanhVienByMaLopHoc = select * from chitietthanhvien a inner join thanhvien b on b.Ten_DN = a.Ten_dang_nhap where Ma_lop_hoc = ? order by a.ten
iso.sql.getThanhVienCa1ByMaLopHoc = select * from chitietthanhvien a inner join thanhvien b on b.Ten_DN = a.Ten_dang_nhap where a.Ma_lop_hoc = ? and b.User2 = ?
iso.sql.getThanhVienCa2ByMaLopHoc = select * from chitietthanhvien a inner join thanhvien b on b.Ten_DN = a.Ten_dang_nhap where a.Ma_lop_hoc = ? and b.User2 = ? 
iso.sql.SelectTopIDLopHoc = SELECT TOP 1 id FROM LopHoc ORDER BY ID
admin.sql.ShowLopHoc = select ID,Ki_hieu from lophoc
xemDiem.sql.getAllChiTietThanhVienByMaLop = select a.id as MaThanhVien, isnull(b.ho,'') as Ho, isnull(b.ten_lot, '') as TenLot, isnull(b.ten, '') as Ten from thanhvien as a inner join chitietthanhvien as b on a.ten_dn = b.ten_dang_nhap where b.ma_lop_hoc = ?

#dung de send mail
iso.sql.getEmailByMaBoPhan = SELECT ISNULL(B.Email,'') AS EMAIL FROM ThanhVien AS A INNER JOIN ChiTietThanhVien AS B ON A.Ten_DN = B.Ten_dang_nhap INNER JOIN Khoa_TrungTam AS C ON A.Ma_bo_phan = C.ID WHERE C.ID = ? 
iso.sql.getEmailOfAdmin = SELECT ISNULL(B.Email,'') AS EMAIL FROM THANHVIEN A INNER JOIN ChiTietThanhVien B ON A.Ten_DN=B.Ten_dang_nhap WHERE A.Ma_vai_tro=?
#

# Table "sys_Role_App"
#********************************
iso.sql.getSysRoleAppByRoleID = SELECT A.RoleID, A.AppID, B.App_name AS AppName, B.App_link AS AppLink, B.images AS AppImage, A.User1,A.User2,A.User3,A.User4,A.User5 FROM sys_Role_App A INNER JOIN sys_App B ON A.AppID=B.ID WHERE A.RoleID=? 

# Table "sys_Role_Menu"
#********************************
iso.sql.getSysRoleMenuByRoleID = SELECT A.RoleID, B.AppID, A.Menu_ID AS MenuID, B.Menu_name AS MenuName, B.images MenuImage, B.Menu_link AS MenuLink, A.User1,A.User2,A.User3,A.User4,A.User5 FROM sys_Role_Menu A INNER JOIN sys_Menu B ON A.Menu_ID=B.ID WHERE A.RoleID=? AND B.AppID=?

# Table "KE HOACH DAO TAO"
#********************************
iso.sql.getAllKeHoachDaoTaoAndTenNguoiLapByMaNguoiLap = SELECT A.ID As MaKeHoachDaoTao, A.Ten As TenKeHoachDaoTao, A.Nam1, A.Nam2, A.Nam3, A.Nam4, A.Nam5, A.Nam6, A.Nhiem_vu_1 As NhiemVu1, A.Nhiem_vu_2 As NhiemVu2, A.Nhiem_vu_3 As NhiemVu3, A.Nhiem_vu_4 As NhiemVu4, A.Ma_Nguoi_Lap As MaNguoiLap, cast(datepart(mm,Ngay_Lap) as varchar) + '-' + cast(datepart(dd,Ngay_Lap) as varchar) + '-' + cast(datepart(yy,Ngay_Lap) as varchar) As NgayLap, A.Ma_Nguoi_Duyet As MaNguoiDuyet, cast(datepart(mm,Ngay_Duyet) as varchar) + '-' + cast(datepart(dd,Ngay_Duyet) as varchar) + '-' + cast(datepart(yy,Ngay_Duyet) as varchar) As NgayDuyet, A.Tinh_Trang As TinhTrang, cast(datepart(mm,A.Ngay_Cap_Nhat_Cuoi) as varchar) + '-' + cast(datepart(dd,A.Ngay_Cap_Nhat_Cuoi) as varchar) + '-' + cast(datepart(yy,A.Ngay_Cap_Nhat_Cuoi) as varchar) As NgayCapNhatCuoi,  A.Ly_do_reject As LyDoReject, A.User1, A.User2, A.User3, A.User4, A.User5, ISNULL(C.Ho + ' ' + C.Ten_Lot + ' ' + C.Ten,'') As NguoiLap FROM KeHoachDaoTao As A Inner join ThanhVien As B On A.Ma_nguoi_lap = B.ID Inner join ChiTietThanhVien As C on B.Ten_DN = C.Ten_dang_nhap WHERE A.Ma_Nguoi_Lap = ? ORDER BY A.Ngay_cap_nhat_cuoi
iso.sql.getAllKeHoachDaoTaoAndTenNguoiLap = SELECT A.ID As MaKeHoachDaoTao, A.Ten As TenKeHoachDaoTao, A.Nam1, A.Nam2, A.Nam3, A.Nam4, A.Nam5, A.Nam6, A.Nhiem_vu_1 As NhiemVu1, A.Nhiem_vu_2 As NhiemVu2, A.Nhiem_vu_3 As NhiemVu3, A.Nhiem_vu_4 As NhiemVu4, A.Ma_Nguoi_Lap As MaNguoiLap, cast(datepart(mm,Ngay_Lap) as varchar) + '-' + cast(datepart(dd,Ngay_Lap) as varchar) + '-' + cast(datepart(yy,Ngay_Lap) as varchar) As NgayLap, A.Ma_Nguoi_Duyet As MaNguoiDuyet, cast(datepart(mm,Ngay_Duyet) as varchar) + '-' + cast(datepart(dd,Ngay_Duyet) as varchar) + '-' + cast(datepart(yy,Ngay_Duyet) as varchar) As NgayDuyet, A.Tinh_Trang As TinhTrang, cast(datepart(mm,A.Ngay_Cap_Nhat_Cuoi) as varchar) + '-' + cast(datepart(dd,A.Ngay_Cap_Nhat_Cuoi) as varchar) + '-' + cast(datepart(yy,A.Ngay_Cap_Nhat_Cuoi) as varchar) As NgayCapNhatCuoi, A.Ly_do_reject As LyDoReject, A.User1, A.User2, A.User3, A.User4, A.User5, (C.Ho + ' ' + C.Ten_Lot + ' ' + C.Ten) As NguoiLap FROM KeHoachDaoTao As A Inner join ThanhVien As B On A.Ma_nguoi_lap = B.ID Inner join ChiTietThanhVien As C on B.Ten_DN = C.Ten_dang_nhap ORDER BY A.Ngay_cap_nhat_cuoi
iso.sql.duyetKeHoachDaoTaoByMaKeHoach = Update KeHoachDaoTao Set Ma_nguoi_duyet=?, Tinh_Trang = ?, Ngay_duyet = getdate(), Ly_do_reject = ? Where ID = ?
iso.sql.getKeHoachDaoTaoByID = SELECT A.ID As MaKeHoachDaoTao, A.Ten As TenKeHoachDaoTao, A.Nam1, A.Nam2, A.Nam3, A.Nam4, A.Nam5, A.Nam6, A.Nhiem_vu_1 As NhiemVu1, A.Nhiem_vu_2 As NhiemVu2, A.Nhiem_vu_3 As NhiemVu3, A.Nhiem_vu_4 As NhiemVu4, A.Ma_Nguoi_Lap As MaNguoiLap, convert(varchar(20),A.Ngay_lap,110) As NgayLap, convert(varchar(20),A.Ngay_lap,108) As GioLap, A.Ma_Nguoi_Duyet As MaNguoiDuyet, convert(varchar(20),A.Ngay_duyet,110) As NgayDuyet, convert(varchar(20),A.Ngay_duyet,108) As GioDuyet, A.Tinh_Trang As TinhTrang, convert(varchar(20),A.Ngay_cap_nhat_cuoi,110) As NgayCapNhatCuoi, convert(varchar(20),A.Ngay_cap_nhat_cuoi,108) As GioCapNhatCuoi, A.Ly_do_reject As LyDoReject, A.User1, A.User2, A.User3, A.User4, A.User5, ISNULL(C.Ho + ' ' + C.Ten_Lot + ' ' + C.Ten,'') As NguoiLap, ISNULL((E.Ho + ' ' + E.Ten_Lot + ' ' + E.Ten),'') As NguoiDuyet, Convert(varchar(10),A.Ngay_gui, 110) As NgayGui, Convert(varchar(10),A.Ngay_gui, 108) As GioGui, A.Bo_sung As BoSung FROM KeHoachDaoTao As A Inner join ThanhVien As B On A.Ma_nguoi_lap = B.ID Inner join ChiTietThanhVien As C on B.Ten_DN = C.Ten_dang_nhap Left join ThanhVien As D On A.Ma_nguoi_duyet = D.ID Left join ChiTietThanhVien As E on D.Ten_DN = E.Ten_dang_nhap WHERE A.ID= ?
iso.sql.getAllKeHoachDaoTaoApproved = SELECT A.ID As MaKeHoachDaoTao, A.Ten As TenKeHoachDaoTao, A.Nam1 As Nam1, A.Nam2 As Nam2, A.Ma_nguoi_lap As MaNguoiLap FROM KeHoachDaoTao As A WHERE A.Tinh_trang = ?
iso.sql.getAllKeHoachDaoTaoNewOrReject = SELECT A.ID As MaKeHoachDaoTao, A.Ten As TenKeHoachDaoTao, A.Nam1 As Nam1, A.Nam2 As Nam2, A.Ma_nguoi_lap As MaNguoiLap FROM KeHoachDaoTao As A WHERE A.Tinh_trang = ? or A.Tinh_trang = ? 
iso.sql.getSumKeHoachDaoTao = SELECT COUNT(A.ID) As TongSoKeHoach FROM KeHoachDaoTao As A
iso.sql.getAllKeHoachOfTableByID = SELECT A.ID As MaKeHoachDaoTao, A.Ten As TenKeHoachDaoTao, A.Nam1, A.Nam2, A.Nam3, A.Nam4, A.Nam5, A.Nam6, A.Nhiem_vu_1 As NhiemVu1, A.Nhiem_vu_2 As NhiemVu2, A.Nhiem_vu_3 As NhiemVu3, A.Nhiem_vu_4 As NhiemVu4, A.Ma_Nguoi_Lap As MaNguoiLap, convert(varchar(20),A.Ngay_lap,110) As NgayLap, convert(varchar(20),A.Ngay_lap,108) As GioLap, A.Ma_Nguoi_Duyet As MaNguoiDuyet, convert(varchar(20),A.Ngay_duyet,110) As NgayDuyet, convert(varchar(20),A.Ngay_duyet,108) As GioDuyet, A.Tinh_Trang As TinhTrang, convert(varchar(20),A.Ngay_cap_nhat_cuoi,110) As NgayCapNhatCuoi, convert(varchar(20),A.Ngay_cap_nhat_cuoi,108) As GioCapNhatCuoi, A.Ly_do_reject As LyDoReject, A.User1 AS User1TableKHDT, A.User2  AS User2TableKHDT, A.User3  AS User3TableKHDT, A.User4  AS User4TableKHDT, A.User5 AS User5TableKHDT, ISNULL(G.Ho + ' ' + G.Ten_Lot + ' ' + G.Ten,'') As NguoiLap, ISNULL((I.Ho + ' ' + I.Ten_Lot + ' ' + I.Ten),'') As NguoiDuyet, Convert(varchar(10),A.Ngay_gui, 110) As NgayGui, Convert(varchar(10),A.Ngay_gui, 108) As GioGui, A.Bo_sung As BoSungTableKHDT, B.ID AS MaChiTietKHDT, Convert(varchar(10),B.Tu_ngay,110) AS TuNgay, Convert(varchar(10),B.Den_ngay,110) AS DenNgay, B.Ma_nam_hoc AS MaNamHoc, B.Tuan AS Tuan, B.Tinh_trang_phan_cong_tac AS TinhTrangPhanCongTableChiTietKHDT, B.User1 AS User1TableChiTietKHDT,B.User2 AS User2TableChiTietKHDT,B.User3 AS User3TableChiTietKHDT, B.User4 AS User4TableChiTietKHDT,B.User5 AS User5TableChiTietKHDT, J.So_thu_tu As ThuTuTuan, C.ID AS MaNoiDungChiTietKHDT, C.Ma_cong_tac As MaCongTac, C.Khoa, C.Noi_dung_cong_tac As NoiDungCongTac, C.Tinh_trang_thuc_hien As TinhTrangThucHienTableNoiDungKHDT, C.Bo_sung As BoSungTableNoiDungKHDT, ('<+na+>' + IsNull(C.Ghi_chu,'') + '<-reg->' + Cast(C.Gio As varchar) + '<-reg->' + Cast(C.Phut As varchar) + '<-reg->' + Cast(C.Buoi As varchar) + '<-reg->' + Cast(C.Thu As Varchar) + '<-reg->' + Convert(varchar(10), C.Ngay, 101)) As ThoiGian, C.User1 AS User1TableNoiDungKHDT,C.User2 AS User2TableNoiDungKHDT, C.User3 AS User3TableNoiDungKHDT,C.User4 AS User4TableNoiDungKHDT,C.User5 AS User5TableNoiDungKHDT, C.Thu As Thu, C.Buoi As Buoi, C.Ngay As Ngay, C.Gio As Gio, C.Phut As Phut, C.Tinh_trang_phan_cong As TinhTrangPhanCong, D.ID AS MaBoPhanThucHien, D.Ma_khoa As MaKhoa, D.Ten_bo_phan As TenBoPhan, D.User1  AS User1TableBoPhanKHDT,D.User2 AS User2TableBoPhanKHDT,D.User3 AS User3TableBoPhanKHDT, D.User4 AS User4TableBoPhanKHDT,D.User5 AS User5TableBoPhanKHDT, E.ID AS MaNguoiThucHien, E.Ma_thanh_vien As MaThanhVien, ISNULL(L.Ho + ' ' + L.Ten_Lot + ' ' + L.Ten,'') As TenThanhVien, E.Tinh_trang_thuc_hien As TinhTrangThucHienTableNguoiThucHien, E.User1 AS User1TableNguoiThucHienKHDT,E.User2 AS User2TableNguoiThucHienKHDT, E.User3 AS User3TableNguoiThucHienKHDT,E.User4 AS User4TableNguoiThucHienKHDT,E.User5  AS User5TableNguoiThucHienKHDT FROM KeHoachDaoTao AS A LEFT JOIN ChiTietKHDT AS B ON A.ID = B.Ma_ke_hoach LEFT JOIN NoiDungChiTietKHDT AS C ON C.Ma_chi_tiet_KHDT = B.ID LEFT JOIN BoPhanThucHienKHDT AS D ON D.Ma_noi_dung_chi_tiet_KHDT = C.ID LEFT JOIN NguoiThucHien AS E ON D.ID = E.Ma_bo_phan LEFT JOIN ThanhVien AS F ON A.Ma_nguoi_lap = F.ID LEFT JOIN ChiTietThanhVien AS G ON F.Ten_DN = G.Ten_dang_nhap LEFT JOIN ThanhVien AS H ON A.Ma_nguoi_duyet = H.ID LEFT JOIN ChiTietThanhVien AS I ON H.Ten_DN = I.Ten_dang_nhap LEFT JOIN TuanLe AS J ON B.Tuan = J.ID LEFT JOIN ThanhVien AS K ON E.Ma_thanh_vien = K.ID LEFT JOIN ChiTietThanhVien AS L ON K.Ten_DN = L.Ten_dang_nhap WHERE A.ID = ? ORDER BY B.Tu_ngay, C.Khoa,  C.ID, D.ID, E.ID

# Table "CHI TIET KE HOACH DAO TAO"
#********************************
iso.sql.getChiTietKHDTByMaKeHoach = SELECT A.ID,A.Ma_ke_hoach AS MaKeHoach, Convert(varchar(10),A.Tu_ngay,110) AS TuNgay, Convert(varchar(10),A.Den_ngay,110) AS DenNgay, A.Ma_nam_hoc AS MaNamHoc, A.Tuan AS Tuan, A.Ngay_cap_nhat_cuoi AS NgayCapNhatCuoi, A.User1,A.User2,A.User3,A.User4,A.User5, B.So_thu_tu As ThuTuTuan FROM ChiTietKHDT A INNER JOIN TuanLe As B On A.Tuan = B.ID WHERE A.Ma_ke_hoach=?
iso.sql.getChiTietKHDTByID = SELECT A.ID, Convert(varchar(10), A.Tu_ngay, 110) As TuNgay, Convert(varchar(10), A.Den_ngay, 110) As DenNgay, A.Ghi_chu As GhiChu, A.Tinh_trang_phan_cong_tac As TinhTrangPhanCongTac, A.User1,A.User2,A.User3,A.User4,A.User5 FROM ChiTietKHDT As A WHERE A.ID = ?
iso.sql.GetChiTietJoinAllTableByMaKHDTAndNgay = SELECT B.ID AS MaChiTietKHDT, Convert(varchar(10),B.Tu_ngay,110) AS TuNgay, Convert(varchar(10),B.Den_ngay,110) AS DenNgay, B.Ma_nam_hoc AS MaNamHoc, B.Tuan AS Tuan, B.Tinh_trang_phan_cong_tac AS TinhTrangPhanCongTableChiTietKHDT, ('<+na+>' + IsNull(C.Ghi_chu,'') + '<<->>' + Cast(C.Gio As varchar) + '<<->>' + Cast(C.Phut As varchar) + '<<->>' + Cast(C.Buoi As varchar) + '<<->>' + Cast(C.Thu As Varchar) + '<<->>' + Convert(varchar(10), C.Ngay, 101)) As ThoiGian, B.User1 AS User1TableChiTietKHDT,B.User2 AS User2TableChiTietKHDT,B.User3 AS User3TableChiTietKHDT, B.User4 AS User4TableChiTietKHDT,B.User5 AS User5TableChiTietKHDT, J.So_thu_tu As ThuTuTuan, C.ID AS MaNoiDungChiTietKHDT, C.Ma_cong_tac As MaCongTac, C.Khoa, C.Noi_dung_cong_tac As NoiDungCongTac, C.Tinh_trang_thuc_hien As TinhTrangThucHienTableNoiDungKHDT, C.Bo_sung As BoSungTableNoiDungKHDT, C.User1 AS User1TableNoiDungKHDT,C.User2 AS User2TableNoiDungKHDT, C.User3 AS User3TableNoiDungKHDT,C.User4 AS User4TableNoiDungKHDT,C.User5 AS User5TableNoiDungKHDT, C.Thu As Thu, C.Buoi As Buoi, C.Ngay As Ngay, C.Gio As Gio, C.Phut As Phut, C.Tinh_trang_phan_cong As TinhTrangPhanCong, D.ID AS MaBoPhanThucHien, D.Ma_khoa As MaKhoa, D.Ten_bo_phan As TenBoPhan, D.User1  AS User1TableBoPhanKHDT,D.User2 AS User2TableBoPhanKHDT,D.User3 AS User3TableBoPhanKHDT, D.User4 AS User4TableBoPhanKHDT,D.User5 AS User5TableBoPhanKHDT, E.ID AS MaNguoiThucHien, E.Ma_thanh_vien As MaThanhVien, ISNULL(L.Ho + ' ' + L.Ten_Lot + ' ' + L.Ten,'') As TenThanhVien, E.Tinh_trang_thuc_hien As TinhTrangThucHienTableNguoiThucHien, E.User1 AS User1TableNguoiThucHienKHDT,E.User2 AS User2TableNguoiThucHienKHDT, E.User3 AS User3TableNguoiThucHienKHDT,E.User4 AS User4TableNguoiThucHienKHDT,E.User5  AS User5TableNguoiThucHienKHDT FROM ChiTietKHDT AS B LEFT JOIN NoiDungChiTietKHDT AS C ON C.Ma_chi_tiet_KHDT = B.ID LEFT JOIN BoPhanThucHienKHDT AS D ON D.Ma_noi_dung_chi_tiet_KHDT = C.ID LEFT JOIN NguoiThucHien AS E ON D.ID = E.Ma_bo_phan INNER JOIN TuanLe AS J ON B.Tuan = J.ID LEFT JOIN ThanhVien AS K ON E.Ma_thanh_vien = K.ID LEFT JOIN ChiTietThanhVien AS L ON K.Ten_DN = L.Ten_dang_nhap WHERE B.Tuan = ? And B.Ma_ke_hoach = ? ORDER BY B.Tu_ngay, C.Khoa, C.ID, D.ID, E.ID

# Table "NOI DUNG CHI TIET KE HOACH DAO TAO"
#********************************
iso.sql.getNoiDungKHDTByMaChiTietKHDT = SELECT A.ID, A.Ma_chi_tiet_KHDT As MaChiTietKHDT, A.Ma_cong_tac As MaCongTac, A.Khoa, A.Noi_dung_cong_tac As NoiDungCongTac, A.Ngay_cap_nhat_cuoi As NgayCapNhatCuoi, A.Tinh_trang_thuc_hien As TinhTrangThucHien, A.Bo_sung As BoSung, A.User1,A.User2,A.User3,A.User4,A.User5, A.Thu As Thu, A.Buoi As Buoi, A.Ngay As Ngay, A.Gio As Gio, A.Phut As Phut, Ghi_chu As GhiChu, A.Tinh_trang_phan_cong As TinhTrangPhanCong FROM NoiDungChiTietKHDT As A WHERE A.Ma_chi_tiet_KHDT = ?
iso.sql.getNoiDungPhanCongByMaChiTietKHDT = SELECT A.ID, A.Ma_chi_tiet_KHDT As MaChiTietKHDT, A.Ma_cong_tac As MaCongTac, A.Khoa, A.Noi_dung_cong_tac As NoiDungCongTac, A.Bo_sung As BoSung, A.User1,A.User2,A.User3,A.User4,A.User5, A.Thu As Thu, A.Buoi As Buoi, Convert(varchar(10), A.Ngay, 110) As Ngay, A.Gio As Gio, A.Phut As Phut, Ghi_chu As GhiChu, A.Tinh_trang_phan_cong As TinhTrangPhanCong FROM NoiDungChiTietKHDT As A WHERE A.Ma_chi_tiet_KHDT = ? ORDER BY A.Thu,A.Buoi, Cast(A.Gio As Int), Cast(A.Phut AS Int), A.Noi_dung_cong_tac


# Table "BO PHAN THUC HIEN KE HOACH DAO TAO"
#********************************
iso.sql.getBoPhanThucHienByMaNoiDungKHDT = SELECT A.ID, A.Ma_noi_dung_chi_tiet_KHDT As MaNoiDungChiTietKHDT, A.Ma_khoa As MaKhoa, A.Ten_bo_phan As TenBoPhan, A.Ngay_cap_nhat_cuoi As NgayCapNhatCuoi, A.User1,A.User2,A.User3,A.User4,A.User5 FROM BoPhanThucHienKHDT As A WHERE A.Ma_noi_dung_chi_tiet_KHDT = ?

# Table "NGUOI THUC HIEN KE HOACH DAO TAO"
#********************************
iso.sql.getNguoiThucHienKHDTByMaBoPhanThucHienKHDT = SELECT A.ID, A.Ma_bo_phan As MaBoPhan, A.Ma_thanh_vien As MaThanhVien, A.Ten_thanh_vien As TenThanhVien, A.Ngay_cap_nhat_cuoi As NgayCapNhatCuoi, A.Tinh_trang_thuc_hien As TinhTrangThucHien, A.User1,A.User2,A.User3,A.User4,A.User5 FROM NguoiThucHien As A WHERE A.Ma_bo_phan = ?

# Table "QUYETDINH"
#********************************
iso.sql.GetAllQuyetDinh = SELECT A.ID As MaQuyetDinh, A.Ma_KHDT As MaKHDT, A.Ki_hieu As KiHieu, A.Ma_khoa As MaKhoa, A.Ten As TenQuyetDinh, A.Nam_bat_dau As NamBatDau, A.Ma_he_dao_tao As MaHeDaoTao, D.Ten As TenHeDaoTao, D.So_nam As SoNamDaoTao, A.Thong_tin_chung As ThongTinChung, A.Dieu_mot As DieuMot, A.Tu_thang As TuThang, A.Den_thang As DenThang, A.Ma_nguoi_lap As MaNguoiLap, (C.Ho+' '+C.Ten_lot+' '+C.Ten) As TenNguoiLap, convert(varchar(20),Ngay_Lap,105) As NgayLap, A.Ma_nguoi_duyet As MaNguoiDuyet, ISNULL((F.Ho + ' ' + F.Ten_Lot + ' ' + F.Ten),'') As TenNguoiDuyet, convert(varchar(20),Ngay_duyet,105) As Ngayduyet, A.Tinh_trang As TinhTrang, A.Noi_nhan As NoiNhan, A.Quyet_dinh_so As QuyetDinhSo, convert(varchar(20),A.Ngay_ra_QD_UBND,105) As NgayRaQD, A.Tong_so_hoc_sinh As TongSoHocSinh, A.Tong_so_chuyen_nganh As TongSoChuyenNganh,A.User1, A.User2, A.User3, A.User4, A.User5, A.Ly_do_reject As LyDoReject, convert(varchar(20),A.Ngay_cap_nhat_cuoi,105) As NgayCapnhatCuoi FROM QUYETDINHMOLOP As A INNER JOIN THANHVIEN As B ON A.Ma_Nguoi_Lap = B.ID INNER JOIN CHITIETTHANHVIEN As C ON B.Ten_DN = C.Ten_Dang_Nhap INNER JOIN HeDaoTao As D ON A.Ma_he_dao_tao = D.ID LEFT JOIN ThanhVien As E On A.Ma_nguoi_duyet = E.ID LEFT JOIN ChiTietThanhVien As F on E.Ten_DN = F.Ten_dang_nhap ORDER BY A.Ngay_lap
iso.sql.GetAllQuyetDinhByNguoiLap = SELECT A.ID As MaQuyetDinh, A.Ma_KHDT As MaKHDT, A.Ki_hieu As KiHieu, A.Ma_khoa As MaKhoa, A.Ten As TenQuyetDinh, A.Nam_bat_dau As NamBatDau, A.Ma_he_dao_tao As MaHeDaoTao, D.Ten As TenHeDaoTao, D.So_nam As SoNamDaoTao, A.Thong_tin_chung As ThongTinChung, A.Dieu_mot As DieuMot, A.Tu_thang As TuThang, A.Den_thang As DenThang, A.Ma_nguoi_lap As MaNguoiLap, (C.Ho+' '+C.Ten_lot+' '+C.Ten) As TenNguoiLap, convert(varchar(20),Ngay_Lap,105) As NgayLap, A.Ma_nguoi_duyet As MaNguoiDuyet, ISNULL((F.Ho + ' ' + F.Ten_Lot + ' ' + F.Ten),'') As TenNguoiDuyet, convert(varchar(20),Ngay_duyet,105) As Ngayduyet, A.Tinh_trang As TinhTrang, A.Noi_nhan As NoiNhan, A.Quyet_dinh_so As QuyetDinhSo, convert(varchar(20),A.Ngay_ra_QD_UBND,105) As NgayRaQD, A.Tong_so_hoc_sinh As TongSoHocSinh, A.Tong_so_chuyen_nganh As TongSoChuyenNganh, A.User1, A.User2, A.User3, A.User4, A.User5, A.Ly_do_reject As LyDoReject, convert(varchar(20),A.Ngay_cap_nhat_cuoi,105) As NgayCapnhatCuoi FROM QUYETDINHMOLOP As A INNER JOIN THANHVIEN As B ON A.Ma_Nguoi_Lap = B.ID INNER JOIN CHITIETTHANHVIEN As C ON B.Ten_DN = C.Ten_Dang_Nhap INNER JOIN HeDaoTao As D ON A.Ma_he_dao_tao = D.ID LEFT JOIN ThanhVien As E On A.Ma_nguoi_duyet = E.ID LEFT JOIN ChiTietThanhVien As F on E.Ten_DN = F.Ten_dang_nhap WHERE A.Ma_Nguoi_Lap = ? ORDER BY A.Ngay_lap 
iso.sql.GetQuyetDinhByMaQuyetDinh = SELECT A.ID As MaQuyetDinh, A.Ma_KHDT As MaKHDT, A.Ki_hieu As KiHieu, A.Ma_khoa As MaKhoa, A.Ten As TenQuyetDinh, A.Nam_bat_dau As NamBatDau, A.Ma_he_dao_tao As MaHeDaoTao, D.Ten As TenHeDaoTao, D.So_nam As SoNamDaoTao, A.Thong_tin_chung As ThongTinChung, A.Dieu_mot As DieuMot, A.Tu_thang As TuThang, A.Den_thang As DenThang, A.Ma_nguoi_lap As MaNguoiLap, (C.Ho+' '+C.Ten_lot+' '+C.Ten) As TenNguoiLap, convert(varchar(20),A.Ngay_lap,105) As NgayLap, convert(varchar(20),A.Ngay_lap,108) As GioLap, A.Ma_nguoi_duyet As MaNguoiDuyet, ISNULL((F.Ho + ' ' + F.Ten_Lot + ' ' + F.Ten),'') As TenNguoiDuyet, convert(varchar(20),A.Ngay_duyet,105) As NgayDuyet, convert(varchar(20),A.Ngay_duyet,108) As GioDuyet, A.Tinh_trang As TinhTrang, A.Noi_nhan As NoiNhan, A.Quyet_dinh_so As QuyetDinhSo, convert(varchar(20),A.Ngay_ra_QD_UBND,105) As NgayRaQD, A.Tong_so_hoc_sinh As TongSoHocSinh, A.Tong_so_chuyen_nganh As TongSoChuyenNganh, A.User1, A.User2, A.User3, A.User4, A.User5, A.Ly_do_reject As LyDoReject, convert(varchar(20),A.Ngay_cap_nhat_cuoi,105) As NgayCapnhatCuoi, convert(varchar(20),A.Ngay_cap_nhat_cuoi,108) As GioCapnhat FROM QUYETDINHMOLOP As A INNER JOIN THANHVIEN As B ON A.Ma_Nguoi_Lap = B.ID INNER JOIN CHITIETTHANHVIEN As C ON B.Ten_DN = C.Ten_Dang_Nhap INNER JOIN HeDaoTao As D ON A.Ma_he_dao_tao = D.ID LEFT JOIN ThanhVien As E On A.Ma_nguoi_duyet = E.ID LEFT JOIN ChiTietThanhVien As F on E.Ten_DN = F.Ten_dang_nhap WHERE A.ID=? 
iso.sql.duyetQuyetDinhByMaQuyetDinh = Update QuyetDinhMoLop Set Ma_nguoi_duyet=?, Tinh_Trang = ?, Ngay_duyet = getdate(), Ly_do_reject = ? Where ID = ? 
iso.sql.GetAllQuyetDinhApproved = SELECT A.ID As MaQuyetDinh, A.Ten As TenQuyetDinh, A.Ma_nguoi_lap As MaNguoiLap FROM QuyetDinhMoLop As A WHERE A.Tinh_trang = ?

# Table "CHUONG TRINH DAO TAO"
#********************************
iso.sql.getAllChuongTrinhDaoTaoAndTenNguoiTao = SELECT A.ID As MaChuongTrinhDaoTao, A.Ten As TenChuongTrinhDaoTao, A.Ma_nguoi_tao, cast(datepart(mm,A.Ngay_cap_nhat_cuoi) as varchar) + '-' + cast(datepart(dd,A.Ngay_cap_nhat_cuoi) as varchar) + '-' + cast(datepart(yy,A.Ngay_cap_nhat_cuoi) as varchar) As NgayTao, A.Tinh_trang As TinhTrang, (C.Ho + ' ' + C.Ten_Lot + ' ' + C.Ten) As NguoiTao, A.Ly_do_reject As LyDoReject FROM ChuongTrinhDaoTao As A INNER JOIN ThanhVien As B ON A.Ma_nguoi_tao = B.ID INNER JOIN ChiTietThanhVien As C ON B.Ten_DN = C.Ten_dang_nhap ORDER BY A.Ngay_cap_nhat_cuoi
iso.sql.getAllChuongTrinhDaoTaoAndTenNguoiTaoByMaNguoiTao = SELECT A.ID As MaChuongTrinhDaoTao, A.Ten As TenChuongTrinhDaoTao, A.Ma_nguoi_tao, cast(datepart(mm,A.Ngay_cap_nhat_cuoi) as varchar) + '-' + cast(datepart(dd,A.Ngay_cap_nhat_cuoi) as varchar) + '-' + cast(datepart(yy,A.Ngay_cap_nhat_cuoi) as varchar) As NgayTao, A.Tinh_trang AS TinhTrang, (C.Ho + ' ' + C.Ten_Lot + ' ' + C.Ten) As NguoiTao, A.Ly_do_reject As LyDoReject FROM ChuongTrinhDaoTao As A INNER JOIN ThanhVien As B ON A.Ma_nguoi_tao = B.ID INNER JOIN ChiTietThanhVien As C ON B.Ten_DN = C.Ten_dang_nhap WHERE A.Ma_nguoi_tao = ? ORDER BY A.Ngay_cap_nhat_cuoi
iso.sql.getChuongTrinhDaoTaoByID = SELECT A.ID As MaChuongTrinhDaoTao, A.Ten As TenChuongTrinhDaoTao, A.Ma_nghe As MaNghe, A.Ten_nghe As TenNghe, A.Ma_trinh_do As MaTrinhDo, F.Ten As TenTrinhDo, A.Doi_tuong_1 As DoiTuong1, A.Doi_tuong_2 As DoiTuong2, A.Doi_tuong_3 As DoiTuong3, A.Bang_cap As BangCap, A.So_luong_mon_hoc As SoLuongMonHoc, A.Muc_tieu_1 As MucTieu1, A.Muc_tieu_2 As MucTieu2, A.Muc_tieu_3 As MucTieu3, A.Muc_tieu_4 As MucTieu4, A.Muc_tieu_5 As MucTieu5, A.Phuong_phap_1 As PhuongPhap1, A.Phuong_phap_2 As PhuongPhap2, A.Phuong_phap_3 As PhuongPhap3, A.Thoi_gian_1 As ThoiGian1, A.Thoi_gian_2 As ThoiGian2, A.Thoi_gian_3 As ThoiGian3, A.Thoi_gian_4 As ThoiGian4, A.Thoi_gian_5 As ThoiGian5, A.Thoi_gian_6 As ThoiGian6, A.Thoi_gian_7 As ThoiGian7, A.Thoi_gian_8 As ThoiGian8, A.Phan_bo_1 As PhanBo1, A.Phan_bo_2 As PhanBo2, A.Phan_bo_3 As PhanBo3, A.Phan_bo_4 As PhanBo4, A.Phan_bo_5 As PhanBo5, A.Phan_bo_6 As PhanBo6, A.Thi_hoc_ki As ThiHocKi, A.Thi_tot_nghiep As ThiTotNghiep, A.Thuc_tap As ThucTap, A.Y_kien_de_xuat As YKienDeXuat, A.Ma_quyet_dinh As MaQuyetDinh, A.Bang_cap As BangCap, convert(varchar(20),A.Ngay_tao,110) As NgayTao, convert(varchar(20),A.Ngay_tao,108) As GioTao, convert(varchar(20),A.Ngay_cap_nhat_cuoi,110) As NgayCapNhatCuoi, convert(varchar(20),A.Ngay_cap_nhat_cuoi,108) As GioCapNhatCuoi, A.Ma_nguoi_tao As MaNguoiTao, A.Ma_nguoi_duyet As MaNguoiDuyet, convert(varchar(20),A.Ngay_duyet,110) As NgayDuyet, convert(varchar(20),A.Ngay_duyet,108) As GioDuyet, A.Tinh_trang As TinhTrang, A.Ly_do_reject As LyDoReject, A.User1, A.User2, A.User3, A.User4, A.User5, (C.Ho + ' ' + C.Ten_Lot + ' ' + C.Ten) As NguoiTao, ISNULL((E.Ho + ' ' + E.Ten_Lot + ' ' + E.Ten),'') As NguoiDuyet, F.Ten AS TenTrinhDo, G.Ki_hieu As KiHieu, Convert(varchar(10),A.Ngay_gui, 110) As NgayGui, Convert(varchar(10),A.Ngay_gui, 108) As GioGui, H.Ma_khoa AS MaKhoa FROM ChuongTrinhDaoTao As A INNER JOIN ThanhVien As B ON A.Ma_nguoi_tao = B.ID INNER JOIN ChiTietThanhVien As C ON B.Ten_DN = C.Ten_dang_nhap LEFT JOIN ThanhVien As D ON A.Ma_nguoi_duyet = D.ID LEFT JOIN ChiTietThanhVien As E ON D.Ten_DN = E.Ten_dang_nhap INNER JOIN HeDaoTao As F ON A.Ma_trinh_do = F.ID INNER JOIN ChuyenNganh AS G ON A.Ma_nghe = G.ID INNER JOIN QuyetDinhMoLop AS H ON A.Ma_quyet_dinh = H.ID Where A.ID = ?
iso.sql.duyetChuongTrinhDaoTaoByMaChuongTrinh = Update ChuongTrinhDaoTao Set Ma_nguoi_duyet=?, Tinh_Trang = ?, Ngay_duyet = getdate(), Ly_do_reject = ? Where ID = ?
iso.sql.GetAllChuongTrinhChuaDuyet = SELECT A.ID As MaChuongTrinhDaoTao, A.Ten AS TenChuongTrinhDaoTao, A.Ten_nghe AS TenNghe, C.Ten AS TenTrinhDo, D.Ma_khoa AS MaKhoa FROM ChuongTrinhDaoTao As A INNER JOIN HeDaoTao AS C ON A.Ma_trinh_do = C.ID INNER JOIN QuyetDinhMoLop AS D On A.Ma_quyet_dinh = D.ID WHERE A.Tinh_trang <> 2 and A.Tinh_trang <> 1
iso.sql.getAllChuongTrinhDaoTaoApproved = SELECT A.ID AS MaChuongTrinhDaoTao, A.Ten AS TenChuongTrinhDaoTao, A.Ma_nghe AS MaNghe, A.Ma_nguoi_tao As MaNguoiTao, A.Ma_trinh_do As MaTrinhDo, B.Ten_chuyen_nganh AS TenNghe, C.Ten AS TenTrinhDo, D.Ma_khoa AS MaKhoa FROM ChuongTrinhDaoTao AS A INNER JOIN ChuyenNganh AS B ON A.Ma_nghe = B.ID INNER JOIN HeDaoTao AS C ON A.Ma_trinh_do = C.ID INNER JOIN QuyetDinhMoLop AS D ON A.Ma_quyet_dinh = D.ID WHERE A.Tinh_trang = ?
#iso.sql.GetAllChuongTrinhAndMonHocChuaDuyet = SELECT A.ID As MaChuongTrinhDaoTao, A.Ten AS TenChuongTrinhDaoTao, A.Ten_nghe AS TenNghe, C.Ten AS TenTrinhDo, B.Ma_mon_hoc As MaMonHoc FROM ChuongTrinhDaoTao As A INNER JOIN ChiTietMonHocCTDT As B On A.ID = B.Ma_chuong_trinh INNER JOIN HeDaoTao AS C ON A.Ma_trinh_do = C.ID WHERE A.Tinh_trang <> 2 and A.Tinh_trang <> 1
iso.sql.GetAllChuongTrinh = SELECT A.ID As MaChuongTrinhDaoTao, A.Ten AS TenChuongTrinhDaoTao, A.Ten_nghe AS TenNghe, C.Ten AS TenTrinhDo, D.Ma_khoa AS MaKhoa FROM ChuongTrinhDaoTao As A INNER JOIN HeDaoTao AS C ON A.Ma_trinh_do = C.ID INNER JOIN QuyetDinhMoLop AS D ON A.Ma_quyet_dinh = D.ID
iso.sql.getTinhTrangChuongTrinh = SELECT A.Tinh_trang AS TinhTrang FROM ChuongTrinhDaoTao AS A WHERE A.ID = ?
iso.sql.phongKiemDinhGuiChuongTrinhChoBanGiamHieu = UPDATE ChuongTrinhDaoTao SET Tinh_trang = ? WHERE ID = ?

# Table "MoChuyenNganh"
#********************************
iso.sql.GetMoChuyenNganhByMaQuyetDinh = SELECT A.ID As MaMoChuyenNganh, A.Ma_chuyen_nganh As MaChuyenNganh, B.Ten_chuyen_nganh As TenChuyenNganh, A.Ma_quyet_dinh As MaQuyetDinh, A.Ghi_chu As GhiChu, A.User1, A.User2, A.User3, A.User4, A.User5 FROM MoChuyenNganh As A INNER JOIN ChuyenNganh As B ON A.Ma_chuyen_nganh = B.ID WHERE A.Ma_quyet_dinh=? Order By A.ID

# Table "ChuyenNganh"
#********************************
iso.sql.GetAllChuyenNganh = SELECT A.ID As MaChuyenNganh, A.Ten_chuyen_nganh As TenChuyenNganh, A.Ma_khoaTT As MaKhoaTT, A.Ki_hieu As KiHieu, A.Ngay_tao As NgayTao, A.Ma_nguoi_tao As MaNguoiTao, A.Ngay_cap_nhat_cuoi As NgayCapNhatCuoi, A.User1, A.User2, A.User3, A.User4, A.User5 FROM ChuyenNganh As A Order By A.Ten_chuyen_nganh
iso.sql.GetChuyenNganhByMaChuyenNganh = SELECT A.ID As MaChuyenNganh, A.Ten_chuyen_nganh As TenChuyenNganh, A.Ma_khoaTT As MaKhoaTT, A.KiHieu As KiHieu, A.Ngay_tao As NgayTao, A.Ma_nguoi_tao As MaNguoiTao, A.Ngay_cap_nhat_cuoi As NgayCapNhatCuoi, A.User1, A.User2, A.User3, A.User4, A.User5 FROM ChuyenNganh As A WHERE A.ID=? Order By A.Ten_chuyen_nganh
iso.sql.GetAllChuyenNganhAndMaQuyetDinh = SELECT A.ID As MaQuyetDinh, A.Ma_khoa As MaKhoa, A.Nam_bat_dau As NamBatDau, C.ID As MaChuyenNganh, C.Ten_chuyen_nganh As TenChuyenNganh, C.Ki_hieu As KiHieu, D.So_nam As SoNam, D.ID As MaHeDaoTao, D.Ten As TenHeDaoTao, E.Ten As TenBangCap From QuyetDinhMoLop As A Inner Join MoChuyenNganh As B On A.ID = B.Ma_quyet_dinh Inner join ChuyenNganh As C On B.Ma_chuyen_nganh = C.ID Inner join HeDaoTao As D On A.Ma_he_dao_tao = D.ID Inner Join BangCapDaoTao As E On D.ID = E.Ma_he_dao_tao Where not exists (select * from chuongtrinhdaotao as D Where D.Ma_nghe <> ? and B.Ma_quyet_dinh = D.Ma_quyet_dinh and B.Ma_chuyen_nganh = D.Ma_nghe)
admin.sql.GetAllChuyenNganh = SELECT A.ID As MaChuyenNganh, A.Ten_chuyen_nganh As TenChuyenNganh, B.ten As Khoa, A.Ki_hieu As KiHieu FROM ChuyenNganh As A inner join Khoa_TrungTam AS B ON A.Ma_khoaTT=B.ID
admim.sql.ShowKhoa = SELECT A.ID AS MaChuyenNganh, A.Ten_chuyen_nganh AS TenChuyenNganh, A.Ki_hieu AS KiHieu, A.Ma_khoaTT AS MaKhoa, B.Ten AS TenKhoa FROM ChuyenNganh A INNER JOIN Khoa_TrungTam B on A.Ma_khoaTT = B.ID

# Table "BaiKiemTra"
#********************************
iso.sql.getAllBaiKiemTraByMaMonHocOrderByTenBaiKiemTra = SELECT A.ID As MaBaiKiemTra, A.Ma_mon_hoc As MaMonHoc, A.Ma_bai_kiem_tra As MaTenBaiKiemTra, A.Ma_hinh_thuc As MaHinhThuc, A.Thang_diem As ThangDiem, A.Ghi_chu As GhiChu, A.Ngay_cap_nhat_cuoi As NgayCapNhatCuoi, A.User1, A.User2, A.User3, A.User4, A.User5, B.Ten_hinh_thuc AS TenHinhThuc, C.Ten_bai_kiem_tra As TenBaiKiemTra FROM BaiKiemTra As A inner join HinhThuc AS B ON A.Ma_hinh_thuc = B.ID INNER JOIN TenBaiKiemTra AS C On a.ma_bai_kiem_tra = c.id WHERE A.Ma_mon_hoc= ? Order by C.ID

#**iso.sql.getAllBaiKiemTraByMaMonHocOrderByTenBaiKiemTra = SELECT A.ID As MaBaiKiemTra, A.Ma_mon_hoc As MaMonHoc, A.Ma_bai_kiem_tra As MaTenBaiKiemTra, A.Ma_hinh_thuc As MaHinhThuc, A.Thang_diem As ThangDiem, A.Ghi_chu As GhiChu, A.Ngay_cap_nhat_cuoi As NgayCapNhatCuoi, A.User1, A.User2, A.User3, A.User4, A.User5, B.Ten_hinh_thuc AS TenHinhThuc, C.Ten_bai_kiem_tra As TenBaiKiemTra FROM BaiKiemTra As A inner join HinhThuc AS B ON A.Ma_hinh_thuc = B.ID INNER JOIN TenBaiKiemTra AS C On a.ma_bai_kiem_tra = c.id WHERE A.Ma_mon_hoc= ? Order by C.Ten_bai_kiem_tra, A.ID

iso.sql.GetBaiKiemTraByMaBaiKiemTra = SELECT A.ID As MaBaiKiemTra, A.Ma_mon_hoc As MaMonHoc, A.Ten As TenBaiKiemTra, A.Ma_hinh_thuc As MaHinhThuc, A.Thang_diem As ThangDiem, A.Ghi_chu As GhiChu, A.Ngay_cap_nhat_cuoi As NgayCapNhatCuoi, A.User1, A.User2, A.User3, A.User4, A.User5 FROM BaiKiemTra As A WHERE A.ID=? Order By A.Ten
admin.sql.GetBaiKiemTraByMaMonHoc = SELECT A.ID As MaBaiKiemTra, A.Ma_mon_hoc As MaMonHoc, A.Ma_bai_kiem_tra As MaTenBaiKiemTra, C.Ten_bai_kiem_tra AS TenBaiKiemTra, A.Ma_hinh_thuc As MaHinhThuc, A.Thang_diem As ThangDiem, A.Ghi_chu As GhiChu, A.Ngay_cap_nhat_cuoi As NgayCapNhatCuoi, A.User1 As HeSo, A.User2, A.User3, A.User4, A.User5, B.Ten_hinh_thuc AS TenHinhThuc FROM BaiKiemTra As A inner join HinhThuc AS B ON A.Ma_hinh_thuc = B.ID inner join TenBaiKiemTra C ON C.ID = A.Ma_bai_kiem_tra WHERE A.Ma_mon_hoc=?
admin.sql.GetAllBaiKiemTra = SELECT A.ID As MaBaiKiemTra, A.Ma_bai_kiem_tra As MaTenBaiKiemTra, A.Ma_mon_hoc As MaMonHoc, B.Ten_mon_hoc AS TenMonHoc, A.Ma_hinh_thuc As MaHinhThuc, A.Thang_diem As ThangDiem FROM BaiKiemTra As A inner join MonHoc AS B ON B.ID = A.Ma_mon_hoc

# Table "HinhThuc"
#********************************
admin.sql.GetAllHinhThuc = SELECT ID AS MaHinhThuc,Ten_hinh_thuc AS TenHinhThuc, Ngay_cap_nhat_cuoi AS NgayCapNhatCuoi FROM HinhThuc

# Table "TenBaiKiemTra"
#********************************
admin.sql.GetAllTenBaiKiemTra = SELECT ID AS MaTenBaiKiemTra,Ten_bai_kiem_tra AS TenBaiKiemTra, Ngay_cap_nhat_cuoi AS NgayCapNhatCuoi FROM TenBaiKiemTra

# Table "DangKyMonHoc"
#********************************
iso.sql.getAllDangKyMonHoc = SELECT A.ID As MaDangKyMonHoc, A.Ma_mon_hoc_TKB As MaMonHocTKB, A.Ma_hoc_vien As MaHocVien, A.Diem_trung_binh As DiemTrungBinh, A.Hanh_kiem As HanhKiem, A.Hoc_luc As HocLuc, A.Danh_hieu AS DanhHieu, A.Ghi_chu AS GhiChu, A.Ngay_cap_nhat_cuoi As NgayCapNhatCuoi, A.User1, A.User2, A.User3, A.User4, A.User5 FROM DangKyMonHoc As A
# 
XemDiem.sql.getAllDangKyMonHocByMaHocKiTungLop = SELECT A.Ma_mon_hoc_TKB AS MaMonHocTKB, B.Diem_TB_mon AS DiemTBMon, D.Ten_mon_hoc AS TenMonHoc, D.ID AS MaMonHoc, E.ID AS MaHocVien, (ISNULL(F.Ho, '') + ' ' + ISNULL(F.Ten_lot, '') + ' ' + ISNULL(F.Ten, '')) AS TenHocVien FROM SoDiemMonHoc AS A INNER JOIN DangKyMonHoc AS B ON A.ID = B.Ma_so_diem_mon_hoc INNER JOIN MonHocTKB AS C ON A.Ma_mon_hoc_TKB = C.ID INNER JOIN MonHoc AS D ON C.Ma_mon_hoc = D.ID INNER JOIN ThanhVien AS E ON B.Ma_hoc_vien = E.ID INNER JOIN ChiTietThanhVien AS F ON E.Ten_DN = F.Ten_dang_nhap WHERE A.Ma_hoc_ki_tung_lop = ? ORDER BY F.Ho, F.Ten_lot, F.Ten, D.Ten_mon_hoc

# Table "BangDiemHocKi"
XemDiem.sql.getBangDiemHocKiByHocKiAndMaLopAndMaNamHocAndMaSinhVien = SELECT A.Diem_trung_binh AS DiemTrungBinh, A.Diem_ren_luyen AS DiemRenLuyen, A.Diem_TB_Hoc_ki AS DiemTBHocKi, A.Hoc_luc AS HocLuc, A.Hanh_kiem AS HanhKiem, A.Ghi_chu AS GhiChu FROM BangDiemHocKi AS A INNER JOIN HocKiTungLop AS B ON A.Ma_hoc_ki_tung_lop = B.ID WHERE A.Ma_hoc_vien = ? AND B.Ma_nam_hoc = ? AND B.Hoc_ki = ? AND B.Ma_lop = ?
XemDiem.sql.getAllBangDiemHocKiByMaHocKiTungLop = SELECT A.Ma_hoc_vien AS MaHocVien, A.Diem_ren_luyen AS DiemRenLuyen, A.Diem_trung_binh AS DiemTrungBinh, A.Hoc_luc AS HocLuc, A.Hanh_kiem AS HanhKiem, A.ID AS MaBangDiemHocHocKi, A.Diem_TB_hoc_ki AS DiemTBHocKi FROM BangDiemHocKi AS A INNER JOIN ThanhVien AS B ON A.Ma_hoc_vien = B.ID INNER JOIN ChiTietThanhVien AS C ON B.Ten_DN = C.Ten_dang_nhap WHERE A.Ma_hoc_ki_tung_lop = ? ORDER BY C.Ho, C.Ten_lot, C.Ten

# Table "SoDiemMonHoc"
#********************************
XemDiem.sql.getSoDiemMonHocByMaMonHocTKB = SELECT A.Tinh_trang AS TinhTrang, A.ID AS MaSoDiemMonHoc, B.ID AS MaDangKyMonHoc, B.Ma_hoc_vien AS MaHocVien, (ISNULL(E.Ho, '') + ' ' + ISNULL(E.Ten_lot, '') + ' ' + ISNULL(E.Ten, '')) AS HoTenSinhVien, C.ID AS MaChiTietDiem, C.Diem AS Diem, F.ID AS MaBaiKiemTra, B.Diem_TB_Mon AS DiemTBMon FROM SoDiemMonHoc AS A INNER JOIN DangKyMonHoc AS B ON A.ID = B.Ma_so_diem_mon_hoc INNER JOIN ChiTietDiem AS C ON B.ID = C.Ma_dang_ky_mon_hoc INNER JOIN ThanhVien AS D ON B.Ma_hoc_vien = D.ID INNER JOIN ChiTietThanhVien AS E ON D.Ten_DN = E.Ten_dang_nhap LEFT JOIN BaiKiemTra AS F ON C.Ma_bai_kiem_tra = F.ID INNER JOIN TenBaiKiemTra AS G ON F.Ma_bai_kiem_tra = G.ID WHERE A.Ma_mon_hoc_TKB = ? ORDER BY B.ID, E.Ho, E.Ten_lot, E.Ten, F.Ma_bai_kiem_tra, C.ID
XemDiem.sql.guiSoDiemMonHocChoGVCN = UPDATE SoDiemMonHoc SET Tinh_trang = 1 WHERE ID = ?
XemDiem.sql.getSoDiemMonHocByMaMonHocTKBSimple = SELECT C.Ki_hieu AS KiHieuLop, D.Ten_chuyen_nganh AS TenChuyenNganh, (CAST(E.Nam_bat_dau AS VARCHAR) + '-' + CAST(E.Nam_ket_thuc AS VARCHAR)) AS NamHoc, G.Ten_mon_hoc AS TenMonHoc, (ISNULL(I.Ho, '') + ' ' + ISNULL(I.Ten_lot, '') + ' ' + ISNULL(I.Ten, '')) AS TenGiaoVien FROM HocKiTungLop AS A INNER JOIN SoDiemMonHoc AS B ON A.ID = B.Ma_hoc_ki_tung_lop INNER JOIN LopHoc AS C ON A.Ma_lop = C.ID INNER JOIN ChuyenNganh AS D ON C.Ma_chuyen_nganh = D.ID INNER JOIN NamHoc AS E ON A.Ma_nam_hoc = E.ID INNER JOIN MonHocTKB AS F ON B.Ma_mon_hoc_TKB = F.ID INNER JOIN MonHoc AS G ON G.ID = F.Ma_mon_hoc INNER JOIN ThanhVien AS H ON H.ID = F.Ma_giao_vien INNER JOIN ChiTietThanhVien AS I ON I.Ten_dang_nhap = H.Ten_DN WHERE B.Ma_mon_hoc_TKB = ?

# Table "HocKiTungLop"
#******************************** AND CAST(A.Tinh_trang AS INT) > 0 --> XemDiem.sql.getHocKiTungLopByMaNamHocAndHocKi
XemDiem.sql.getHocKiTungLopByMaNamHocAndHocKi = SELECT A.Ma_lop AS MaLop, B.Ki_hieu AS KiHieuLop, A.ID AS MaHocKiTungLop, A.Tinh_trang AS TinhTrang FROM HocKiTungLop AS A INNER JOIN LopHoc AS B ON A.Ma_lop = B.ID WHERE A.Ma_nam_hoc = ? AND A.Hoc_ki = ?
XemDiem.sql.getHocKiTungLopByMaNamHocAndHocKiAndMaGiaoVien = SELECT A.Ma_lop AS MaLop, B.Ki_hieu AS KiHieuLop, A.ID AS MaHocKiTungLop, E.ID AS MaMonHoc, E.Ten_mon_hoc AS TenMonHoc, D.ID AS MaMonHocTKB, D.Ma_giao_vien AS MaGiaoVien FROM HocKiTungLop AS A INNER JOIN LopHoc AS B ON A.Ma_lop = B.ID INNER JOIN SoDiemMonHoc AS C ON A.ID = C.Ma_Hoc_ki_tung_lop INNER JOIN MonHocTKB AS D ON C.Ma_mon_hoc_TKB = D.ID INNER JOIN MonHoc AS E ON D.Ma_mon_hoc = E.ID WHERE A.Ma_nam_hoc = ? AND A.Hoc_ki = ? AND D.Ma_giao_vien = ? ORDER BY B.Ki_hieu, E.Ten_mon_hoc
XemDiem.sql.getHocKiTungLopByMaLop = SELECT A.Ma_nam_hoc AS MaNamHoc, (CAST(B.Nam_bat_dau AS VARCHAR) + '-' + CAST(B.Nam_ket_thuc AS VARCHAR)) AS NamHoc, A.Hoc_ki AS HocKi FROM HocKiTungLop AS A INNER JOIN NamHoc AS B ON A.Ma_nam_hoc = B.ID WHERE A.Ma_lop = ? ORDER BY B.Nam_bat_dau, A.Hoc_ki
XemDiem.sql.getHocKiTungLopByID = SELECT A.Hoc_ki AS HocKi, B.Ki_hieu AS KiHieuLop, (C.Nam_bat_dau + '-' + C.Nam_ket_thuc) AS NamHoc, D.Ten_chuyen_nganh AS TenChuyenNganh FROM HocKiTungLop AS A INNER JOIN LopHoc AS B ON A.Ma_lop = B.ID INNER JOIN NamHoc AS C ON A.Ma_nam_hoc = C.ID INNER JOIN ChuyenNganh AS D ON D.ID = B.Ma_chuyen_nganh WHERE A.ID = ?

# Table "ChiTietDiem"
#********************************
iso.sql.getDieuKienXemDiemOfGiaoVien = select e.id As MaKhoa, e.Ten as TenKhoa, c.id AS MaLop, c.Ki_hieu AS KiHieuLop, d.Ten_chuyen_nganh, b.id as MaNamHoc, b.Nam_bat_dau as NamBatdau, b.Nam_ket_thuc as NamKetThuc, a.Hoc_ki as HocKy,f.ID as MaMonHocTKB, g.id AS MaMonHoc, g.Ten_mon_hoc AS TenMonHoc, h.id As MaThanhVien, IsNull(i.Ho,'') AS Ho, IsNull(i.Ten_Lot,'') As TenLot, IsNull(i.Ten,'') As Ten from ThoiKhoaBieu a inner join NamHoc b on b.Nam_bat_dau = a.Nam_bat_dau inner join LopHoc c on c.ID = a.Ma_lop inner join ChuyenNganh d on d.ID = c.Ma_chuyen_nganh inner join Khoa_trungtam e on e.ID = d.Ma_khoaTT inner join monhoctkb as f on a.id = f.Ma_tkb inner join monhoc as g on f.ma_mon_hoc = g.id inner join thanhvien as h on f.ma_giao_vien = h.id inner join chitietthanhvien as i on h.Ten_dn = i.ten_dang_nhap where a.tinh_trang = ?  order by e.Ten, c.Ki_hieu, b.Nam_bat_dau, a.hoc_ki, g.ten_mon_hoc, i.Ho, i.Ten_lot, i.Ten  
iso.sql.getAllChiTietDiem = SELECT A.ID As MaChiTietDiem, A.Ma_dang_ky_mon_hoc As MaDangKyMonHoc, A.Ma_bai_kiem_tra As MaBaiKiemtra, A.Diem As Diem, A.Ghi_chu AS GhiChu, A.Ngay_cap_nhat_cuoi As NgayCapNhatCuoi, A.User1, A.User2, A.User3, A.User4, A.User5 FROM ChiTietDiem As A
iso.sql.getShowDiem = select a.ma_mon_hoc_tkb as MaMonHocTKB, a.id as MaDangKyMonHoc, a.ma_hoc_vien as MaHocVien, a.diem_trung_binh as DiemTrungBinh, a.hanh_kiem as HanhKiem,a.hoc_luc as HocLuc,a.danh_hieu as DanhHieu,b.id as MaChiTietDiem, case b.diem when -1 then null else b.diem end as 'Diem', d.ten_dang_nhap as TenDangNhap, isnull(d.ho,'') as Ho, isnull(d.ten_lot, '') as TenLot, isnull(d.ten,'') as Ten, b.ma_bai_kiem_tra as maBaiKiemTra from dangkymonhoc as a left join chitietdiem as b on b.ma_dang_ky_mon_hoc = a.id inner join thanhvien as c on a.ma_hoc_vien = c.id inner join chitietthanhvien as d on d.ten_dang_nhap = c.ten_dn left join baikiemtra as e on b.ma_bai_kiem_tra = e.id inner join TenBaiKiemTra as f on e.ma_bai_kiem_tra = f.id where a.ma_mon_hoc_tkb = ? order by a.id, d.ten, d.ten_lot, d.ho, e.ma_bai_kiem_tra, b.id
iso.sql.getDieuKienXemDiemOfSinhVien = select a.id as MaThoiKhoaBieu, a.hoc_ki as HocKi, b.id as MaLop, b.ki_hieu as KiHieu, d.id as MaThanhVien, c.ho as HoTV, c.ten_lot as TenLot, c.ten as TenTV from thoikhoabieu a inner join lophoc b on b.id = a.ma_lop inner join chitietthanhvien c on b.id = c.ma_lop_hoc inner join thanhvien d on c.Ten_dang_nhap = d.Ten_DN where c.ma_lop_hoc = ? and a.tinh_trang = ? order by a.hoc_ki, c.ten, c.ten_lot, c.ho
XemDiem.sql.getShowDiemSinhVien = SELECT E.ten_mon_hoc AS TenMonHoc, E.User1 AS HeSo, F.Ma_bai_kiem_tra AS MaBaiKiemTra, G.Ten_bai_kiem_tra AS TenBaiKiemTra, D.ID AS MaChiTietDiem, CASE D.Diem WHEN -1 THEN NULL ELSE D.Diem END AS Diem, H.Diem_TB_Mon AS DiemTBMon, B.ID AS MaDangKyMonHoc FROM HocKiTungLop AS A INNER JOIN SoDiemMonHoc AS B ON A.ID = B.Ma_hoc_ki_tung_lop INNER JOIN MonHocTKB AS C ON B.Ma_mon_hoc_TKB = C.ID INNER JOIN DangKyMonHoc AS H ON B.ID = H.Ma_so_diem_mon_hoc INNER JOIN ChiTietDiem AS D ON H.ID = D.Ma_dang_ky_mon_hoc INNER JOIN MonHoc AS E ON C.Ma_mon_hoc = E.ID INNER JOIN BaiKiemTra AS F ON D.Ma_bai_kiem_tra = F.ID INNER JOIN TenBaiKiemTra AS G ON G.ID = F.Ma_bai_kiem_tra WHERE A.Ma_lop = ? AND A.Ma_nam_hoc = ? AND A.Hoc_ki = ? AND H.Ma_hoc_vien = ? ORDER BY E.Ten_mon_hoc, F.Ma_bai_kiem_tra, D.ID 

# Table "HocKy"
#********************************
iso.sql.getAllHocKy = SELECT A.ID As MaHocKy, A.Ten_hoc_ky As TenHocKy, A.Ma_khoa As MaKhoa, A.Ma_nam_hoc As MaNamHoc, A.Ma_lop AS MaLop, A.Ngay_cap_nhat_cuoi As NgayCapNhatCuoi, A.User1, A.User2, A.User3, A.User4, A.User5 FROM HocKy As A
is.sql.getHocKyByMaLop = SELECT A.ID As MaHocKy, A.Ten_hoc_ky As TenHocKy, A.Ma_khoa As MaKhoa, A.Ma_nam_hoc As MaNamHoc, A.Ma_lop AS MaLop, A.Ngay_cap_nhat_cuoi As NgayCapNhatCuoi, A.User1, A.User2, A.User3, A.User4, A.User5 FROM HocKy As A WHERE A.Ma_lop = ?

# Table "HeDaoTao"
#********************************
iso.sql.GetHeDaoTao = SELECT A.ID AS MaHeDaoTao, A.Ten AS TenHeDaoTao, A.So_nam AS SoNam, A.User1, A.User2, A.User3, A.User4, A.User5 FROM HeDaoTao AS A
iso.sql.GetHeDaoTaoByMaHeDaoTao = SELECT A.ID AS MaHeDaoTao, A.Ten AS TenHeDaoTao, A.So_nam AS SoNam, A.User1, A.User2, A.User3, A.User4, A.User5 FROM HeDaoTao AS A WHERE A.ID = ?
iso.sql.GetSonamHeDaoTao = Select A.ID As MaChuongtrinh, B.So_nam As SoNam From ChuongTrinhDaoTao As A Inner Join HeDaoTao As B On A.Ma_trinh_do = B.ID

# Table "MonHoc"
#********************************
iso.sql.GetMonHoc = SELECT A.ID AS MaMonHoc, A.Ten_mon_hoc AS TenMonHoc, A.Ly_thuyet AS LyThuyet, A.Thuc_hanh AS ThucHanh, A.Tinh_chat AS TinhChat FROM MonHoc AS A ORDER BY A.Ten_mon_hoc
iso.sql.GetMonHocByTruongBoMon = SELECT A.ID As MaMonHoc, A.Ten_mon_hoc As TenMonHoc FROM MonHoc As A WHERE Ma_truong_bo_mon = ?
admin.sql.getAllMonHoc = SELECT A.ID AS MaMonHoc, A.Ten_mon_hoc AS TenMonHoc, A.Ly_thuyet AS LyThuyet, A.Thuc_hanh AS ThucHanh, A.Kiem_tra AS KiemTra, A.Tinh_chat AS TinhChat, B.Ten_chuyen_nganh AS TenChuyenNganh , C.Ten_hoc_phan AS TenHocPhan FROM MonHoc AS A inner join chuyennganh AS B on A.Ma_chuyen_nganh = B.id inner join hocphan AS C on A.Ma_hoc_phan = C.ID order by A.Ten_mon_hoc
iso.sql.getMaMonHocByTruongBoMon = SELECT A.ID AS MaMonHoc FROM MonHoc AS A WHERE A.Ma_truong_bo_mon = ? 
admin.sql.getMonHocByID = SELECT A.ID AS MaMonHoc, A.Ten_mon_hoc AS TenMonHoc, A.Ly_thuyet AS LyThuyet, A.Thuc_hanh AS ThucHanh, A.Kiem_tra AS KiemTra,A.Tinh_chat AS TinhChat,B.ID AS MaChuyenNganh, B.Ten_chuyen_nganh AS TenChuyenNganh ,C.ID AS MaHocPhan, C.Ten_hoc_phan AS TenHocPhan, A.Ma_nguoi_tao AS MaNguoiTao, A.Ma_truong_bo_mon AS MaTruongBoMon FROM MonHoc AS A inner join chuyennganh AS B on A.Ma_chuyen_nganh = B.id inner join hocphan AS C on A.Ma_hoc_phan = C.ID WHERE A.ID = ?
iso.sql.getTenMonHocByID=SELECT Ten_mon_hoc As TenMonHoc FROM MonHoc WHERE ID=?

# Table "CHI TIET CHUONG TRINH DAO TAO"
#********************************

iso.sql.GetChiTietCTDTByMaChuongTrinh = SELECT A.ID AS MaChiTietCTDT, A.Ma_chuong_trinh As MaChuongTrinh, A.Ma_mon_hoc As MaMonHoc, A.Ngay_cap_nhat_cuoi As NgayCapNhatCuoi, A.Ly_thuyet As LyThuyet, A.Thuc_hanh As ThucHanh, A.LT_TH As LTTH, A.TTSX As TTSX, A.Tinh_chat As TinhChat, A.Nam_hoc As NamHoc, A.Hoc_ky As HocKi, A.Ma_hoc_phan As MaHocPhan, A.Thu_tu As ThuTu, ISNULL(A.User1, 0) as User1, A.User2, A.User3, A.User4, A.User5, B.Ten_mon_hoc As TenMonHoc, C.Tinh_trang As TinhTrang, C.ID As MaDeCuong, C.Ma_nguoi_tao As MaNguoiTaoDeCuong FROM ChiTietMonHocCTDT AS A INNER JOIN MonHoc As B On A.Ma_mon_hoc = B.ID LEFT JOIN DeCuongMonHoc As C ON A.Ma_chuong_trinh = C.Ma_chuong_trinh and A.Ma_mon_hoc = C.Ma_mon_hoc WHERE A.Ma_chuong_trinh = ?  ORDER BY A.Ma_hoc_phan, A.Thu_tu
#iso.sql.GetAllChiTietCTDTChuaDuyet = SELECT A.ID AS MaChiTietCTDT, A.Ma_chuong_trinh As MaChuongTrinh, A.Ma_mon_hoc As MaMonHoc, B.Ten_mon_hoc As TenMonHoc, A.Ly_thuyet As LyThuyet, A.Thuc_hanh As ThucHanh, A.Tinh_chat As TinhChat, E.Ten As TenKhoa FROM ChiTietMonHocCTDT As A INNER JOIN MonHoc As B ON A.Ma_mon_hoc = B.ID INNER JOIN ChuongTrinhDaoTao As C ON A.Ma_chuong_trinh = C.ID INNER JOIN ChuyenNganh AS D On C.Ma_nghe = D.ID INNER JOIN Khoa_TrungTam AS E ON D.Ma_khoaTT = E.ID WHERE C.Tinh_trang <> 1 and C.Tinh_trang <> 2
iso.sql.GetAllChiTietCTDTChuaDuyet = SELECT A.ID AS MaChiTietCTDT, A.Ma_chuong_trinh As MaChuongTrinh, A.Ma_mon_hoc As MaMonHoc, B.Ten_mon_hoc As TenMonHoc, A.Ly_thuyet As LyThuyet, A.Thuc_hanh As ThucHanh, A.Tinh_chat As TinhChat, E.Ten As TenKhoa, ISNULL(A.User1, 0) as User1 FROM ChiTietMonHocCTDT As A INNER JOIN MonHoc As B ON A.Ma_mon_hoc = B.ID INNER JOIN ChuongTrinhDaoTao As C ON A.Ma_chuong_trinh = C.ID INNER JOIN ChuyenNganh AS D On C.Ma_nghe = D.ID INNER JOIN Khoa_TrungTam AS E ON D.Ma_khoaTT = E.ID LEFT JOIN DeCuongMonHoc AS F ON F.Ma_chuong_trinh = C.ID AND F.Ma_mon_hoc = A.Ma_mon_hoc WHERE C.Tinh_trang <> 1 and C.Tinh_trang <> 2 AND F.ID IS NULL ORDER BY B.Ten_mon_hoc

iso.sql.GetChiTietCTDTByMaDeCuong = SELECT F.ID AS MaDeCuong, A.ID AS MaChiTietCTDT, A.Ma_chuong_trinh As MaChuongTrinh, A.Ma_mon_hoc As MaMonHoc, B.Ten_mon_hoc As TenMonHoc, A.Ly_thuyet As LyThuyet, A.Thuc_hanh As ThucHanh, ISNULL(A.User1, 0) as User1, A.Tinh_chat As TinhChat, E.Ten As TenKhoa FROM ChiTietMonHocCTDT As A INNER JOIN MonHoc As B ON A.Ma_mon_hoc = B.ID INNER JOIN ChuongTrinhDaoTao AS C ON A.Ma_chuong_trinh = C.ID INNER JOIN ChuyenNganh AS D On C.Ma_nghe = D.ID INNER JOIN Khoa_TrungTam AS E ON D.Ma_khoaTT = E.ID INNER JOIN DeCuongMonHoc As F ON A.Ma_chuong_trinh = F.Ma_chuong_trinh AND A.Ma_mon_hoc = F.Ma_mon_hoc WHERE F.ID = ?


# Table "NOI DUNG DE CUONG MON HOC"
#********************************

iso.sql.getAllNoiDungDCMHByMaDeCuong = SELECT A.ID AS MaNoiDungDCMH, A.Ten_chuong AS TenChuong, A.Ma_de_cuong As MaDeCuong, A.So_thu_tu As SoThuTu, A.So_buoi As SoBuoi, A.Co_hieu As CoHieu, A.So_tiet As SoTiet, A.Muc_tieu AS MucTieu FROM NoiDungDCMH AS A WHERE A.Ma_de_cuong = ?
iso.sql.getAllNoiDungDCMH = SELECT A.ID AS MaNoiDungDCMH, A.Ten_chuong AS TenChuong, A.Ma_de_cuong As MaDeCuong, A.So_thu_tu As SoThuTu, A.So_buoi As SoBuoi, A.Co_hieu As CoHieu, A.So_tiet As SoTiet FROM NoiDungDCMH AS A 
iso.sql.getAllNoiDungDCMHByMaChuongTrinhAndHocKi = SELECT A.Ma_mon_hoc As MaMonHoc, D.So_thu_tu As SoThuTu, D.Co_hieu AS CoHieu, D.So_buoi As SoBuoi, D.Ten_chuong AS TenChuong, D.Muc_tieu As MucTieu FROM DeCuongMonHoc As A INNER JOIN MonHoc As B ON A.Ma_mon_hoc = B.ID INNER JOIN ChiTietMonHocCTDT As C ON A.Ma_chuong_trinh = C.Ma_chuong_trinh and A.Ma_mon_hoc = C.Ma_mon_hoc INNER JOIN NoiDungDCMH AS D ON A.ID = D.Ma_de_cuong WHERE A.Tinh_trang = ? and A.Ma_chuong_trinh = ?
iso.sql.getNoiDungDCMHByID=SELECT A.ID AS MaNoiDungDCMH, A.Ten_chuong AS TenChuong, A.Ma_de_cuong As MaDeCuong, A.So_thu_tu As SoThuTu, A.So_buoi As SoBuoi, A.Co_hieu As CoHieu, A.So_tiet As SoTiet FROM NoiDungDCMH AS A WHERE ID=?
iso.sql.getTotalNoiDungDCMHByMaDeCuong=SELECT COUNT(*) AS COUNT FROM NOIDUNGDCMH WHERE MA_DE_CUONG=?

# Table "DE CUONG MON HOC"
#********************************
iso.sql.getAllDeCuongMonHocAndTenNguoiTao = SELECT A.ID As MaNoiDungDCMH, A.Ten As TenNoiDungDCMH, A.Ma_nguoi_tao, cast(datepart(mm,A.Ngay_cap_nhat_cuoi) as varchar) + '-' + cast(datepart(dd,A.Ngay_cap_nhat_cuoi) as varchar) + '-' + cast(datepart(yy,A.Ngay_cap_nhat_cuoi) as varchar) As NgayTao, A.Tinh_trang As TinhTrang, (C.Ho + ' ' + C.Ten_Lot + ' ' + C.Ten) As NguoiTao, A.Ly_do_reject As LyDoReject FROM DeCuongMonHoc As A INNER JOIN ThanhVien As B ON A.Ma_nguoi_tao = B.ID INNER JOIN ChiTietThanhVien As C ON B.Ten_DN = C.Ten_dang_nhap ORDER BY A.Ngay_cap_nhat_cuoi
iso.sql.getAllDeCuongMonHocAndTenNguoiTaoByMaNguoiTao = SELECT A.ID As MaNoiDungDCMH, A.Ten As TenNoiDungDCMH, A.Ma_nguoi_tao, cast(datepart(mm,A.Ngay_cap_nhat_cuoi) as varchar) + '-' + cast(datepart(dd,A.Ngay_cap_nhat_cuoi) as varchar) + '-' + cast(datepart(yy,A.Ngay_cap_nhat_cuoi) as varchar) As NgayTao, A.Tinh_trang As TinhTrang, (C.Ho + ' ' + C.Ten_Lot + ' ' + C.Ten) As NguoiTao, A.Ly_do_reject As LyDoReject FROM DeCuongMonHoc As A INNER JOIN ThanhVien As B ON A.Ma_nguoi_tao = B.ID INNER JOIN ChiTietThanhVien As C ON B.Ten_DN = C.Ten_dang_nhap WHERE A.ID = ? ORDER BY A.Ngay_cap_nhat_cuoi 
iso.sql.getDeCuongMonHocByID = SELECT A.ID As MaDeCuongMonHoc, A.Ten As TenDeCuongMonHoc, A.Ma_mon_hoc As MaMonHoc, A.Ly_thuyet As LyThuyet, A.Thuc_hanh As ThucHanh, A.Kiem_tra As KiemTra, A.Tinh_chat_mon_hoc As TinhChatMonHoc, A.Vi_tri_mon_hoc As ViTriMonHoc, A.Muc_tieu_1 As MucTieu1, A.Muc_tieu_2 As MucTieu2, A.Muc_tieu_3 As MucTieu3, A.Muc_tieu_4 As MucTieu4, A.Dieu_kien_1 As DieuKien1, A.Dieu_kien_2 As DieuKien2, A.Dieu_kien_3 As DieuKien3, A.Dieu_kien_4 As DieuKien4, A.Phuong_phap_1 As PhuongPhap1, A.Phuong_phap_2 As PhuongPhap2, A.Phuong_phap_3 As PhuongPhap3, A.Ma_Nguoi_Tao As MaNguoiTao, convert(varchar(20),A.Ngay_tao,110) As NgayTao, convert(varchar(20),A.Ngay_tao,108) As GioTao, A.Ma_Nguoi_Duyet As MaNguoiDuyet, convert(varchar(20),A.Ngay_duyet,110) As NgayDuyet, convert(varchar(20),A.Ngay_duyet,108) As GioDuyet, A.Tinh_Trang As TinhTrang, convert(varchar(20),A.Ngay_cap_nhat_cuoi,110) As NgayCapNhatCuoi, convert(varchar(20),A.Ngay_cap_nhat_cuoi,108) As GioCapNhatCuoi, A.Ly_do_reject As LyDoReject, A.Ten_khoa As TenKhoa, ISNULL(A.User1,0) as User1, A.User2, A.User3, A.User4, A.User5, (C.Ho + ' ' + C.Ten_Lot + ' ' + C.Ten) As NguoiTao, ISNULL((E.Ho + ' ' + E.Ten_Lot + ' ' + E.Ten),'') As NguoiDuyet, A.Ma_chuong_trinh As MaChuongTrinh, A.So_buoi_hoc_trong_tuan As SoBuoi, A.So_tiet_hoc_mot_buoi As SoTiet,  A.Kieu_bien_soan As KieuBienSoan, Convert(varchar(10),A.Ngay_gui, 110) As NgayGui, Convert(varchar(10),A.Ngay_gui, 108) As GioGui, F.Ten_mon_hoc As TenMonHoc, G.Tinh_trang As TinhTrangChuongTrinh, G.Ma_nguoi_tao AS MaNguoiTaoChuongTrinh FROM DeCuongMonHoc As A Inner join ThanhVien As B On A.Ma_nguoi_tao = B.ID Inner join ChiTietThanhVien As C on B.Ten_DN = C.Ten_dang_nhap Left join ThanhVien As D On A.Ma_nguoi_duyet = D.ID Left join ChiTietThanhVien As E on D.Ten_DN = E.Ten_dang_nhap INNER JOIN MonHoc AS F ON A.Ma_mon_hoc = F.ID INNER JOIN ChuongTrinhDaoTao As G ON A.Ma_chuong_trinh = G.ID WHERE A.ID= ?
iso.sql.duyetDeCuongMonHocByMaDeCuong = Update DeCuongMonHoc Set Ma_nguoi_duyet=?, Tinh_Trang = ?, Ngay_duyet = getdate(), Ly_do_reject = ? Where ID = ?
iso.sql.getAllDeCuongMonHocApproved = SELECT A.ID As MaDeCuongMonHoc, A.Ten As TenDeCuongMonHoc , A.Ma_mon_hoc As MaMonHoc, A.Ly_thuyet As LyThuyet, A.Thuc_hanh As ThucHanh, A.Kiem_tra As KiemTra, A.Tinh_chat_mon_hoc As TinhChatMonHoc, A.Vi_tri_mon_hoc As ViTriMonHoc, A.Muc_tieu_1 As MucTieu1, A.Muc_tieu_2 As MucTieu2, A.Muc_tieu_3 As MucTieu3, A.Muc_tieu_4 As MucTieu4, A.Dieu_kien_1 As DieuKien1, A.Dieu_kien_2 As DieuKien2, A.Dieu_kien_3 As DieuKien3, A.Dieu_kien_4 As DieuKien4, A.Phuong_phap_1 As PhuongPhap1, A.Phuong_phap_2 As PhuongPhap2, A.Phuong_phap_3 As PhuongPhap3, A.Ma_Nguoi_Tao As MaNguoiTao, convert(varchar(20),A.Ngay_tao,110) As NgayTao, convert(varchar(20),A.Ngay_tao,108) As GioTao, A.Ma_Nguoi_Duyet As MaNguoiDuyet, convert(varchar(20),A.Ngay_duyet,110) As NgayDuyet, convert(varchar(20),A.Ngay_duyet,108) As GioDuyet, A.Tinh_Trang As TinhTrang, convert(varchar(20),A.Ngay_cap_nhat_cuoi,110) As NgayCapNhatCuoi, convert(varchar(20),A.Ngay_cap_nhat_cuoi,108) As GioCapNhatCuoi, A.Ly_do_reject As LyDoReject, A.Ten_khoa As TenKhoa, A.User1, A.User2, A.User3, A.User4, A.User5, (C.Ho + ' ' + C.Ten_Lot + ' ' + C.Ten) As NguoiTao, ISNULL((E.Ho + ' ' + E.Ten_Lot + ' ' + E.Ten),'') As NguoiDuyet, A.Ma_chuong_trinh As MaChuongTrinh, A.So_buoi_hoc_trong_tuan As SoBuoi, A.So_tiet_hoc_mot_buoi As SoTiet,  A.Kieu_bien_soan As KieuBienSoan, Convert(varchar(10),A.Ngay_gui, 110) As NgayGui, Convert(varchar(10),A.Ngay_gui, 108) As GioGui, F.Ten_mon_hoc As TenMonHoc FROM DeCuongMonHoc As A Inner join ThanhVien As B On A.Ma_nguoi_tao = B.ID Inner join ChiTietThanhVien As C on B.Ten_DN = C.Ten_dang_nhap Left join ThanhVien As D On A.Ma_nguoi_duyet = D.ID Left join ChiTietThanhVien As E on D.Ten_DN = E.Ten_dang_nhap INNER JOIN MonHoc AS F ON A.Ma_mon_hoc = F.ID WHERE A.Tinh_trang = ?
iso.sql.getAllDeCuongMonHocApprovedByMaChuongTrinh = SELECT A.ID As MaDeCuongMonHoc, A.Ten As TenDeCuongMonHoc, A.Ma_mon_hoc As MaMonHoc, B.Ten_mon_hoc As TenMonHoc, A.Ly_thuyet As LyThuyet, A.Thuc_hanh As ThucHanh, A.Kiem_tra As KiemTra, A.Kieu_bien_soan As KieuBienSoan, A.So_tiet_hoc_mot_buoi As SoTiet, C.Ly_thuyet As LyThuyetCTMH, C.Thuc_hanh As ThucHanhCTMH FROM DeCuongMonHoc As A INNER JOIN MonHoc As B ON A.Ma_mon_hoc = B.ID INNER JOIN ChiTietMonHocCTDT As C ON A.Ma_chuong_trinh = C.Ma_chuong_trinh and A.Ma_mon_hoc = C.Ma_mon_hoc WHERE A.Tinh_trang = ? and A.Ma_chuong_trinh = ? ORDER BY B.Ten_mon_hoc 
iso.sql.getSoDongByMaChuongTrinh = Select count(*) As SoDong From NoiDungDCMH Where Ma_de_cuong = ?
iso.sql.getDCMHApproveByMaCTDTAndMaMonHoc=SELECT A.ID As MaDeCuongMonHoc, A.Ten As TenDeCuongMonHoc, A.Ma_mon_hoc As MaMonHoc, A.Ly_thuyet As LyThuyet, A.Thuc_hanh As ThucHanh, A.Kiem_tra As KiemTra, A.Tinh_chat_mon_hoc As TinhChatMonHoc, A.Vi_tri_mon_hoc As ViTriMonHoc, A.Muc_tieu_1 As MucTieu1, A.Muc_tieu_2 As MucTieu2, A.Muc_tieu_3 As MucTieu3, A.Muc_tieu_4 As MucTieu4, A.Dieu_kien_1 As DieuKien1, A.Dieu_kien_2 As DieuKien2, A.Dieu_kien_3 As DieuKien3, A.Dieu_kien_4 As DieuKien4, A.Phuong_phap_1 As PhuongPhap1, A.Phuong_phap_2 As PhuongPhap2, A.Phuong_phap_3 As PhuongPhap3, A.Ma_Nguoi_Tao As MaNguoiTao, convert(varchar(20),A.Ngay_tao,110) As NgayTao, convert(varchar(20),A.Ngay_tao,108) As GioTao, A.Ma_Nguoi_Duyet As MaNguoiDuyet, convert(varchar(20),A.Ngay_duyet,110) As NgayDuyet, convert(varchar(20),A.Ngay_duyet,108) As GioDuyet, A.Tinh_Trang As TinhTrang, convert(varchar(20),A.Ngay_cap_nhat_cuoi,110) As NgayCapNhatCuoi, convert(varchar(20),A.Ngay_cap_nhat_cuoi,108) As GioCapNhatCuoi, A.Ly_do_reject As LyDoReject, A.Ten_khoa As TenKhoa, ISNULL(A.User1, 0) as User1, A.User2, A.User3, A.User4, A.User5, (C.Ho + ' ' + C.Ten_Lot + ' ' + C.Ten) As NguoiTao, ISNULL((E.Ho + ' ' + E.Ten_Lot + ' ' + E.Ten),'') As NguoiDuyet, A.Ma_chuong_trinh As MaChuongTrinh, A.So_buoi_hoc_trong_tuan As SoBuoi, A.So_tiet_hoc_mot_buoi As SoTiet,  A.Kieu_bien_soan As KieuBienSoan, Convert(varchar(10),A.Ngay_gui, 110) As NgayGui, Convert(varchar(10),A.Ngay_gui, 108) As GioGui, F.Ten_mon_hoc As TenMonHoc, G.Tinh_trang As TinhTrangChuongTrinh FROM DeCuongMonHoc As A Inner join ThanhVien As B On A.Ma_nguoi_tao = B.ID Inner join ChiTietThanhVien As C on B.Ten_DN = C.Ten_dang_nhap Left join ThanhVien As D On A.Ma_nguoi_duyet = D.ID Left join ChiTietThanhVien As E on D.Ten_DN = E.Ten_dang_nhap INNER JOIN MonHoc AS F ON A.Ma_mon_hoc = F.ID INNER JOIN ChuongTrinhDaoTao As G ON A.Ma_chuong_trinh = G.ID WHERE  A.Ma_mon_hoc=? and A.Ma_chuong_trinh=? and A.Tinh_Trang=2

# Table "KEHOACHGIANGDAY"
#******************************** 
iso.sql.GetAllKeHoachGiangDayApproved = SELECT A.ID As MaKeHoachGiangDay, A.Ten As TenKeHoachGiangDay, A.Ma_nguoi_tao As MaNguoiTao FROM KeHoachGiangDay As A WHERE A.Tinh_trang = ?
iso.sql.GetAllKeHoachGiangDayByMaKHGD = SELECT A.Tinh_trang_ht as TinhTrangHT,A.ID As MaKeHoachGiangDay, A.Ma_mon_hoc As MaMonHoc, M.Ten_mon_hoc As TenMonHoc, A.Ma_lop As MaLop, G.Ki_hieu As KiHieuLop, A.Hoc_ki As HocKi, A.Ma_nam_hoc As MaNamHoc, (convert(varchar(4),H.Nam_bat_dau)+ ' - ' +convert(varchar(4),H.Nam_ket_thuc)) As NamHoc, A.So_ca_thuc_hanh As SoCaThucHanh, A.Ma_giao_vien As MaGiaoVien, (J.Ho+' '+J.Ten_lot+' '+J.Ten) As TenGiaoVien, A.Ma_nguoi_tao As MaNguoiTao, (C.Ho+' '+C.Ten_lot+' '+C.Ten) As TenNguoiTao, convert(varchar(20),A.Ngay_tao,105) As NgayTao, convert(varchar(20),A.Ngay_tao,108) As GioTao, A.Ma_nguoi_duyet As MaNguoiDuyet,ISNULL((F.Ho + ' ' + F.Ten_Lot + ' ' + F.Ten),'') As TenNguoiDuyet, convert(varchar(20),A.Ngay_duyet,105) As NgayDuyet, convert(varchar(20),A.Ngay_duyet,108) As GioDuyet, A.Tinh_trang As TinhTrang, A.So_tiet_moi_buoi As SoTietMoiBuoi, ISNULL(A.So_gio_LT,0) As SoGioLT, ISNULL(A.So_gio_TH,0) As SoGioTH, A.Ten As TenKeHoachGiangDay, A.Ly_do_reject As LyDoReject, convert(varchar(20),A.Ngay_cap_nhat_cuoi,105) As NgayCapNhatCuoi, convert(varchar(20), A.Ngay_cap_nhat_cuoi,108) As GioCapNhatCuoi, A.Truong_khoa As MaTruongKhoa, ISNULL((L.Ho + ' ' + L.Ten_Lot + ' ' + L.Ten),'') As TenTK, convert(varchar(20),A.Ngay_TK_Duyet,105) As NgayTKDuyet, convert(varchar(20), A.Ngay_TK_Duyet,108) As GioTKDuyet, ISNULL(A.User5, 0) as User5 FROM KeHoachGiangDay As A INNER JOIN THANHVIEN As B ON A.Ma_nguoi_tao = B.ID INNER JOIN CHITIETTHANHVIEN As C ON B.Ten_DN = C.Ten_Dang_Nhap INNER JOIN LOPHOC As G ON A.Ma_lop = G.ID INNER JOIN NamHoc As H ON A.Ma_nam_hoc = H.ID INNER JOIN MONHOC As M ON A.Ma_mon_hoc = M.ID LEFT JOIN ThanhVien As E On A.Ma_nguoi_duyet = E.ID LEFT JOIN ChiTietThanhVien As F on E.Ten_DN = F.Ten_dang_nhap LEFT JOIN ThanhVien As I On A.Ma_giao_vien = I.ID LEFT JOIN CHITIETTHANHVIEN As J On I.Ten_DN = J.Ten_dang_nhap LEFT JOIN ThanhVien As K On A.Truong_khoa = K.ID LEFT JOIN ChiTietThanhVien As L on K.Ten_DN = L.Ten_dang_nhap WHERE A.ID = ?
iso.sql.HTDuyetKeHoachGiangDay = Update KEHOACHGIANGDAY Set Ma_nguoi_duyet=?, Tinh_Trang = ?, Ngay_duyet = getdate(), Ly_do_reject = ? Where ID = ?
iso.sql.TKDuyetKeHoachGiangDay = Update KEHOACHGIANGDAY Set Truong_khoa=?, Tinh_Trang = ?, Ngay_TK_duyet = getdate(), Ly_do_reject = ? Where ID = ?
iso.sql.UpdateTinhTrangKeHoachGiangDayByMaKHGD=UPDATE KEHOACHGIANGDAY SET TINH_TRANG=? WHERE ID=?
iso.sql.getTenKeHoachGiangDayByMaKHGD= SELECT TEN FROM KEHOACHGIANGDAY WHERE ID=?
iso.sql.UpdateTinhTrangHTKeHoachGiangDayByMaKHGD=UPDATE KEHOACHGIANGDAY SET TINH_TRANG_HT=? WHERE ID=?
iso.sql.GetTinhTrangHTKeHoachGiangDayByMaKHGD=SELECT TINH_TRANG_HT FROM KEHOACHGIANGDAY WHERE ID=?
iso.sql.GetMaKHGDEnd=SELECT TOP 1 ID as MaKHGD FROM KEHOACHGIANGDAY ORDER BY ID DESC
iso.sql.GetLyDoRejectByMaKHGD=SELECT Ly_do_reject FROM KEHOACHGIANGDAY WHERE ID=?
iso.sql.GetAllKHGD=SELECT A.ID as MaKeHoachGiangDay, A.Ma_Mon_Hoc As MaMonHoc, A.Ma_lop As MaLop FROM KeHoachGiangDay As A 
iso.sql.UpdateNgayGuiByMaKHGD=UPDATE KeHoachGiangDay SET user1=GETDATE() WHERE ID=?


# Table "CHITIETKEHOACHGIANGDAY"
#******************************** 
iso.sql.GetAllChiTietKHGDByMaKHGD = SELECT Muc_Tieu_Bai_Hoc As MucTieuBaiHoc,Nhom,Stt_Noi_Dung as STTNoiDung,Buoi,Thu,Ten_phong As TenPhong,ID As MaChiTietKHGD, Ma_ke_hoach_giang_day As MaKHGD, Ten_chuong As TenChuong, Noi_dung_TH As NoiDungTH, Cong_viec_chuan_bi As CongViecChuanBi, Co_hieu As CoHieu, Tuan As Tuan, Ngay_BD As NgayBD, Ngay_KT As NgayKT, Ngay_cap_nhat_cuoi As NgayCapNhatCuoi, Ma_giao_an As MaGiaoAn FROM CHITIETKHGD WHERE Ma_ke_hoach_giang_day = ? ORDER BY ID
iso.sql.GetAllChiTietKHGDByMaKHGDGroupByTuan = SELECT Ma_ke_hoach_giang_day As MaKHGD, Tuan As Tuan, convert(varchar(20),Ngay_BD,105) As NgayBD, convert(varchar(20),Ngay_KT,105) As NgayKT FROM CHITIETKHGD WHERE ma_ke_hoach_giang_day=? GROUP BY Tuan, Ngay_BD, Ngay_KT,  Ma_ke_hoach_giang_day  ORDER BY Tuan
iso.sql.GetAllChiTietKHGD = SELECT ID as MaChiTietKHGD, Ma_ke_hoach_giang_day As MaKHGD, Tuan As Tuan, convert(varchar(20),Ngay_BD,105) As NgayBD, convert(varchar(20),Ngay_KT,105) As NgayKT, Ten_chuong As TenChuong, Noi_dung_TH As NoiDungTH, Cong_viec_chuan_bi As CongViecChuanBi, Co_hieu As CoHieu, Ma_giao_an As MaGiaoAn FROM CHITIETKHGD
iso.sql.GetChiTietKHGDByMaCTKHGD = SELECT ID As MaChiTietKHGD,Ma_ke_hoach_giang_day As MaKHGD, Tuan As Tuan, convert(varchar(20),Ngay_BD,105) As NgayBD, convert(varchar(20),Ngay_KT,105) As NgayKT, Ten_chuong As TenChuong, Noi_dung_TH As NoiDungTH, Cong_viec_chuan_bi As CongViecChuanBi, Co_hieu As CoHieu, Ma_giao_an As MaGiaoAn FROM CHITIETKHGD WHERE ID=?
iso.sql.GetMaGiaoAnByMaCTKHGD = SELECT Ma_giao_an FROM CHITIETKHGD WHERE ID=?
iso.sql.GetMaKHGDByMaCTKHGD=SELECT Ma_ke_hoach_giang_day as MaKHGD FROM CHITIETKHGD WHERE ID=?
iso.sql.IsMaCTKHGD= SELECT COUNT(*) AS COUNT FROM CHITIETKHGD WHERE ID=?
iso.sql.getTotalChiTietKHGDByMaKHGD=SELECT COUNT(*) AS COUNT FROM CHITIETKHGD WHERE MA_KE_HOACH_GIANG_DAY=?
iso.sql.getTuanByMaKHGD=SELECT Tuan FROM CHITIETKHGD WHERE MA_KE_HOACH_GIANG_DAY=?


# Table "LOP HOC"
#********************************
iso.sql.getAllLopByMaChuongTrinhApproved = SELECT C.ID AS MaChuongTrinh, A.ID AS MaLop, A.Ki_hieu As KiHieu, C.Ten_nghe As TenChuyenNganh, B.Nam_bat_dau As NamBatDau, D.Ghi_chu AS GhiChu  FROM LopHoc AS A INNER JOIN QuyetDinhMoLop AS B ON A.Ma_quyet_dinh = B.ID INNER JOIN ChuongTrinhDaoTao AS C ON C.Ma_quyet_dinh = B.ID and A.Ma_chuyen_nganh = C.Ma_nghe INNER JOIN MoChuyenNganh AS D ON A.Ma_chuyen_nganh = D.Ma_chuyen_nganh and A.Ma_quyet_dinh = D.Ma_quyet_dinh WHERE C.Tinh_trang = ?
iso.sql.getAllKiHieuLop = SELECT A.ID As MaLop, A.Ma_chuyen_nganh As MaChuyenNganh, A.Ki_hieu As KiHieu, A.Ma_lop_truong As MaLopTruong, A.Ma_quyet_dinh As MaQuyetDinh From LopHoc As A
iso.sql.getAllKiHieuLopAndMaChuongTrinh = SELECT A.ID As MaLop, A.Ma_chuyen_nganh As MaChuyenNganh, A.Ki_hieu As KiHieu, A.Ma_lop_truong As MaLopTruong, A.Ma_quyet_dinh As MaQuyetDinh, B.ID As MaChuongTrinhDaoTao From LopHoc As A INNER JOIN CHUONGTRINHDAOTAO As B ON B.Ma_quyet_dinh = A.Ma_quyet_dinh AND B.Ma_nghe = A.Ma_chuyen_nganh INNER JOIN ThoiKhoaBieu As C ON A.ID=C.Ma_Lop GROUP BY A.ID, A.Ma_chuyen_nganh,A.Ki_hieu, A.Ma_lop_truong, A.Ma_quyet_dinh, B.ID  
iso.sql.getMaChuongTrinhByMaLop=SELECT CHUONGTRINHDAOTAO.ID as MaChuongTrinh FROM LOPHOC,CHUONGTRINHDAOTAO WHERE LOPHOC.ID=? AND LOPHOC.MA_QUYET_DINH=CHUONGTRINHDAOTAO.MA_QUYET_DINH AND LOPHOC.MA_CHUYEN_NGANH=CHUONGTRINHDAOTAO.MA_NGHE
iso.sql.getKiHieuByMaLop=SELECT ID As MaLop,Ki_hieu As KiHieu FROM LOPHOC WHERE ID=?

# Table "TUAN LE"
#********************************
iso.sql.getAllTuanLe = select A.ID As MaTuanLe, A.Ma_nam_hoc As MaNamHoc, A.So_thu_tu As SoThuTu, convert(varchar(20),A.Tu_ngay,110) As TuNgay, convert(varchar(20),A.Den_ngay,110) As DenNgay, B.Nam_bat_dau As NamBatDau from tuanle as A inner join namhoc As B On A.Ma_nam_hoc = B.Id
iso.sql.getTuanLeBy2NamBatDau = select A.ID As MaTuanLe, A.Ma_nam_hoc As MaNamHoc, A.So_thu_tu As SoThuTu, convert(varchar(20),A.Tu_ngay,110) As TuNgay, convert(varchar(20),A.Den_ngay,110) As DenNgay, B.Nam_bat_dau As NamBatDau from tuanle as A inner join namhoc As B On A.Ma_nam_hoc = B.Id WHERE B.Nam_bat_dau = ? OR B.Nam_bat_dau = ?
iso.sql.getSoTuanByThangAndNam = select count(*) AS SoTuan From tuanle where datepart(yy, den_ngay) = ? and user1 = ?
iso.sql.getNgayTrongTuanByTuanBatDauVaTuanKetThucVaMaNamHoc = SELECT So_thu_tu AS SoThuTu, Convert(varchar(10), Tu_ngay, 103) AS ThuHai, Convert(varchar(10), DATEADD(DAY, 1, Tu_ngay), 103) AS ThuBa, Convert(varchar(10), DATEADD(DAY, 2, Tu_ngay), 103) AS ThuTu, Convert(varchar(10), DATEADD(DAY, 3, Tu_ngay), 103) AS ThuNam, Convert(varchar(10), DATEADD(DAY, 4, Tu_ngay), 103) AS ThuSau, Convert(varchar(10), DATEADD(DAY, 5, Tu_ngay), 103) AS ThuBay, Convert(varchar(10), Den_ngay, 103) AS ChuNhat FROM TuanLe WHERE Ma_nam_hoc = ? AND So_thu_tu >= ? AND So_thu_tu <= ?
iso.sql.getTuanHienTai = SELECT Convert(varchar(10), Tu_ngay, 101) AS TuNgay, Convert(varchar(10), Den_ngay, 101) AS DenNgay, So_thu_tu AS SoThuTu FROM TuanLe WHERE Cast(convert(varchar(10),Tu_ngay,110) AS Datetime) <= Cast(convert(varchar(10),GETDATE(),110) AS Datetime) AND (Cast(convert(varchar(10),Den_ngay,110) AS Datetime) >= Cast(convert(varchar(10),GETDATE(),110) AS Datetime))

# Table "KE HOACH THANG"
#********************************
iso.sql.getKeHoachThangById = select a.id as MaKeHoachThang, a.thang as Thang, a.Tinh_tramg As TinhTrang, a.nam as Nam, a.noi_nhan as NoiNhan, convert(a.ngay_cap_nhat_cuoi, 110) as NgayCapNhatCuoi, convert(a.ngay_cap_nhat_cuoi, 108) as GioCapNhatCuoi, convert(a.ngay_tao, 110) as NgayTao, convert(a.Ngay_tao, 108) as GioTao, a.ma_nguoi_tao as MaNguoiTao, b.id as MaCongTacThang, b.ma_cong_tac as MaCongTac, a.bo_phan_thuc_hien as BoPhanThucHien, a.ghi_chu as GhiChu, a.bao_cao as BaoCao, convert(a.ngay_duyet, 110) as NgayDuyet, convert(a.Ngay_duyet, 108) as GioDuyet, c.id as MaTinhTrangCongTac, c.thu_tu_tuan as ThuTuTuan, (e.Ho + ' ' + isnull(e.ten_lot, '') + ' ' + e.ten) as TenNguoiTao, (g.Ho + ' ' + isnull(g.ten_lot, '') + ' ' + g.ten) as TenNguoiDuyet, h.Noi_dung_cong_tac AS NoiDungCongTac from keHoachThang as a left join CongTacThang as b on a.id = b.Ma_ke_hoach_thang left join TinhTrangCongTac as c on b.id = c.Ma_cong_tac_thang left join thanhvien as d on a.Ma_nguoi_tao = d.ma_thanh_vien left join chitietthanhvien as e on d.Ten_dn = e.ten_dang_nhap left join ThanhVien as f on a.ma_nguoi_duyet = f.ma_thanh_vien left join chitietthanhvien as g on f.ten_dn = g.ten_dang_nhap left join CongTac as h on b.ma_cong_tac = h.id where a.id = ?
iso.sql.getKeHoachThangSimpleByID = select a.id as MaKeHoachThang, a.Ten_ke_hoach_thang as TenKeHoachThang, convert(varchar(10), a.ngay_duyet, 103) as NgayDuyet, convert(varchar(10), a.Ngay_duyet, 108) as GioDuyet, convert(varchar(10), a.ngay_gui, 103) as NgayGui, convert(varchar(10), a.Ngay_gui, 108) as GioGui, (e.Ho + ' ' + isnull(e.ten_lot, '') + ' ' + e.ten) as TenNguoiTao, (g.Ho + ' ' + isnull(g.ten_lot, '') + ' ' + g.ten) as TenNguoiDuyet FRom KeHoachThang AS A left join thanhvien as d on a.Ma_nguoi_tao = d.ID left join chitietthanhvien as e on d.Ten_dn = e.ten_dang_nhap left join ThanhVien as f on a.ma_nguoi_duyet = f.ID left join chitietthanhvien as g on f.ten_dn = g.ten_dang_nhap where a.id = ?
iso.sql.duyetKeHoachThangByMaKeHoach = UPDATE KeHoachThang SET Ma_nguoi_duyet = ?, Tinh_trang = ?, Ly_do_reject = ?, Ngay_duyet = GETDATE() WHERE ID = ?

# Table "PHONG BAN"
#********************************
iso.sql.getAllPhongBan = SELECT A.ID As MaPhongBan, A.Ki_hieu_phong As KiHieuPhong, A.Vi_tri As ViTri, A.Chuc_nang As ChucNang, A.Suc_chua As SucChua, A.Ngay_cap_nhat_cuoi As NgayCapNhatCuoi, A.User1 As User1, A.User2 As User2, A.User3 As User3, A.User4 As User4, A.User5 As User5 From PhongBan As A

# Table "PHONG BAN"
#********************************
iso.sql.getAllPhongBan = SELECT A.ID As MaPhongBan, A.Ki_hieu_phong As KiHieuPhong, A.Vi_tri As ViTri, A.Chuc_nang As ChucNang, A.Suc_chua As SucChua, A.Ngay_cap_nhat_cuoi As NgayCapNhatCuoi, A.User1 As User1, A.User2 As User2, A.User3 As User3, A.User4 As User4, A.User5 As User5 From PhongBan As A
admin.sql.getAllPhongBan = SELECT A.ID As MaPhongBan, A.Ki_hieu_phong As KiHieu, A.Vi_tri As ViTri, A.Chuc_nang As ChucNang, A.Suc_chua As SucChua From PhongBan As A

# Table "HOC PHAN"
#********************************
#iso.sql.getAllPhongBan = SELECT A.ID As MaPhongBan, A.Ki_hieu_phong As KiHieuPhong, A.Vi_tri As ViTri, A.Chuc_nang As ChucNang, A.Suc_chua As SucChua, A.Ngay_cap_nhat_cuoi As NgayCapNhatCuoi, A.User1 As User1, A.User2 As User2, A.User3 As User3, A.User4 As User4, A.User5 As User5 From PhongBan As A order by A.KiHieuPhong
admin.sql.getAllHocPhan = select A.ID AS MaHocPhan,  A.ten_hoc_phan AS TenHocPhan, A.ghi_chu AS GhiChu from hocphan A

# Table "THOI KHOA BIEU"
#********************************
iso.sql.getThoiKhoaBieuByID = SELECT A.ID As MaThoiKhoaBieu, A.Ten AS TenThoiKhoaBieu, A.Ma_lop As MaLop, A.Tuan_bat_dau As TuanBatDau, A.Tuan_ket_thuc As TuanKetThuc, convert(varchar(20),A.Ngay_bat_dau,110) As NgayBatDau, convert(varchar(20),A.Ngay_ket_thuc,110) As NgayKetThuc, A.Ma_nguoi_tao As MaNguoiTao, convert(varchar(20), A.Ngay_tao, 110) As NgayTao, convert(varchar(20), A.Ngay_tao, 108) As GioTao, A.Ma_nguoi_duyet As MaNguoiDuyet, convert(varchar(20), A.Ngay_duyet, 110) As NgayDuyet, convert(varchar(20), A.Ngay_duyet, 108) As GioDuyet, convert(varchar(20), A.Ngay_cap_nhat_cuoi, 110) As NgayCapNhatCuoi, convert(varchar(20), A.Ngay_cap_nhat_cuoi, 108) As GioCapNhatCuoi, A.Tinh_trang As TinhTrang, A.Ly_do_reject As LyDoReject, A.Hoc_ki As HocKi, A.Nam_bat_dau As NamBatDau, A.Nam_ket_thuc As NamKetThuc, A.User1, A.User2, A.User3, A.User4, A.User5, B.Ki_hieu As KiHieuLop, C.Ten_chuyen_nganh As TenChuyenNganh, (E.Ho + ' ' + E.Ten_Lot + ' ' + E.Ten) As NguoiTao, ISNULL((G.Ho + ' ' + G.Ten_Lot + ' ' + G.Ten),'') As NguoiDuyet, Convert(varchar(10),A.Ngay_gui, 110) As NgayGui, Convert(varchar(10),A.Ngay_gui, 108) As GioGui, H.Ten As TenKhoa From ThoiKhoaBieu As A INNER JOIN LopHoc As B ON A.Ma_lop = B.ID INNER JOIN ChuyenNganh AS C On B.Ma_chuyen_nganh = C.ID INNER JOIN ThanhVien AS D ON A.Ma_nguoi_tao = D.ID INNER JOIN ChiTietThanhVien AS E ON D.Ten_DN = E.Ten_dang_nhap LEFT JOIN ThanhVien As F ON A.Ma_nguoi_duyet = F.ID LEFT JOIN ChiTietThanhVien AS G ON F.Ten_DN = G.Ten_dang_nhap INNER JOIN Khoa_TrungTam AS H ON C.Ma_khoaTT = H.ID Where A.ID = ?
iso.sql.getThoiKhoaBieuSimpleByID = SELECT A.ID AS MaThoiKhoaBieu, A.Ten AS TenThoiKhoaBieu, Convert(varchar(10), A.Ngay_gui, 103) AS NgayGui, Convert(varchar(10), A.Ngay_gui, 108) AS GioGui, Convert(varchar(10), A.Ngay_duyet, 103) AS NgayDuyet, Convert(varchar(10), A.Ngay_duyet, 108) AS GioDuyet, (ISNULL(C.Ho, '') + ' ' + ISNULL(C.Ten_lot, '') + ' ' + ISNULL(C.Ten, '')) AS TenNguoiTao, (ISNULL(E.Ho, '') + ' ' + ISNULL(E.Ten_lot, '') + ' ' + ISNULL(E.Ten, '')) AS TenNguoiDuyet, A.Ma_nguoi_tao AS MaNguoiTao, A.Ma_nguoi_duyet AS MaNguoiDuyet FROM ThoiKhoaBieu AS A LEFT JOIN ThanhVien AS B ON A.Ma_nguoi_tao = B.ID LEFT JOIN ChiTietThanhVien AS C ON B.Ten_DN = C.ten_dang_nhap LEFT JOIN ThanhVien AS D ON A.Ma_nguoi_duyet = D.ID LEFT JOIN ChiTietThanhVien AS E ON D.Ten_DN = E.ten_dang_nhap WHERE A.ID = ?
iso.sql.getAllThoiKhoaBieuApprove = SELECT A.ID As MaThoiKhoaBieu, A.Ten AS TenThoiKhoaBieu, A.Ma_lop As MaLop, A.Tuan_bat_dau As TuanBatDau, A.Tuan_ket_thuc As TuanKetThuc, convert(varchar(20),A.Ngay_bat_dau,110) As NgayBatDau, convert(varchar(20),A.Ngay_ket_thuc,110) As NgayKetThuc, A.Ma_nguoi_tao As MaNguoiTao, convert(varchar(20), A.Ngay_tao, 110) As NgayTao, convert(varchar(20), A.Ngay_tao, 108) As GioTao, A.Ma_nguoi_duyet As MaNguoiDuyet, convert(varchar(20), A.Ngay_duyet, 110) As NgayDuyet, convert(varchar(20), A.Ngay_duyet, 108) As GioDuyet, convert(varchar(20), A.Ngay_cap_nhat_cuoi, 110) As NgayCapNhatCuoi, convert(varchar(20), A.Ngay_cap_nhat_cuoi, 108) As GioCapNhatCuoi, A.Tinh_trang As TinhTrang, A.Ly_do_reject As LyDoReject, A.Hoc_ki As HocKi, A.Nam_bat_dau As NamBatDau, A.Nam_ket_thuc As NamKetThuc, A.User1, A.User2, A.User3, A.User4, A.User5, B.Ki_hieu As KiHieuLop, C.Ten_chuyen_nganh As TenChuyenNganh, (E.Ho + ' ' + E.Ten_Lot + ' ' + E.Ten) As NguoiTao, ISNULL((G.Ho + ' ' + G.Ten_Lot + ' ' + G.Ten),'') As NguoiDuyet, Convert(varchar(10),A.Ngay_gui, 110) + ' ' + Convert(varchar(10),A.Ngay_gui, 108) As NgayGui From ThoiKhoaBieu As A INNER JOIN LopHoc As B ON A.Ma_lop = B.ID INNER JOIN ChuyenNganh AS C On B.Ma_chuyen_nganh = C.ID INNER JOIN ThanhVien AS D ON A.Ma_nguoi_tao = D.ID INNER JOIN ChiTietThanhVien AS E ON D.Ten_DN = E.Ten_dang_nhap LEFT JOIN ThanhVien As F ON A.Ma_nguoi_duyet = F.ID LEFT JOIN ChiTietThanhVien AS G ON F.Ten_DN = G.Ten_dang_nhap Where A.Tinh_trang = ?
iso.sql.duyetThoiKhoaBieuByMaThoiKhoaBieu = Update ThoiKhoaBieu Set Ma_nguoi_duyet=?, Tinh_Trang = ?, Ngay_duyet = getdate(), Ly_do_reject = ? Where ID = ?
iso.sql.capNhatThoiKhoaBieu = UPDATE ThoiKhoaBieu SET Ngay_cap_nhat_cuoi = getdate(), Ly_do_reject = null WHERE ID = ?
iso.sql.getThoiKhoaBieuApproveByMaLop = SELECT A.ID As MaThoiKhoaBieu,A.User1, A.Ten AS TenThoiKhoaBieu, A.Ma_lop As MaLop, A.Tuan_bat_dau As TuanBatDau, A.Tuan_ket_thuc As TuanKetThuc, convert(varchar(20),A.Ngay_bat_dau,110) As NgayBatDau, convert(varchar(20),A.Ngay_ket_thuc,110) As NgayKetThuc, A.Ma_nguoi_tao As MaNguoiTao, convert(varchar(20), A.Ngay_tao, 110) As NgayTao, convert(varchar(20), A.Ngay_tao, 108) As GioTao, A.Ma_nguoi_duyet As MaNguoiDuyet, convert(varchar(20), A.Ngay_duyet, 110) As NgayDuyet, convert(varchar(20), A.Ngay_duyet, 108) As GioDuyet, convert(varchar(20), A.Ngay_cap_nhat_cuoi, 110) As NgayCapNhatCuoi, convert(varchar(20), A.Ngay_cap_nhat_cuoi, 108) As GioCapNhatCuoi, A.Tinh_trang As TinhTrang, A.Ly_do_reject As LyDoReject, A.Hoc_ki As HocKi, A.Nam_bat_dau As NamBatDau, A.Nam_ket_thuc As NamKetThuc, A.User1, A.User2, A.User3, A.User4, A.User5, B.Ki_hieu As KiHieuLop, C.Ten_chuyen_nganh As TenChuyenNganh, (E.Ho + ' ' + E.Ten_Lot + ' ' + E.Ten) As NguoiTao, ISNULL((G.Ho + ' ' + G.Ten_Lot + ' ' + G.Ten),'') As NguoiDuyet, Convert(varchar(10),A.Ngay_gui, 110) As NgayGui, Convert(varchar(10),A.Ngay_gui, 108) As GioGui, H.Ten As TenKhoa From ThoiKhoaBieu As A INNER JOIN LopHoc As B ON A.Ma_lop = B.ID INNER JOIN ChuyenNganh AS C On B.Ma_chuyen_nganh = C.ID INNER JOIN ThanhVien AS D ON A.Ma_nguoi_tao = D.ID INNER JOIN ChiTietThanhVien AS E ON D.Ten_DN = E.Ten_dang_nhap LEFT JOIN ThanhVien As F ON A.Ma_nguoi_duyet = F.ID LEFT JOIN ChiTietThanhVien AS G ON F.Ten_DN = G.Ten_dang_nhap INNER JOIN Khoa_TrungTam AS H ON C.Ma_khoaTT = H.ID Where A.Ma_Lop=? and A.Tinh_trang=?
xemDiem.sql.getAllThoiKhoaBieuApproveByMaLop = select nam_bat_dau as NamBatDau, nam_ket_thuc as NamKetThuc, hoc_ki as HocKi from thoikhoabieu where ma_lop = ? and tinh_trang = ?

# Table "MonHocTKB"
#********************************
iso.sql.getAllMonHocTKB = SELECT A.ID AS MaMonHocTKB, A.Ma_tkb As MaTKB, A.Ma_mon_hoc As MaMonHoc, B.Ten_mon_hoc As TenMonHoc, A.So_ca_thuc_hanh As SoCaTH, A.Ma_giao_vien As MaGiaoVien, (D.Ho + ' ' + D.Ten_lot + ' ' + D.Ten) As TenGiaoVien, A.Tuan_bat_dau_LT As TuanBatDauLT, A.Tuan_bat_dau_TH As TuanBatDauTH, A.Tuan_ket_thuc_LT As TuanKetThucLT, A.Tuan_ket_thuc_TH As TuanKetThucTH FROM MONHOCTKB As A INNER JOIN MONHOC As B ON A.Ma_mon_hoc = B.ID INNER JOIN THANHVIEN As C ON A.Ma_giao_vien = C.ID INNER JOIN CHITIETTHANHVIEN As D ON C.Ten_DN = D.Ten_dang_nhap
iso.sql.getMonHocTKBANDChiTietTKBByMaTKB = SELECT A.ID As MaMonHocTKB, A.Ma_TKB As MaTKB, A.Ma_giao_vien As MaGiaoVien, A.Ma_mon_hoc As MaMonHoc, A.So_ca_thuc_hanh As SoCaThucHanh, A.So_noi_dung As SoNoiDung, A.Tuan_bat_dau_LT As TuanBatDauLT, A.Tuan_ket_thuc_LT As TuanKetThucLT, A.Tuan_bat_dau_TH As TuanBatDauTH, A.Tuan_ket_thuc_TH As TuanKetThucTH, convert(varchar(20),A.Ngay_bat_dau_LT,110) As NgayBatDauLT, convert(varchar(20), A.Ngay_ket_thuc_LT, 110) As NgayKetThucLT, convert(varchar(20), A.Ngay_bat_dau_TH, 110) As NgayBatDauTH, convert(varchar(20), A.Ngay_ket_thuc_TH, 110) As NgayKetThucTH, A.Ghi_chu As GhiChu, F.Kieu_bien_soan As KieuBienSoan, E.Ly_thuyet As LyThuyetCTMH, E.Thuc_hanh AS ThucHanhCTMH, G.Ten_mon_hoc AS TenMonHoc, ISNULL(I.Ho + ' ' + I.Ten_Lot + ' ' + I.Ten,'') AS TenGiaoVien, A.User1 AS MaPhongLT, A.User2 AS MaPhongTH, A.User3 AS SoTiet1Buoi, A.User4 AS SoCaLyThuyet, A.User5, J.ID AS MaChiTiet, J.Buoi As Buoi, J.Thu_trong_tuan As ThuTrongTuan, J.Hinh_thuc_day As HinhThucDay, L.Ki_hieu_phong AS KiHieuPhong, J.Ma_phong AS MaPhong, J.Co_hieu AS CoHieu, J.STT_Noi_Dung AS STTNoiDung, J.So_thu_tu As SoThuTu, J.Nhom AS Nhom, J.Tuan As Tuan, J.Ten_chuong AS TenChuong, J.Muc_tieu As MucTieu, J.User2 AS TietBatDau, M.ID AS MaMonHocTKBThayDoi, M.Tinh_trang AS TinhTrangMonHocTKBThayDoi, N.ID AS MaChiTietTKBThayDoi, N.Tinh_trang AS TinhTrangChiTietTKBThayDoi FROM MonHocTKB As A INNER JOIN ThoiKhoaBieu AS B ON A.Ma_TKB = B.ID INNER JOIN LopHoc AS C ON B.Ma_lop = C.ID INNER JOIN ChuongTrinhDaoTao AS D ON C.Ma_chuyen_nganh = D.Ma_nghe AND C.Ma_quyet_dinh = D.Ma_quyet_dinh INNER JOIN ChiTietMonHocCTDT AS E ON D.ID = E.Ma_chuong_trinh INNER JOIN DeCuongMonHoc AS F ON E.Ma_chuong_trinh = F.Ma_chuong_trinh AND E.Ma_mon_hoc = F.Ma_mon_hoc AND F.Ma_mon_hoc = A.Ma_mon_hoc INNER JOIN MonHoc AS G ON A.Ma_mon_hoc = G.ID INNER JOIN ThanhVien AS H ON A.Ma_giao_vien = H.ID INNER JOIN ChiTietThanhVien AS I ON H.Ten_DN = I.Ten_dang_nhap INNER JOIN ChiTietTKB AS J ON A.ID = J.Ma_mon_hoc_TKB INNER JOIN PhongBan AS L ON J.Ma_phong = L.ID LEFT JOIN MonHocTKBThayDoi AS M ON A.ID = M.Ma_mon_hoc_TKB AND M.Tinh_trang <> '2' LEFT JOIN ChiTietTKBThayDoi AS N ON J.ID = N.Ma_chi_tiet_TKB AND N.Tinh_trang <> '2' WHERE A.Ma_TKB = ? ORDER BY A.User5
iso.sql.getMonHocTKBByMaTKBAndMaGiaoVien = SELECT A.ID As MaMonHocTKB, A.Ma_TKB As MaTKB, A.Ma_giao_vien As MaGiaoVien, A.Ma_mon_hoc As MaMonHoc, convert(varchar(20),A.Ngay_bat_dau_LT,110) As NgayBatDauLT, convert(varchar(20), A.Ngay_ket_thuc_LT, 110) As NgayKetThucLT, convert(varchar(20), A.Ngay_bat_dau_TH, 110) As NgayBatDauTH, convert(varchar(20), A.Ngay_ket_thuc_TH, 110) As NgayKetThucTH, A.Ghi_chu As GhiChu, F.Kieu_bien_soan As KieuBienSoan, E.Ly_thuyet As LyThuyetCTMH, E.Thuc_hanh AS ThucHanhCTMH, G.Ten_mon_hoc AS TenMonHoc, (I.Ho + ' ' + I.Ten_lot + ' ' + I.Ten) AS TenGiaoVien FROM MonHocTKB As A INNER JOIN ThoiKhoaBieu AS B ON A.Ma_TKB = B.ID INNER JOIN LopHoc AS C ON B.Ma_lop = C.ID INNER JOIN ChuongTrinhDaoTao AS D ON C.Ma_chuyen_nganh = D.Ma_nghe AND C.Ma_quyet_dinh = D.Ma_quyet_dinh INNER JOIN ChiTietMonHocCTDT AS E ON D.ID = E.Ma_chuong_trinh INNER JOIN DeCuongMonHoc AS F ON E.Ma_chuong_trinh = F.Ma_chuong_trinh AND E.Ma_mon_hoc = F.Ma_mon_hoc AND F.Ma_mon_hoc = A.Ma_mon_hoc INNER JOIN MonHoc AS G ON A.Ma_mon_hoc = G.ID INNER JOIN ThanhVien AS H ON A.Ma_giao_vien = H.ID INNER JOIN ChiTietThanhVien AS I ON H.Ten_DN = I.Ten_dang_nhap WHERE A.Ma_TKB = ? AND A.Ma_GIAO_VIEN=?
iso.sql.getMonHocTKBByMaTKBAndMaMonHoc = SELECT A.So_Ca_Thuc_Hanh as SoCaThucHanh,A.ID As MaMonHocTKB, A.Ma_TKB As MaTKB, A.Ma_giao_vien As MaGiaoVien, A.Ma_mon_hoc As MaMonHoc, convert(varchar(20),A.Ngay_bat_dau_LT,110) As NgayBatDauLT, convert(varchar(20), A.Ngay_ket_thuc_LT, 110) As NgayKetThucLT, convert(varchar(20), A.Ngay_bat_dau_TH, 110) As NgayBatDauTH, convert(varchar(20), A.Ngay_ket_thuc_TH, 110) As NgayKetThucTH, A.Ghi_chu As GhiChu, F.Kieu_bien_soan As KieuBienSoan, E.Ly_thuyet As LyThuyetCTMH, E.Thuc_hanh AS ThucHanhCTMH, G.Ten_mon_hoc AS TenMonHoc, (I.Ho + ' ' + I.Ten_lot + ' ' + I.Ten) AS TenGiaoVien FROM MonHocTKB As A INNER JOIN ThoiKhoaBieu AS B ON A.Ma_TKB = B.ID INNER JOIN LopHoc AS C ON B.Ma_lop = C.ID INNER JOIN ChuongTrinhDaoTao AS D ON C.Ma_chuyen_nganh = D.Ma_nghe AND C.Ma_quyet_dinh = D.Ma_quyet_dinh INNER JOIN ChiTietMonHocCTDT AS E ON D.ID = E.Ma_chuong_trinh INNER JOIN DeCuongMonHoc AS F ON E.Ma_chuong_trinh = F.Ma_chuong_trinh AND E.Ma_mon_hoc = F.Ma_mon_hoc AND F.Ma_mon_hoc = A.Ma_mon_hoc INNER JOIN MonHoc AS G ON A.Ma_mon_hoc = G.ID INNER JOIN ThanhVien AS H ON A.Ma_giao_vien = H.ID INNER JOIN ChiTietThanhVien AS I ON H.Ten_DN = I.Ten_dang_nhap WHERE A.Ma_TKB = ? And A.Ma_Mon_Hoc=?
iso.sql.getNgayHocAndTuanByMaTKBAndMaMonHocTKB=SELECT Tuan,Ngay_hoc FROM CHITIETTKB AS B WHERE MA_MON_HOC_TKB=? AND MA_TKB=? GROUP BY NGAY_HOC,Tuan
iso.sql.getLopHocByGiaoVien=SELECT B.Ma_lop As MaLop,C.Ki_hieu As KiHieu FROM MonHocTKB AS A,ThoiKhoaBieu AS B,LopHoc As C WHERE A.Ma_giao_vien=? AND B.Id=A.Ma_TKB AND C.ID=B.Ma_Lop GROUP BY B.Ma_lop,C.Ki_hieu
iso.sql.getMonHocByMaLopAndMaGiaoVien=SELECT MH.ID AS MaMonHoc, MH.Ten_mon_hoc AS TenMonHoc FROM MonHoc AS MH WHERE MH.ID IN (SELECT Ma_Mon_Hoc As MaMonHoc FROM ThoiKhoaBieu As A,MonHocTKB AS B WHERE A.Ma_lop=? AND B.Ma_Giao_Vien=? AND A.ID=B.Ma_TKB GROUP BY B.MA_MON_HOC)
iso.sql.getLopByMaGVAndMaMHAndMaTKB=SELECT A.Ma_lop,C.Ki_hieu FROM ThoiKhoaBieu AS A INNER JOIN MonHocTKB As B ON A.ID=B.Ma_TKB AND B.Ma_giao_vien=? AND B.Ma_mon_hoc=? AND B.Ma_TKB=? INNER JOIN LopHoc As C ON C.ID=A.Ma_lop WHERE ( A.Ma_lop ) NOT IN (SELECT ( Ma_lop) FROM KEHOACHGIANGDAY WHERE Ma_giao_vien=B.Ma_giao_vien AND Ma_mon_hoc=B.Ma_mon_hoc)
iso.sql.getThoiKhoaBieuByMaGVAndMaMH=SELECT A.ID As MaTKB,A.user1 As ten,A.Nam_bat_dau As NamBatDau FROM ThoiKhoaBieu AS A INNER JOIN MonHocTKB As B ON A.ID=B.Ma_TKB AND B.Ma_giao_vien=? AND B.Ma_mon_hoc=? GROUP BY A.ID,A.user1,A.Nam_Bat_Dau 
iso.sql.getThoiKhoaBieuByMaGVAndMaMHCoDieuKien=SELECT A.ID As MaTKB,A.user1 As ten,A.Nam_bat_dau As NamBatDau FROM ThoiKhoaBieu AS A INNER JOIN MonHocTKB As B ON A.ID=B.Ma_TKB AND B.Ma_giao_vien=? AND B.Ma_mon_hoc=? WHERE A.Ma_lop not in (SELECT Ma_lop FROM KeHoachGiangDay WHERE Ma_mon_hoc=?) GROUP BY A.ID,A.user1,A.Nam_Bat_Dau

# update ngay bat dau hoc 
iso.sql.updateNgayBatDauHocByID = UPDATE MonHocTKB set user5 = (SELECT TOP 1 Ngay_hoc FROM ChiTietTKB WHERE Ma_mon_hoc_tkb = ? ORDER BY Ngay_hoc) WHERE ID = ?
#

# Table ChiTietTKB
# ********************************
iso.sql.getChiTietTKBByMaTKB = SELECT A.ID As MaChiTietTKB, A.Ma_TKB As MaThoiKhoaBieu, A.Thu_trong_tuan As ThuTrongTuan, A.Buoi As Buoi, A.Hinh_thuc_day As HinhThucDay, A.Nhom As Nhom, A.Ma_phong As MaPhong, A.Ngay_cap_nhat_cuoi As NgayCapNhatCuoi, A.User1, A.User2, A.User3, A.User4, A.User5, B.Ki_hieu_phong As KiHieuPhong FROM ChiTietTKB As A INNER JOIN PhongBan AS B ON A.Ma_phong = B.ID WHERE A.Ma_mon_hoc_TKB = ?
iso.sql.getAllChiTietTKB = SELECT A.ID As MaChiTietTKB, A.Ma_TKB As MaThoiKhoaBieu, A.So_thu_tu As SoThuTu, A.STT_noi_dung As STTNoiDung, A.Tuan As Tuan, A.Ma_mon_hoc_TKB As MaMonHocTKB, A.Thu_trong_tuan As ThuTrongTuan, A.Buoi As Buoi, A.Hinh_thuc_day As HinhThucDay, A.Nhom As Nhom, A.Ma_phong As MaPhong, A.Ngay_cap_nhat_cuoi As NgayCapNhatCuoi, A.User1, A.User2, A.User3, A.User4, A.User5, B.Ki_hieu_phong As KiHieuPhong FROM ChiTietTKB As A INNER JOIN PhongBan AS B ON A.Ma_phong = B.ID 
iso.sql.getChiTietTKBByMaTKBAndMaMonHocTKB=SELECT ISNULL(A.Ten_chuong,'') As TenChuong, B.Ki_hieu_phong as KiHieuPhong,A.ID As MaChiTietTKB,A.Co_hieu As CoHieu,A.Ngay_hoc As NgayHoc, A.Ma_TKB As MaThoiKhoaBieu, A.So_thu_tu As SoThuTu, A.STT_noi_dung As STTNoiDung, A.Tuan As Tuan, A.Ma_mon_hoc_TKB As MaMonHocTKB, A.Thu_trong_tuan As ThuTrongTuan, A.Buoi As Buoi, A.Hinh_thuc_day As HinhThucDay, A.Nhom As Nhom, A.Ma_phong As MaPhong, A.Ngay_cap_nhat_cuoi As NgayCapNhatCuoi, A.User1, A.User2, A.User3, A.User4, A.User5,A.Muc_Tieu As MucTieu  FROM ChiTietTKB As A,PhongBan As B WHERE Ma_TKB=? And Ma_mon_hoc_TKB=? And B.ID=A.Ma_phong ORDER BY Tuan,STT_Noi_Dung,Nhom ASC
iso.sql.capNhatTomTatNoiDung = UPDATE ChiTietTKB SET User3 = ? WHERE ID = ?


#iso.sql.getThuTrongTuanCuaMonHocByMaMonHocTKB = SELECT Distinct A.Buoi As Buoi, A.Thu_trong_tuan As ThuTrongTuan, A.Hinh_thuc_day As HinhThucDay FROM ChiTietTKB As A WHERE A.Ma_mon_hoc_TKB = ?
iso.sql.getThuTrongTuanCuaMonHocByMaMonHocTKB = SELECT A.ID AS MaChiTiet, A.Buoi As Buoi, A.Thu_trong_tuan As ThuTrongTuan, A.Hinh_thuc_day As HinhThucDay, B.Ki_hieu_phong AS KiHieuPhong, A.Ma_phong AS MaPhong, A.Co_hieu AS CoHieu, A.STT_Noi_Dung AS STTNoiDung, A.So_thu_tu As SoThuTu, A.Nhom AS Nhom, A.Tuan As Tuan, A.Ten_chuong AS TenChuong, A.Muc_tieu As MucTieu, A.User2 AS TietBatDau FROM ChiTietTKB As A INNER JOIN PhongBan AS B ON A.Ma_phong = B.ID WHERE A.Ma_mon_hoc_TKB = ?
iso.sql.getSoTuanMonHocTKB = SELECT ((MAX(Tuan)+1) - MIN(Tuan)) As SoTuan, Ma_mon_hoc_TKB As MaMonHocTKB FROM chitietTKB GROUP BY Ma_mon_hoc_TKB 
iso.sql.getAllSoTuanByMaMonHocTKBAndMaTKB=SELECT TUAN FROM CHITIETTKB WHERE MA_MON_HOC_TKB=? AND MA_TKB=?
iso.sql.GetAllSuDungPhongByNamHoc = SELECT distinct A.ID As MaChiTietTKB, A.Buoi As Buoi, A.User1 As MaNamHoc, A.Tuan As Tuan, A.Thu_trong_tuan As ThuTrongTuan, A.Ma_phong As MaPhong, A.Ma_mon_hoc_TKB AS MaMonHocTKB, A.Nhom, A.User2, A.User4, A.User5, B.Ma_mon_hoc AS MaMonHoc, B.Ma_TKB, B.Ma_giao_vien AS MaGiaoVien, B.User3 AS SoTiet1Buoi, A.User2 AS TietBatDau, E.Ma_lop AS MaLop FROM ChiTietTKB AS A INNER JOIN MonHocTKB AS B ON A.Ma_mon_hoc_TKB = B.ID INNER JOIN ThoiKhoaBieu AS C ON B.Ma_TKB = C.ID INNER JOIN NamHoc AS D On C.Nam_bat_dau = D.Nam_bat_dau INNER JOIN ThoiKhoaBieu AS E ON A.Ma_TKB = E.ID WHERE D.ID = ? AND A.Tuan >= ? AND A.Tuan <=?  And B.ID NOT IN (SELECT M.ID FROM MonHocTKB AS M WHERE M.ID = ?) ORDER BY A.Tuan, A.Buoi DESC, A.Thu_trong_tuan, A.Ma_phong, B.User3 DESC

iso.sql.GetNgayHocByMonHocTKBAndMaTKB=SELECT Ngay_Hoc AS NgayHoc FROM CHITIETTKB WHERE Ma_Mon_Hoc_TKB=? And Ma_TKB=?

# Table "SYS_APP"
#********************************
admin.sql.getAllSysApp = SELECT * FROM SYS_APP
admin.sql.updateSysApp = UPDATE SYS_APP SET App_name=?, App_link=?, images=? WHERE ID=?
admin.sql.getSysAppByAppID=SELECT * FROM SYS_APP WHERE ID=?
admin.sql.getFirstSysApp=SELECT TOP 1 * FROM SYS_APP

# Table "SYS_MENU"
#*******************************
admin.sql.getAllSysMenu=SELECT * FROM SYS_MENU WHERE APPID=?

#Table "VaiTro"
#*******************************
admin.sql.getVaiTroChuaPhanQuyen=SELECT * FROM VAITRO WHERE VaiTro.ID not in (SELECT RoleID FROM SYS_ROLE_APP WHERE  SYS_ROLE_APP.APPID=?)
admin.sql.getVaiTroDaPhanQuyen=SELECT RoleID,AppID,Ten_vai_tro FROM SYS_ROLE_APP,VAITRO WHERE SYS_ROLE_APP.APPID=? and SYS_ROLE_APP.ROLEID=VAITRO.ID
admin.sql.getVaiTroMenuChuaPhanQuyen=SELECT * FROM VAITRO WHERE VaiTro.ID not in (SELECT RoleID FROM SYS_ROLE_MENU WHERE  SYS_ROLE_MENU.Menu_ID=?)
admin.sql.getVaiTroMenuDaPhanQuyen=SELECT RoleID,Menu_ID,Ten_vai_tro FROM SYS_ROLE_MENU,VAITRO WHERE SYS_ROLE_MENU.Menu_ID=? and SYS_ROLE_MENU.ROLEID=VAITRO.ID
admin.sql.getSysMenuByMenuID=SELECT * FROM SYS_MENU WHERE ID=?

#Table "Sys_Role_App"
#******************************
admin.sql.insertSysRoleApp=INSERT INTO SYS_ROLE_APP VALUES(?,?,?,?,?,?,?)
admin.sql.deleteRoleSysApp=DELETE SYS_ROLE_APP WHERE RoleID=? AND AppID=?

#Table "Sys_Role_Menu"
admin.sql.insertSysRoleMenu=INSERT INTO SYS_ROLE_MENU VALUES(?,?,?,?,?,?,?)
admin.sql.deleteSysRoleMenu=DELETE SYS_ROLE_MENU WHERE RoleID=? AND Menu_ID=?

# Table "SU DUNG"
#********************************
iso.sql.GetAllSuDungPhongByTuan = SELECT H.Ki_hieu_phong AS KiHieuPhong, L.Nhom AS Nhom, A.Buoi, A.Thu_trong_tuan AS ThuTrongTuan, I.Ten_mon_hoc AS TenMonHoc, ISNULL((K.Ho + ' ' + K.Ten_Lot + ' ' + K.Ten),'') As TenGiaoVien FROM SuDung AS A INNER JOIN MonHocTKB AS B ON B.ID = A.Ma_mon_hoc_TKB INNER JOIN ThoiKhoaBieu AS C ON B.Ma_TKB = C.ID INNER JOIN LopHoc AS D ON C.Ma_lop = D.ID INNER JOIN ChuyenNganh AS E ON D.Ma_chuyen_nganh = E.ID INNER JOIN Khoa_TrungTam AS F ON E.Ma_khoaTT = F.IDINNER JOIN Tuanle AS G ON A.Ma_nam_hoc = G.Ma_nam_hoc AND A.STT_Tuan = G.So_thu_tu INNER JOIN PhongBan AS H ON A.Ma_phong = H.ID INNER JOIN MonHoc AS I ON B.Ma_mon_hoc = I.ID INNER JOIN ThanhVien AS J ON B.Ma_giao_vien = J.ID INNER JOIN ChiTietThanhVien AS K ON J.Ten_DN = K.Ten_dang_nhap INNER JOIN ChiTietTKB AS L ON A.Ma_mon_hoc_TKB = L.Ma_mon_hoc_TKB WHERE G.ID = ? ORDER BY A.Buoi, A.Thu_trong_tuan, A.Ma_phong
iso.sql.GetAllSuDungPhongByMaMonHocTKB = SELECT A.ID AS MaSuDung FROM SuDung AS A WHERE A.Ma_mon_hoc_TKB = ?
# Table CongTac
#********************************
iso.sql.getAllChiTiet = SELECT A.ID As MaCongTac, A.Noi_dung As NoiDung FROM CongTac As A ORDER BY A.Noi_dung
admin.sql.getCongTac = select A.ID AS MaCongTac, A.Noi_dung AS NoiDung, A.Ghi_chu AS GhiChu from congtac A order by Noi_dung

# Table "NAM HOC"
#********************************
iso.sql.getAllNamHoc = SELECT A.ID As MaNamHoc, A.Nam_bat_dau As NamBatDau, A.Nam_ket_thuc As NamKetThuc FROM NamHoc AS A
iso.sql.getNamHocByNamBatDau = SELECT A.ID As MaNamHoc, A.Nam_bat_dau As NamBatDau, A.Nam_ket_thuc As NamKetThuc FROM NamHoc AS A WHERE A.Nam_bat_dau = ? OR A.Nam_bat_dau = ?
iso.sql.getMaxNamHoc = select MAX(Nam_ket_thuc)as year from NamHoc 
iso.sql.getNamHocByMaNamHoc = SELECT Nam_bat_dau AS NamBatDau, Nam_ket_thuc AS NamKetThuc FROM NamHoc WHERE ID = ?

# "INTRO"
iso.sql.GetAllCongTacByNguoiLogin = SELECT C.ID As MaNoiDungChiTietKHDT, D.ID As MaBoPhanThucHien, E.ID As MaNguoiThucHien, A.Ten,C.Noi_dung_cong_tac,D.Ten_bo_phan,E.Ten_thanh_vien,G.Email, (cast(datepart(dd,B.Tu_ngay) as varchar) + '-' + cast(datepart(mm,B.Tu_ngay) as varchar) + '-' + cast(datepart(yyyy,B.Tu_ngay) as varchar)) As Tu_ngay, (cast(datepart(dd,B.Den_ngay) as varchar) + '-' + cast(datepart(mm,B.Den_ngay) as varchar) + '-' + cast(datepart(yyyy,B.Den_ngay) as varchar)) As Den_ngay, E.Tinh_trang_thuc_hien FROM KeHoachDaoTao A INNER JOIN ChiTietKHDT B ON A.ID=B.Ma_ke_hoach INNER JOIN NoiDungChiTietKHDT C ON B.ID=C.Ma_chi_tiet_KHDT INNER JOIN BoPhanThucHienKHDT D ON C.ID=D.Ma_noi_dung_chi_tiet_KHDT INNER JOIN NguoiThucHien E ON D.ID=E.Ma_bo_phan INNER JOIN ThanhVien F ON E.Ma_thanh_vien=F.ID INNER JOIN ChiTietThanhVien G ON F.Ten_DN=G.Ten_dang_nhap WHERE A.Tinh_trang=2 AND F.ID = ? AND (Nam1 = cast(datepart(yyyy,GETDATE()) as varchar) OR Nam2 = cast(datepart(yyyy,GETDATE()) as varchar)) AND (convert(varchar(10),B.Tu_ngay,110) <= convert(varchar(10),GETDATE(),110) AND convert(varchar(10),B.Den_ngay,110) >= convert(varchar(10),GETDATE(),110)) ORDER BY E.Ten_thanh_vien,A.Ten,B.Tu_ngay,B.Den_ngay,C.Noi_dung_cong_tac 

# Table "Lop hoc"
#********************************
admin.sql.showAllLopHoc = select A.ID AS MaLop, A.Ma_lop_truong AS MaLopTruong, E.Ten_chuyen_nganh AS TenChuyenNganh, A.Ki_Hieu AS KiHieu, C.Ho + ' ' + C.Ten_lot + ' ' + C.ten AS HoTenLopTruong,D.ten AS TenQuyetDinh from lophoc A inner join quyetdinhmolop D on A.Ma_quyet_dinh = D.ID inner join chuyennganh E on A.Ma_chuyen_nganh = E.ID left join thanhvien B on A.Ma_lop_truong = B.ID left join chitietthanhvien C on B.Ten_DN = C.ten_dang_nhap 
iso.sql.getNamBatDauByMaLop = select b.nam_bat_dau AS NamBatDau from lophoc as a inner join quyetdinhmolop as b on a.ma_quyet_dinh = b.id where a.id = ?

#Table "GIAO AN"
#********************************
iso.sql.updateTinhTrangGiaoAnByMaGiaoAn= UPDATE GIAOAN SET TINH_TRANG=? WHERE ID=?
iso.sql.getMaAdmin=SELECT ID FROM VAITRO WHERE TEN_VAI_TRO=?
iso.sql.getTotalGiaoAnByMaKHGD=SELECT COUNT(*) AS COUNT FROM GIAOAN WHERE MA_KHGD=? AND TINH_TRANG!=3
iso.sql.updateTinhTrangGiaoAnByMaKHGD=UPDATE GIAOAN SET TINH_TRANG=? WHERE MA_KHGD=?
iso.sql.getTinhTrangGiaoAnByMaGA=SELECT TINH_TRANG FROM GIAOAN WHERE ID=?
iso.sql.getTotalGiaoAnNewByMaKHGD=SELECT COUNT(*) AS COUNT FROM GIAOAN WHERE MA_KHGD=? AND TINH_TRANG=0
iso.sql.getMaGARejectAndNewByMaKHGD=SELECT ID AS MAGA FROM GIAOAN WHERE MA_KHGD=? AND (tinh_trang=0 OR tinh_trang=3)
iso.sql.getKetQuaTimKiemGiaoAn=SELECT * FROM KETQUATIMGIAOAN
iso.sql.dropTableKetQuaTimGiaoAn=DROP TABLE KETQUATIMGIAOAN
iso.sql.updateNgayGuiGiaoAnByMaGiaoAn=UPDATE GIAOAN SET NgayGui=GETDATE() WHERE ID=?
iso.sql.updateRutKinhNghiemByMaGiaoAn=UPDATE GIAOAN SET Rut_Kinh_Nghiem=? WHERE ID=?
iso.sql.getGiaoAnByMaKHGDAndCoHieuLT=SELECT ID,So_giao_an,Cung_co_kien_thuc,Huong_dan_tu_hoc,Tai_lieu_tham_khao,Dan_nhap,ISNULL(Ten_chuong,'') As Ten_chuong FROM GiaoAn WHERE Ma_KHGD=? AND user1='0' 
iso.sql.getGiaoAnByMaKHGDAndCoHieuTH=SELECT ID,So_giao_an,Huong_dan_ban_dau,Huong_dan_ket_thuc,Huong_dan_ren_luyen,Dan_nhap,ISNULL(Ten_chuong,'') As Ten_chuong FROM GiaoAn WHERE Ma_KHGD=? AND user1='1'
iso.sql.getGiaoAnByMaKHGDAndCoHieuTHop=SELECT ID,So_giao_an,Huong_dan_ket_thuc,Huong_dan_tu_hoc,Dan_nhap,ISNULL(Ten_chuong,'') As Ten_chuong FROM GiaoAn WHERE Ma_KHGD=? AND (user1='5' Or user1 = '4') 
iso.sql.updateGiaoAnLTChuaThucHienXongByMaGA=UPDATE GiaoAn SET Cung_co_kien_thuc=?,Huong_dan_tu_hoc=?,Tai_lieu_tham_khao=?,Dan_nhap=? WHERE ID=?
iso.sql.updateGiaoAnTHChuaThucHienXongByMaGA=UPDATE GiaoAn SET Huong_dan_ban_dau=?,Huong_dan_ket_thuc=?,Huong_dan_ren_luyen=?,Dan_nhap=? WHERE ID=?
iso.sql.updateGiaoAnTHopChuaThucHienXongByMaGA=UPDATE GiaoAn SET Huong_dan_ket_thuc=?,Huong_dan_tu_hoc=?,Dan_nhap=? WHERE ID=?
iso.sql.getGiaoAnSoSanh=SELECT A.ID AS MaCTKHGD,A.Ma_ke_hoach_giang_day AS MaKHGD,A.Ma_giao_an AS MaGiaoAn ,B.So_giao_an As SoGiaoAn,C.Hoc_ki As HocKi,C.Ma_nam_hoc AS MaNamHoc,C.Ma_nguoi_tao AS MaNguoiTao,D.Nam_bat_dau AS NamBatDau,E.Ten_dn AS TenDN,(F.Ho + ' '+ F.Ten_lot+' '+F.ten) AS GiaoVienTao,G.Ten_mon_hoc As TenMonHoc, H.ki_hieu As LopHoc FROM ChiTietKHGD AS A INNER JOIN GiaoAn As B ON B.ID=A.Ma_giao_an AND B.So_giao_an=? AND B.Tinh_trang=2 INNER JOIN KeHoachGiangDay AS C ON  C.ID=A.Ma_ke_hoach_giang_day INNER JOIN NamHoc As D ON D.ID=C.Ma_nam_hoc INNER JOIN ThanhVien AS E ON E.ID=C.Ma_nguoi_tao INNER JOIN ChiTietThanhVien AS F ON F.Ten_dang_nhap=E.Ten_dn INNER JOIN MonHoc AS G ON G.ID=C.Ma_mon_hoc AND C.Ma_mon_hoc=? INNER joiN LopHoc AS H ON H.ID=C.Ma_lop WHERE  A.Co_hieu=?


# SendMailListCongTac
#********************************
iso.sql.getAllListCongTacByMaKeHoach = SELECT A.Ten,C.Noi_dung_cong_tac As NoiDungCongTac,D.Ten_bo_phan As TenBoPhan,E.Ten_thanh_vien As TenThanhVien, E.Ma_thanh_vien As MaThanhVien,G.Email,Convert(varchar(20),B.Tu_ngay,110) As TuNgay, Convert(varchar(20), B.Den_ngay, 110) As DenNgay FROM KeHoachDaoTao A INNER JOIN ChiTietKHDT B ON A.ID=B.Ma_ke_hoach INNER JOIN NoiDungChiTietKHDT C ON B.ID=C.Ma_chi_tiet_KHDT INNER JOIN BoPhanThucHienKHDT D ON C.ID=D.Ma_noi_dung_chi_tiet_KHDT INNER JOIN NguoiThucHien E ON D.ID=E.Ma_bo_phan INNER JOIN ThanhVien F ON E.Ma_thanh_vien=F.ID INNER JOIN ChiTietThanhVien G ON F.Ten_DN=G.Ten_dang_nhap WHERE A.Tinh_trang=2 AND A.ID=? ORDER BY E.Ten_thanh_vien,A.Ten,B.Tu_ngay,B.Den_ngay,C.Noi_dung_cong_tac
iso.sql.getAllListCongTacTuanByMaChiTiet = SELECT C.Noi_dung_cong_tac As NoiDungCongTac,D.Ten_bo_phan As TenBoPhan,E.Ten_thanh_vien As TenThanhVien, E.Ma_thanh_vien As MaThanhVien,G.Email,Convert(varchar(20),B.Tu_ngay,110) As TuNgay, Convert(varchar(20), B.Den_ngay, 110) As DenNgay, Convert(varchar(20),C.Ngay,110) As Ngay, C.Thu, C.Gio, C.Phut, C.Ghi_chu As GhiChu FROM ChiTietKHDT B INNER JOIN NoiDungChiTietKHDT C ON B.ID=C.Ma_chi_tiet_KHDT INNER JOIN BoPhanThucHienKHDT D ON C.ID=D.Ma_noi_dung_chi_tiet_KHDT INNER JOIN NguoiThucHien E ON D.ID=E.Ma_bo_phan INNER JOIN ThanhVien F ON E.Ma_thanh_vien=F.ID INNER JOIN ChiTietThanhVien G ON F.Ten_DN=G.Ten_dang_nhap WHERE B.ID=? ORDER BY E.Ten_thanh_vien,B.Tu_ngay,B.Den_ngay,C.Noi_dung_cong_tac
iso.sql.getAllListCongTacBoSungByMaKeHoachAndLanBoSung = SELECT A.Ten,C.Noi_dung_cong_tac As NoiDungCongTac,D.Ten_bo_phan As TenBoPhan,E.Ten_thanh_vien As TenThanhVien, E.Ma_thanh_vien As MaThanhVien,G.Email,Convert(varchar(20),B.Tu_ngay,110) As TuNgay, Convert(varchar(20), B.Den_ngay, 110) As DenNgay FROM KeHoachDaoTao A INNER JOIN ChiTietKHDT B ON A.ID=B.Ma_ke_hoach INNER JOIN NoiDungChiTietKHDT C ON B.ID=C.Ma_chi_tiet_KHDT INNER JOIN BoPhanThucHienKHDT D ON C.ID=D.Ma_noi_dung_chi_tiet_KHDT INNER JOIN NguoiThucHien E ON D.ID=E.Ma_bo_phan INNER JOIN ThanhVien F ON E.Ma_thanh_vien=F.ID INNER JOIN ChiTietThanhVien G ON F.Ten_DN=G.Ten_dang_nhap WHERE A.Tinh_trang=2 AND A.Bo_sung = C.Bo_sung AND A.ID=? AND A.Bo_sung = ? ORDER BY E.Ten_thanh_vien,A.Ten,B.Tu_ngay,B.Den_ngay,C.Noi_dung_cong_tac

 
# Date
#********************************
iso.sql.diffDate=SELECT DATEDIFF(dd ,?,?) As SoNgay
iso.sql.addDate=SELECT DATEADD(dd,?,?) AS NamThangNgay;
iso.sql.getDate = select getdate() as NgayHeThong


#NAM
#********************************
admin.sql.showNam = SELECT A.ID AS MaNam, A.Nam_bat_dau AS NamBatDau, A.Nam_ket_thuc FROM namhoc A
admin.sql.ChiTietByMaNam = SELECT A.ID AS MaTuanLe, A.So_thu_tu AS SoThuTu, B.Nam_bat_dau AS NamBatDau, B.Nam_ket_thuc AS NamKetThuc, A.Tu_ngay AS TuNgay, A.Den_ngay AS DenNgay FROM tuanle A INNER JOIN NamHoc B on A.Ma_nam_hoc = B.ID where A.Ma_nam_hoc = ?
admin.sql.SelectTopIDNamHoc = SELECT TOP 1 id FROM NAMHOC ORDER BY ID

#TaiKhoan
#*******************************
QLTB.sql.getTaiKhoanByMaTaiKhoan=SELECT TAIKHOAN.ID AS MaTaiKhoan,TAIKHOAN.Ngay_lap_the AS NgayLapThe,TAIKHOAN.So_Tai_Khoan AS SoTaiKhoan,TAIKHOAN.Ngan_hang AS NganHang,TaiKhoan.User1,TaiKhoan.User2,TaiKhoan.User3,TaiKhoan.User4,TaiKhoan.User5 FROM TAIKHOAN WHERE TAIKHOAN.ID=?
QLTB.sql.getAllTaiKhoan=SELECT TAIKHOAN.ID AS MaTaiKhoan,TAIKHOAN.Ngay_lap_the AS NgayLapThe,TAIKHOAN.So_Tai_Khoan AS SoTaiKhoan,TAIKHOAN.Ngan_hang AS NganHang,TaiKhoan.User1,TaiKhoan.User2,TaiKhoan.User3,TaiKhoan.User4,TaiKhoan.User5 FROM TAIKHOAN

#Don Vi Tinh
#******************************
QLTB.sql.getAllDonViTinh=SELECT DONVITINH.ID AS MaDonVi,DONVITINH.TEN AS Ten,DONVITINH.GHI_CHU AS GhiChu,DONVITINH.NGAY_CAP_NHAT_CUOI AS NgayCapNhatCuoi,User1,User2,User3,User4,User5 FROM DONVITINH

#Tan Suat
#******************************
QLTB.sql.getAllTanSuat=SELECT TanSuat.ID AS MaTanSuat,TanSuat.TEN AS Ten,TANSUAT.GHI_CHU AS GhiChu,TANSUAT.NGAY_CAP_NHAT_CUOI AS NgayCapNhatCuoi,User1,User2,User3,User4,User5 FROM TANSUAT


#Loai Thiet Bi
#*********************************
QLTB.sql.getAllLoaiThietBi=SELECT A.ID AS MaLoaiThietBi, A.TEN_LOAI AS TenLoaiThietBi, A.GHI_CHU AS GhiChu, A.NGAY_CAP_NHAT_CUOI AS NgayCapNhatCuoi,A.User1,A.User2,A.User3,A.User4,A.User5 FROM LOAITHIETBI as A

#Loai Linh Kien
#*********************************
QLTB.sql.getAllLoaiLinhKien=SELECT A.ID AS MaLoaiLinhKien, A.TEN_LOAI AS TenLoaiLinhKien, A.GHI_CHU AS GhiChu, A.NGAY_CAP_NHAT_CUOI AS NgayCapNhatCuoi,A.User1,A.User2,A.User3,A.User4,A.User5 FROM LoaiLinhKien as A

#Tinh Trang Thiet Bi
#*********************************
qltb.sql.GetAllTinhTrangThietBi=SELECT ID AS MaTinhTrang, Ten AS TenTinhTrang FROM TinhTrangThietBi

#Chi Tiet Thiet Bi
#*********************************
QLTB.sql.getLinhKienByID = SELECT B.Ma_thiet_bi AS MaThietBi, A.Ten_linh_kien AS TenLinhKien, A.Ki_hieu AS KiHieu, A.Ma_loai_linh_kien AS MaLoaiLinhKien, A.Ma_tinh_trang AS MaTinhTrang, A.Ghi_chu AS GhiChu, B.Ma_bo_phan AS MaBoPhan, A.Ma_nguoi_tao AS MaNguoiTao, B.Ma_phong AS MaPhong, A.Ma_nha_cung_cap AS MaNhaCungCap, Convert(varchar(10), A.Ngay_san_xuat, 110) AS NgaySanXuat, Convert(varchar(10), A.Ngay_mua, 110) AS NgayMua, Convert(varchar(10), A.Han_bao_hanh, 110) AS HanBaoHanh, Convert(varchar(10), A.Ngay_bat_dau_su_dung, 110) AS NgayBatDauSuDung, A.Tan_suat_toi_da AS TanSuatToiDa, A.Ma_tan_suat AS MaTanSuat, A.Gia_mua AS GiaMua, A.Dac_tinh_ky_thuat AS DacTinhKyThuat, A.Nguyen_tac_su_dung AS NguyenTacSuDung, A.So_lan_su_dung AS SoLanSuDung, A.So_lan_bao_tri AS SoLanBaoTri, A.Tan_suat_su_dung AS TanSuatSuDung, A.Ngay_cap_nhat_cuoi AS NgayCapNhatCuoi, A.User1 AS User1, A.User2 AS User2, A.User3 AS User3, A.User4 AS User4, A.User5 AS User5, A.ID AS MaChiTietThietBi, D.Ten AS TenThietBi, D.Ki_hieu AS KihieuThietBi FROM ChiTietThietBi AS A LEFT JOIN TrinhTuThayDoiLinhKien AS B ON A.ID = B.Ma_linh_kien AND B.Kiem_tra_ton_tai = '1' INNER JOIN NhaCungCap AS C ON A.Ma_nha_cung_cap = C.ID INNER JOIN ThietBi AS D ON B.Ma_thiet_bi = D.ID WHERE A.ID = ?

#Thiet Bi
#******************************
QLTB.sql.getThietBiByID = SELECT A.ID AS MaThietBi, A.Ten AS TenThietBi, A.Ki_hieu AS KiHieuThietBi, A.Ma_loai AS MaLoaiThietBi, A.Ma_tinh_trang AS MaTinhTrang, A.Ghi_chu AS GhiChu, B.Ma_bo_phan AS MaBoPhan, A.Ma_nguoi_tao AS MaNguoiTao, B.Ma_phong AS MaPhong, A.Ma_nha_cung_cap AS MaNhaCungCap, Convert(varchar(10), A.Ngay_san_xuat, 110) AS NgaySanXuat, Convert(varchar(10), A.Ngay_mua, 110) AS NgayMua, Convert(varchar(10), A.Han_bao_hanh, 110) AS HanBaoHanh, Convert(varchar(10), A.Ngay_bat_dau_su_dung, 110) AS NgayBatDauSuDung, A.Tan_suat_toi_da AS TanSuatToiDa, A.Ma_tan_suat AS MaTanSuat, A.Gia_mua AS GiaMua, A.Dac_tinh_ky_thuat AS DacTinhKyThuat, A.Nguyen_tac_su_dung AS NguyenTacSuDung, A.So_lan_su_dung AS SoLanSuDung, A.So_lan_bao_tri AS SoLanBaoTri, A.Tan_suat_su_dung AS TanSuatSuDung, A.Ngay_cap_nhat_cuoi AS NgayCapNhatCuoi, A.User1 AS User1, A.User2 AS User2, A.User3 AS User3, A.User4 AS User4, A.User5 AS User5, D.ID AS MaChiTietThietBi, D.Ten_linh_kien AS TenLinhKien, D.Ki_hieu AS KiHieuLinhKien, D.So_lan_su_dung AS SoLanSuDungChiTiet, D.So_lan_bao_tri AS SoLanBaoTriChiTiet,	E.Ten AS TenNhaCungCapLinhKien FROM ThietBi AS A LEFT JOIN TrinhTuThayDoiThietBi AS B ON A.ID = B.Ma_thiet_bi AND Kiem_tra_ton_tai = '1' LEFT JOIN TrinhTuThayDoiLinhKien AS C ON A.ID = C.Ma_thiet_bi AND C.Kiem_tra_ton_tai = '1' LEFT JOIN ChiTietThietBi AS D ON C.Ma_linh_kien = D.ID LEFT JOIN NhaCungCap AS E ON D.Ma_nha_cung_cap = E.ID WHERE A.ID = ? ORDER BY D.Ten_linh_kien
QLTB.sql.getThietBiSimpleByID = SELECT A.ID AS MaThietBi, A.Ten AS TenThietBi, A.Ki_Hieu AS KiHieuThietBi, Convert(varchar(10), A.Ngay_bat_dau_su_dung, 110) AS NgayBatDauSuDung, Convert(varchar(10), A.Ngay_mua, 110) AS NgayMua, Convert(varchar(10), A.Ngay_san_xuat, 110) AS NgaySanXuat, Convert(varchar(10), A.Han_bao_hanh, 110) AS HanBaoHanh, A.Ma_tan_suat AS MaTanSuat, A.Ma_nha_cung_cap AS MaNhaCungCap, A.Tan_suat_toi_da AS TanSuatToiDa, B.Ma_phong AS MaPhong, B.Ma_bo_phan AS MaBoPhan FROM ThietBi AS A INNER JOIN TrinhTuThayDoiThietBi AS B ON A.ID = B.Ma_thiet_bi WHERE A.ID = ? AND B.Kiem_tra_ton_tai = '1'
QLTB.sql.getThietBiBaoHuByID = SELECT A.ID AS MaThietBi, A.Ten AS TenThietBi, A.Ki_hieu AS KiHieuThietBi, B.ID AS MaChiTietThietBi, C.Ten_linh_kien AS TenLinhKien, C.Ki_hieu AS KiHieuLinhKien FROM ThietBi AS A LEFT JOIN TrinhTuThayDoiLinhKien AS B ON A.ID = B.Ma_thiet_bi AND B.Kiem_tra_ton_tai = '1' LEFT JOIN ChiTietThietBi AS C ON B.Ma_linh_kien = C.ID WHERE A.ID = ? ORDER BY C.Ten_linh_kien

QLTB.sql.getMaxIDThietBi=SELECT MAX(ID) AS MAX FROM THIETBI
QLTB.sql.getThietBi = select A.ID as MaThietBi, A.Ten as TenThietBi, B.ID as MaTinhTrang, B.Ten as TenTinhTrang, C.Ki_hieu_phong as TenPhongBan, D.Ten_loai as TenLoaiThietBi, A.Ki_hieu as KiHieu from ThietBi as A inner join TinhTrangThietBi as B on B.ID = A.Ma_tinh_trang inner join PhongBan as C on C.ID = A.Ma_phong inner join LoaiThietBi as D on D.ID = A.Ma_loai
QLTB.sql.getMuonThietBi = select A.ID as MaThietBi, C.Ten_loai as TenLoaiThietBi, A.Ten as TenThietBi, A.Ki_hieu as KiHieu, B.Ki_hieu_phong as TenPhongBan from ThietBi as A inner join PhongBan as B on B.ID = A.Ma_phong inner join LoaiThietBi as C on C.ID= A.Ma_loai where A.Ma_tinh_trang != 1 and A.Ma_tinh_trang !=3
QLTB.sql.showDanhSachMuon = select C.ID as MaPhieuMuon, A.ID as MaThietBi, A.Ten as TenThietBi, E.Ho, E.Ten_lot as TenLot, E.Ten as TenThanhVien, C.Thoi_gian_muon as ThoiGianMuon, C.Thoi_gian_tra as ThoiGianTra from ThietBi as A inner join ChiTietPhieuMuon as B on A.ID = B.Ma_thiet_bi inner join PhieuMuonThietBi as C on C.ID = B.Ma_phieu_muon	inner join ThanhVien as D on D.ID = C.Nguoi_muon inner join ChiTietThanhVien as E on E.Ten_dang_nhap = D.Ten_DN where A.Ma_tinh_trang = 3

QLTB.sql.countThietBi = select COUNT(*) AS TotalRows from ThietBi
QLTB.sql.getAllThietBi = select	A.ID as MaThietBi, A.Ten as TenThietBi, A.Ma_loai as MaLoaiThietBi, C.Ten_loai as TenLoaiThietBi, A.Ki_hieu as KiHieu, A.Ma_tinh_trang as MaTinhTrang, B.Ten as TenTinhTrang, A.Ghi_chu as GhiChu, A.Ma_bo_phan as MaBoPhan, D.Ten as TenBoPhan, A.Ma_nguoi_tao as MaNguoiTao, E.Ten_DN as TenNguoiTao, A.Ma_phong as MaPhongBan, F.Ki_hieu_phong as TenPhongBan,A.Ma_nha_cung_cap as MaNhaCungcap, G.Ten as TenNhaCungCap, A.Ngay_san_xuat as NgaySanXuat, A.Ngay_mua as NgayMua, A.Ngay_bao_hanh as NgayBaoHanh, A.Ngay_bat_dau_su_dung as NgayBatDauSuDung, A.Ma_don_vi_tinh as MaDonViTinh, H.Ten as TenDonViTinh, A.Tan_suat_toi_da as TanSuatToiDa, A.Tan_suat_su_dung as TanSuatSuDung, A.Ma_don_vi_tan_suat as MaDonViTanSuat, I.Ten as TenDonViTanSuat, A.Phu_kien as PhuKien, A.Gia_mua as GiaMua, A.Nguyen_tac_su_dung as NguyenTacSuDung, A.Dac_tinh_ky_thuat as DacTinhKyThuat, A.Ngay_cap_nhat_cuoi as NgayCapNhatCuoi, A.So_lan_su_dung as SoLanSuDung, A.So_lan_bao_tri as SoLanBaoTri, A.So_may as SoMay, A.User1, A.User2, A.User3, A.User4, A.user5 from ThietBi as A inner join TinhTrangThietBi as B on B.ID = A.Ma_tinh_trang inner join LoaiThietBi as C on C.ID = A.Ma_loai inner join Khoa_TrungTam as D on D.ID = A.Ma_bo_phan inner join ThanhVien as E on E.ID = A.Ma_nguoi_tao inner join PhongBan as F on F.ID = A.Ma_phong inner join NhaCungCap as G on G.ID = A.Ma_nha_cung_cap inner join DonViTinh as H on H.ID = A.Ma_don_vi_tinh inner join TanSuat as I on I.ID = A.Ma_don_vi_tan_suat
QLTB.sql.getAllTinhTrang = select A.ID as MaTinhTrang, A.Ten as TenTinhTrang, A.Ghi_chu as GhiChu, A.Ngay_cap_nhat_cuoi as NgayCapNhatCuoi from TinhTrangThietBi as A
QLTB.sql.getChiTietThietBiByMaThietBi = select	A.ID as MaThietBi,A.Ten as TenThietBi, K.Ten_linh_kien as TenLinhKien, K.Dung_luong as DungLuong, A.Ma_loai as MaLoaiThietBi, C.Ten_loai as TenLoaiThietBi, A.Ki_hieu as KiHieu, A.Ma_tinh_trang as MaTinhTrang, B.Ten as TenTinhTrang, A.Ghi_chu as GhiChu, A.Ma_bo_phan as MaKhoa, D.Ten as TenKhoa, A.Ma_nguoi_tao as MaNguoiTao, J.Ho as HoThanhVien, J.Ten_lot as TenLot, J.Ten as TenThanhVien, A.Ma_phong as MaPhongBan, F.Ki_hieu_phong as TenPhongBan, A.Ma_nha_cung_cap as MaNhaCungcap, G.Ten as TenNhaCungCap, A.Ngay_san_xuat as NgaySanXuat, A.Ngay_mua as NgayMua, A.Ngay_bao_hanh as NgayBaoHanh, A.Ngay_bat_dau_su_dung as NgayBatDauSuDung, A.Ma_don_vi_tinh as MaDonViTinh, H.Ten as TenDonViTinh, A.Tan_suat_toi_da as TanSuatToiDa, A.Tan_suat_su_dung as TanSuatSuDung, A.Ma_don_vi_tan_suat as MaDonViTanSuat, I.Ten as TenDonViTanSuat, A.Phu_kien as PhuKien, A.Gia_mua as GiaMua, A.Nguyen_tac_su_dung as NguyenTacSuDung, A.Dac_tinh_ky_thuat as DacTinhKyThuat, A.Ngay_cap_nhat_cuoi as NgayCapNhatCuoi, A.So_lan_su_dung as SoLanSuDung, A.So_lan_bao_tri as SoLanBaoTri, A.So_may as SoMay, E.ID as MaThanhVien from ThietBi as A LEFT join ChiTietThietBi as K on K.Ma_thiet_bi = A.ID LEFT join TinhTrangThietBi as B on B.ID = A.Ma_tinh_trang LEFT join LoaiThietBi as C on C.ID = A.Ma_loai LEFT join Khoa_TrungTam as D on D.ID = A.Ma_bo_phan LEFT join ThanhVien as E on E.ID = A.Ma_nguoi_tao LEFT join ChiTietThanhVien as J on J.Ten_dang_nhap = E.Ten_DN LEFT join PhongBan as F on F.ID = A.Ma_phong LEFT join NhaCungCap as G on G.ID = A.Ma_nha_cung_cap LEFT join DonViTinh as H on H.ID = A.Ma_don_vi_tinh LEFT join TanSuat as I on I.ID = A.Ma_don_vi_tan_suat where A.ID = ?
QLTB.sql.getKiHieuThietBi = select DISTINCT A.ID as MaThietBi, A.Ki_hieu as KiHieu From ThietBi as A

QLTB.sql.getThietBiHu = select  a.id as MaThietBi, a.ten as TenThietBi, c.Ho as Ho, c.Ten_lot as TenLot, c.Ten AS Ten, a.Ngay_bat_dau_su_dung as NgayBatDauSuDung, a.Ngay_bao_hanh as NgayBaoHanh, a.So_lan_bao_tri as SoLanBaoTri, a.Ngay_mua as NgayMua from thietbi as a	inner join thanhvien as b on b.ID = a.Ma_nguoi_tao inner join chitietthanhvien as c on b.Ten_DN=c.Ten_dang_nhap	inner join vaitro as d on b.Ma_vai_tro=d.id
 
QLTB.sql.getAllNhaCungCap = select A.ID as MaNhaCungCap, A.Ten as TenNhaCungCap, A.Dia_chi as DiaChi, A.Dien_thoai as DienThoai, A.Email as Email, A.Ma_tai_khoan as MaTaiKhoan, Ghi_chu as GhiChu, Ngay_cap_nhat_cuoi as NgayCapNhatCuoi from NhaCungCap as A
QLTB.sql.getAllTanSuatThietBi= select A.ID as MaThietBi, A.Ten as TenThietBi,	B.Ten_loai as TenLoaiThietBi, C.Ten as TenTinhTrang, D.Ten as TenNhaCungCap, A.Tan_suat_toi_da as TanSuatToiDa,	A.Tan_suat_su_dung as TanSuatSuDung, E.Ten as TenDonViTanSuat, A.So_lan_bao_tri as SoLanBaoTri, A.So_may as SoMay From ThietBi As A	inner join LoaiThietBi as B on B.ID = A.Ma_loai inner join TinhTrangThietBi as C on C.ID = A.Ma_tinh_trang inner join NhaCungCap as D on D.ID = A.Ma_nha_cung_cap inner join TanSuat as E on E.ID = A.Ma_don_vi_tan_suat
QLTB.sql.getChiTietPhieuMuonByMaPhieuMuon = select C.ID as MaPhieuMuon, A.ID as MaThietBi, A.Ten as TenThietBi,B.So_luong as SoLuong,B.Tinh_trang as TinhTrang,B.Ghi_chu as GhiChu from ThietBi as A inner join ChiTietPhieuMuon as B on A.ID = B.Ma_thiet_bi inner join PhieuMuonThietBi as C on C.ID = B.Ma_phieu_muon inner join ThanhVien as D on D.ID = C.Nguoi_muon where C.ID =?
QLTB.sql.getAllThanhVienByVaiTro = SELECT A.ID AS MaThanhVien, A.Ten_DN AS TenDangNhap, A.Mat_khau AS MatKhau, B.Ho as Ho, B.Ten_lot as TenLot, B.Ten AS Ten, C.Ten_vai_tro As TenVaiTro,A.Ma_vai_tro AS MaVaiTro, B.Tinh_trang as TinhTrang, B.Email As Email, A.Ngay_tao AS NgayTao, A.Ngay_truy_cap_cuoi AS NgayTruyCapCuoi, A.Ngay_cap_nhat_cuoi AS NgayCapNhatCuoi, A.User1,A.User2,A.User3,A.User4,A.User5 FROM ThanhVien A INNER JOIN ChiTietThanhVien B ON A.Ten_DN=B.Ten_dang_nhap INNER JOIN VaiTro C ON A.Ma_vai_tro=C.ID WHERE C.ID = ?

QLTB.sql.getKeyAllByMaPhong =  select A.ID as MaThietBi, A.Ten as TenThietBi, B.ID as MaTinhTrang, B.Ten as TenTinhTrang, C.Ki_hieu_phong as TenPhongBan, D.Ten_loai as TenLoaiThietBi, A.Ki_hieu as KiHieu from ThietBi as A inner join TinhTrangThietBi as B on B.ID = A.Ma_tinh_trang inner join PhongBan as C on C.ID = A.Ma_phong inner join LoaiThietBi as D on D.ID = A.Ma_loai
QLTB.sql.getAllKhoa = SELECT A.ID AS MaKhoa,  A.Ten AS TenKhoa , C.Ho + ' ' + C.Ten_lot +' ' + C.Ten As TenTruongKhoa, B.Ten_DN AS NguoiTao FROM Khoa_TrungTam AS A INNER JOIN thanhvien AS B ON A.ma_truong_khoa = B.ID INNER JOIN ChiTietThanhVien AS C ON B.Ten_DN=C.Ten_dang_nhap where A.ID != 16
#thong ke
QLTB.sql.getAllThongKeThietBi = SELECT A.ID as MaThietBi, A.Ten as TenThietBi, B.Ten_loai as TenLoaiThietBi, C.Ten as TenTinhTrang, D.Ten as TenNhaCungCap, A.Tan_suat_toi_da as TanSuatToiDa,	A.Tan_suat_su_dung as TanSuatSuDung, E.Ten as TenDonViTanSuat, A.So_lan_bao_tri as SoLanBaoTri, A.So_may as SoMay, F.Ki_hieu_phong as TenPhongBan FROM ThietBi As A inner join LoaiThietBi as B on B.ID = A.Ma_loai inner join TinhTrangThietBi as C on C.ID = A.Ma_tinh_trang inner join NhaCungCap as D on D.ID = A.Ma_nha_cung_cap inner join TanSuat as E on E.ID = A.Ma_don_vi_tan_suat inner join PhongBan as F on F.ID = A.Ma_phong

#tim kiem
QLTB.sql.getThietBiByMaTinhTrang = select A.ID as MaThietBi, A.Ten as TenThietBi, B.ID as MaTinhTrang, B.Ten as TenTinhTrang, C.ID as MaPhong, C.Ki_hieu_phong as TenPhong, D.ID as MaLoaiThietBi, D.Ten_loai as TenLoaiThietBi, A.Ki_hieu as KiHieu from ThietBi as A inner join TinhTrangThietBi as B on B.ID = A.Ma_tinh_trang inner join PhongBan as C on C.ID = A.Ma_phong inner join LoaiThietBi as D on D.ID = A.Ma_loai where b.id = ?
QLTB.sql.getThietBiByKiHieu = select A.ID as MaThietBi, A.Ten as TenThietBi, B.ID as MaTinhTrang, B.Ten as TenTinhTrang, C.ID as MaPhong, C.Ki_hieu_phong as TenPhong, D.ID as MaLoaiThietBi, D.Ten_loai as TenLoaiThietBi, A.Ki_hieu as KiHieu from ThietBi as A inner join TinhTrangThietBi as B on B.ID = A.Ma_tinh_trang inner join PhongBan as C on C.ID = A.Ma_phong inner join LoaiThietBi as D on D.ID = A.Ma_loai where a.id = ?
QLTB.sql.getAllThongKeByMaNhaCungCap = SELECT A.ID as MaThietBi, A.Ten as TenThietBi, B.Ten_loai as TenLoaiThietBi, C.Ten as TenTinhTrang, D.Ten as TenNhaCungCap, A.Tan_suat_toi_da as TanSuatToiDa,	A.Tan_suat_su_dung as TanSuatSuDung, E.Ten as TenDonViTanSuat, A.So_lan_bao_tri as SoLanBaoTri, A.So_may as SoMay, F.Ki_hieu_phong as TenPhongBan FROM ThietBi As A inner join LoaiThietBi as B on B.ID = A.Ma_loai inner join TinhTrangThietBi as C on C.ID = A.Ma_tinh_trang inner join NhaCungCap as D on D.ID = A.Ma_nha_cung_cap inner join TanSuat as E on E.ID = A.Ma_don_vi_tan_suat inner join PhongBan as F on F.ID = A.Ma_phong where D.ID=?
QLTB.sql.getAllThongKeByMaLoaiThietBi = SELECT A.ID as MaThietBi, A.Ten as TenThietBi, B.Ten_loai as TenLoaiThietBi, C.Ten as TenTinhTrang, D.Ten as TenNhaCungCap, A.Tan_suat_toi_da as TanSuatToiDa,	A.Tan_suat_su_dung as TanSuatSuDung, E.Ten as TenDonViTanSuat, A.So_lan_bao_tri as SoLanBaoTri, A.So_may as SoMay, F.Ki_hieu_phong as TenPhongBan FROM ThietBi As A inner join LoaiThietBi as B on B.ID = A.Ma_loai inner join TinhTrangThietBi as C on C.ID = A.Ma_tinh_trang inner join NhaCungCap as D on D.ID = A.Ma_nha_cung_cap inner join TanSuat as E on E.ID = A.Ma_don_vi_tan_suat inner join PhongBan as F on F.ID = A.Ma_phong where B.ID=?
QLTB.sql.getAllThongKeByMaPhongBan = SELECT A.ID as MaThietBi, A.Ten as TenThietBi, B.Ten_loai as TenLoaiThietBi, C.Ten as TenTinhTrang, D.Ten as TenNhaCungCap, A.Tan_suat_toi_da as TanSuatToiDa,	A.Tan_suat_su_dung as TanSuatSuDung, E.Ten as TenDonViTanSuat, A.So_lan_bao_tri as SoLanBaoTri, A.So_may as SoMay, F.Ki_hieu_phong as TenPhongBan FROM ThietBi As A inner join LoaiThietBi as B on B.ID = A.Ma_loai inner join TinhTrangThietBi as C on C.ID = A.Ma_tinh_trang inner join NhaCungCap as D on D.ID = A.Ma_nha_cung_cap inner join TanSuat as E on E.ID = A.Ma_don_vi_tan_suat inner join PhongBan as F on F.ID = A.Ma_phong where F.ID=?
QLTB.sql.getAllThongKeByMaTinhTrang = SELECT A.ID as MaThietBi, A.Ten as TenThietBi, B.Ten_loai as TenLoaiThietBi, C.Ten as TenTinhTrang, D.Ten as TenNhaCungCap, A.Tan_suat_toi_da as TanSuatToiDa,	A.Tan_suat_su_dung as TanSuatSuDung, E.Ten as TenDonViTanSuat, A.So_lan_bao_tri as SoLanBaoTri, A.So_may as SoMay, F.Ki_hieu_phong as TenPhongBan FROM ThietBi As A inner join LoaiThietBi as B on B.ID = A.Ma_loai inner join TinhTrangThietBi as C on C.ID = A.Ma_tinh_trang inner join NhaCungCap as D on D.ID = A.Ma_nha_cung_cap inner join TanSuat as E on E.ID = A.Ma_don_vi_tan_suat inner join PhongBan as F on F.ID = A.Ma_phong where C.ID=?
QLTB.sql.getThietBiByMaPhong = select A.ID as MaThietBi, A.Ten as TenThietBi, B.ID as MaPhong, B.Ki_hieu_phong as TenPhong, A.Ki_hieu as KiHieu from ThietBi as A inner join PhongBan as B on B.ID = A.Ma_phong where B.id = ?

#Phieu muon thiet bi
QLTB.sql.getPhieuMuonByID = SELECT A.ID AS MaPhieuMuon, A.Nguoi_muon AS MaNguoiMuon, Convert(varchar(10), A.Ngay_muon, 110) AS NgayMuon, D.Ten AS TenKhoa, (IsNull(C.Ho, '') + ' ' + IsNull(C.Ten_lot, '') + ' ' + IsNull(C.Ten, '')) AS TenNguoiMuon FROM PhieuMuonThietBi AS A INNER JOIN ThanhVien AS B ON A.Nguoi_muon = B.ID INNER JOIN ChiTietThanhVien AS C ON B.Ten_DN = C.Ten_dang_nhap INNER JOIN Khoa_trungtam AS D ON B.Ma_bo_phan = D.ID WHERE A.ID = ?
QLTB.sql.getAllPhieuMuonHienTai = SELECT Nguoi_muon AS MaNguoiMuon FROM PhieuMuonThietBi WHERE Cast(Convert(varchar(10), Ngay_muon, 110) AS Datetime) = Cast(Convert(varchar(10), GETDATE(), 110) AS Datetime)

#Di chuyen thiet bi
QLTB.sql.getAllThietBiDiChuyen = select A.ID as MaThietBi, A.Ten as TenThietBi, B.ID as MaPhongBan, B.Ki_hieu_phong as TenPhongBan from ThietBi as A inner join PhongBan as B on A.Ma_phong = B.ID where B.ID=?
QLTB.sql.getAllTenThietBiByMaPhongBan = select A.Ten as TenThietBi from thietbi as a inner join phongban as b on a.Ma_phong = b.ID where A.Ma_phong = ?

#Thay doi thiet bi
QLTB.sql.getDaMuonThietBi = select A.ID as MaThietBi,A.Nguoi_muon as MaThanhVien,C.Ho as HoLot,C.Ten_lot as TenLot,C.Ten as TenThanhVien,E.Ten as TenThietBi from phieumuonthietbi as A inner join thanhvien as B on A.Nguoi_muon = B.ID inner join chitietthanhvien as C on C.Ten_dang_nhap = B.Ten_DN inner join chitietphieumuon as D on D.Ma_phieu_muon = A.ID inner join thietbi as E on E.ID = D.Ma_thiet_bi
QLTB.sql.getThietBiByMaThanhVien = select A.Nguoi_muon as MaThanhVien,C.Ho as HoLot,C.Ten_lot as TenLot,C.Ten as TenThanhVien,E.Ten as TenThietBi from phieumuonthietbi as A inner join thanhvien as B on A.Nguoi_muon = B.ID inner join chitietthanhvien as C on C.Ten_dang_nhap = B.Ten_DN inner join chitietphieumuon as D on D.Ma_phieu_muon = A.ID inner join thietbi as E on E.ID = D.Ma_thiet_bi where B.ID = ?

#DiemDanh
#****************

iso.sql.getThongTinReportGiaoVien = select e.id As MaKhoa, e.Ten as TenKhoa, c.id AS MaLop, c.Ki_hieu AS KiHieuLop, d.Ten_chuyen_nganh, b.id as MaNamHoc, b.Nam_bat_dau as NamBatdau, b.Nam_ket_thuc as NamKetThuc,a.Hoc_ki as HocKy,f.ID as MaMonHocTKB, g.id AS MaMonHoc, g.Ten_mon_hoc AS TenMonHoc, h.id As MaThanhVien, IsNull(i.Ho,'') AS Ho, IsNull(i.Ten_Lot,'') As TenLot, IsNull(i.Ten,'') As Ten from thoikhoabieu a inner join NamHoc b on b.Nam_bat_dau = a.Nam_bat_dau inner join LopHoc c on c.ID = a.Ma_lop inner join ChuyenNganh d on d.ID = c.Ma_chuyen_nganh inner join Khoa_trungtam e on e.ID = d.Ma_khoaTT inner join monhoctkb as f on a.id = f.Ma_tkb inner join monhoc as g on f.ma_mon_hoc = g.id inner join thanhvien as h on f.ma_giao_vien = h.id inner join chitietthanhvien as i on h.Ten_dn = i.ten_dang_nhap where a.tinh_trang = 2 order by e.Ten, c.Ki_hieu, b.Nam_bat_dau, a.hoc_ki, g.ten_mon_hoc, i.Ho, i.Ten_lot, i.Ten
iso.sql.getThongTinReportGiaoVienByMaGiaoVien = select e.id As MaKhoa, e.Ten as TenKhoa, c.id AS MaLop, c.Ki_hieu AS KiHieuLop, d.Ten_chuyen_nganh, b.id as MaNamHoc, b.Nam_bat_dau as NamBatdau, b.Nam_ket_thuc as NamKetThuc,a.Hoc_ki as HocKy,f.ID as MaMonHocTKB, g.id AS MaMonHoc, g.Ten_mon_hoc AS TenMonHoc, h.id As MaThanhVien, IsNull(i.Ho,'') AS Ho, IsNull(i.Ten_Lot,'') As TenLot, IsNull(i.Ten,'') As Ten from thoikhoabieu a inner join NamHoc b on b.Nam_bat_dau = a.Nam_bat_dau inner join LopHoc c on c.ID = a.Ma_lop inner join ChuyenNganh d on d.ID = c.Ma_chuyen_nganh inner join Khoa_trungtam e on e.ID = d.Ma_khoaTT inner join monhoctkb as f on a.id = f.Ma_tkb inner join monhoc as g on f.ma_mon_hoc = g.id inner join thanhvien as h on f.ma_giao_vien = h.id inner join chitietthanhvien as i on h.Ten_dn = i.ten_dang_nhap where a.tinh_trang = 2 and h.id = ? order by e.Ten, c.Ki_hieu, b.Nam_bat_dau, a.hoc_ki, g.ten_mon_hoc, i.Ho, i.Ten_lot, i.Ten

iso.sql.getDiemDanhModel = select a.ngay_bat_dau,a.ngay_ket_thuc,b.ten_mon_hoc,getdate() as ngay_hien_tai,dbo.udf_DayOfWeek(GETDATE()) AS DayOfWeek from diemdanh a inner join monhoc b on a.ma_mon_hoc = b.id 

iso.sql.getGiaoVienByIdSang = select distinct e.Ho + ' ' + e.Ten_lot + ' ' + e.Ten as 'TenGiaoVien',c.Ten_mon_hoc,f.Ten as 'BoPhan',a.Buoi,a.Hinh_thuc_day,b2.Ngay_bat_dau,b2.Ngay_ket_thuc,getdate() as NgayHienTai,dbo.udf_DayOfWeek(GETDATE()) as DayOfWeek,g.Ki_hieu_phong as Ten_phong from chitiettkb a inner join MonHocTKB b on a.Ma_mon_hoc_TKB=b.ID inner join ThoiKhoaBieu b2 on b.Ma_tkb=b2.ID inner join MonHoc c on b.Ma_mon_hoc=c.ID inner join ThanhVien d on b.Ma_giao_vien=d.ID inner join ChiTietThanhVien e on d.Ten_DN=e.Ten_dang_nhap inner join Khoa_TrungTam f on d.Ma_bo_phan=f.ID inner join phongban g on a.ma_phong=g.id where a.Buoi= ? and b.Ma_giao_vien=? and datediff(day,getdate(),a.ngay_hoc) = 0  
iso.sql.getGiaoVienByIdChieu = select distinct e.Ho + ' ' + e.Ten_lot + ' ' + e.Ten as 'TenGiaoVien',c.Ten_mon_hoc,f.Ten as 'BoPhan',a.Buoi,a.Hinh_thuc_day,b2.Ngay_bat_dau,b2.Ngay_ket_thuc,getdate() as NgayHienTai,dbo.udf_DayOfWeek(GETDATE()) as DayOfWeek,g.Ki_hieu_phong as Ten_phong from chitiettkb a inner join MonHocTKB b on a.Ma_mon_hoc_TKB=b.ID inner join ThoiKhoaBieu b2 on b.Ma_tkb=b2.ID inner join MonHoc c on b.Ma_mon_hoc=c.ID inner join ThanhVien d on b.Ma_giao_vien=d.ID inner join ChiTietThanhVien e on d.Ten_DN=e.Ten_dang_nhap inner join Khoa_TrungTam f on d.Ma_bo_phan=f.ID inner join phongban g on a.ma_phong=g.id where a.Buoi= ? and b.Ma_giao_vien=? and datediff(day,getdate(),a.ngay_hoc) = 0 

#**iso.sql.getGiaoVienById = select e.ho,e.ten_lot,e.ten,d.ten_mon_hoc,b.ten as ten_khoa,f.hinh_thuc_day,f.buoi ,getdate() as ngay_hien_tai,dbo.udf_DayOfWeek(GETDATE()) as DayOfWeek,c.ngay_bat_dau,c.ngay_ket_thuc from thanhvien a inner join khoa_trungtam b on a.ma_bo_phan = b.id inner join diemdanh c on a.id = c.ma_giao_vien inner join monhoc d on c.ma_mon_hoc = d.id inner join monhoctkb g on a.id = g.ma_giao_vien inner join chitiettkb f on g.ma_tkb = f.ma_tkb inner join chitietthanhvien e on a.ten_dn = e.ten_dang_nhap where a.id = ? and Convert(varchar(10),f.ngay_hoc,110) = Convert(varchar(10),getdate(),110)
iso.sql.getThanhVienByIdGiaoVienSang = select d.id as ID,d.ten_dn as TenDangNhap,e.ten,e.ho,e.ten_lot,c.tinh_trang as TinhTrang,c.ma_tvdd from diemdanh a inner join thanhviendiemdanh b on a.id = b.ma_diem_danh inner join chitietdiemdanh c on b.id = c.ma_tvdd inner join thanhvien d on d.id = b.ma_thanh_vien inner join chitietthanhvien e on d.ten_dn = e.ten_dang_nhap  where a.ma_giao_vien = ? and c.buoi = ? and Convert(varchar(10),c.Ngay_hoc,110) = Convert(varchar(10), GetDate(), 110)
iso.sql.getThanhVienByIdGiaoVienChieu = select d.id as ID,d.ten_dn as TenDangNhap,e.ten,e.ho,e.ten_lot,c.tinh_trang as TinhTrang,c.ma_tvdd from diemdanh a inner join thanhviendiemdanh b on a.id = b.ma_diem_danh inner join chitietdiemdanh c on b.id = c.ma_tvdd inner join thanhvien d on d.id = b.ma_thanh_vien inner join chitietthanhvien e on d.ten_dn = e.ten_dang_nhap  where a.ma_giao_vien = ? and c.buoi = ? and Convert(varchar(10),c.Ngay_hoc,110) = Convert(varchar(10), GetDate(), 110)
iso.sql.getThanhVienByMaDiemDanh = select ID,Ma_vai_tro as VaiTro from thanhvien where user1 = ?
iso.sql.getMaTVDDByMaThanhVien = select b.id as ID,c.tinh_trang as TinhTrang from diemdanh a inner join thanhviendiemdanh b on a.id = b.ma_diem_danh inner join chitietdiemdanh c on b.id = c.ma_TVDD where ma_thanh_vien = ? and a.ma_giao_vien = ? and Convert(varchar(10),Ngay_hoc,110) = Convert(varchar(10), GetDate(), 110)
iso.sql.getTime = select getdate() as Time
diemDanh.sql.getThanhVienByID = select b.Ho,b.Ten_Lot,b.Ten ,b.Hinh_Thanh_Vien from thanhvien a inner join chitietthanhvien b on a.ten_dn = b.ten_dang_nhap where a.id = ?

#Loai Cong Viec Chuan Bi
#********************************
iso.sql.getAllLoaiCongViecChuanBi=SELECT ID As MaLoai,ten As Ten,User1,User2,User3,User4,User5 FROM LoaiCongViecChuanBi

#Cong Viec Chuan Bi
#********************************
iso.sql.getAllCongViecChuanBi=SELECT ID AS MaCVCB,Ten,Ma_loai As MaLoai,User1,User2,User3,User4,User5 FROM CONGVIECCHUANBI
iso.sql.getAllCongViecChuanBiByMaLoai=SELECT ID AS MaCVCB,Ten,Ma_loai As MaLoai,User1,User2,User3,User4,User5 FROM CONGVIECCHUANBI WHERE Ma_loai=?

#SysParam
#********************************
iso.sql.getNamHeThong = select datepart(yy, getdate()) as NamHeThong

#Phan cong giao vien
#********************************
iso.sql.getAllThoiKhoaBieuApproveByMaLop = select k.ten as TenKhoa, a.ma_lop AS MaLop, h.ki_hieu AS KiHieuLop, B.Ma_giao_vien AS MaGiaoVien, (Isnull(d.Ho, '') + ' ' + Isnull(d.Ten_lot,'') + ' ' + IsNull(d.Ten,'')) As TenGiaoVien, b.ma_mon_hoc as MaMonHoc, e.ten_mon_hoc AS TenMonHoc, f.ly_thuyet as LyThuyet, f.thuc_hanh As ThucHanh from thoikhoabieu as a inner join monhoctkb as b on a.id = b.ma_tkb inner join lophoc as h on a.ma_lop = h.id inner join thanhvien as c on c.id = b.ma_giao_vien inner join chitietthanhvien as d on c.ten_dn = d.ten_dang_nhap inner join monhoc as e on b.ma_mon_hoc = e.id inner join chuongtrinhdaotao as i on i.ma_quyet_dinh = h.ma_quyet_dinh and i.ma_nghe = h.ma_chuyen_nganh inner join chitietmonhocctdt as f on i.id = f.ma_chuong_trinh and b.ma_mon_hoc = f.ma_mon_hoc inner join chuyennganh as j on i.ma_nghe = j.id inner join khoa_trungtam as k on j.ma_khoatt = k.id where k.id = ? and a.nam_bat_dau = ? and a.hoc_ki = ? and a.tinh_trang = ? order by ma_lop, d.Ho, d.Ten_lot, d.ten

#Ke Hoach Thang
#********************************
iso.sql.getKeHoachThangByID = SELECT A.ID AS MaKeHoachThang, A.Ten_ke_hoach_thang AS TenKeHoachThang, A.Thang, A.Nam, A.Noi_nhan AS NoiNhan, A.Tinh_trang AS TinhTrang, A.Ma_nguoi_tao AS MaNguoiTao, A.Ma_nguoi_duyet AS MaNguoiDuyet, CONVERT(VARCHAR(10), A.Ngay_cap_nhat_cuoi, 110) AS NgayCapNhatCuoi, CONVERT(VARCHAR(10), A.Ngay_cap_nhat_cuoi, 108) AS GioCapNhatCuoi, CONVERT(VARCHAR(10), A.Ngay_tao, 110) AS NgayTao, CONVERT(VARCHAR(10), A.Ngay_tao, 108) AS GioTao, CONVERT(VARCHAR(10), A.Ngay_duyet, 110) AS NgayDuyet, CONVERT(VARCHAR(10), A.Ngay_duyet, 108) AS GioDuyet, ISNULL(C.Ho, '') + ' ' + ISNULL(C.Ten_lot, '') + ' ' + ISNULL(C.Ten, '') AS TenNguoiTao, ISNULL(E.Ho, '') + ' ' + ISNULL(E.Ten_lot, '') + ' ' + ISNULL(E.Ten, '') AS TenNguoiDuyet, F.ID AS MaCongTacThang, F.Ma_cong_tac AS MaCongTac, F.Bo_phan_thuc_hien AS BoPhanThucHien, F.Ghi_chu AS GhiChu, F.Bao_cao AS BaoCao, H.Noi_dung AS NoiDungCongTac, G.ID AS MaTinhTrangCongTac, G.Thu_tu_tuan AS ThuTuTuan FROM KeHoachThang AS A LEFT JOIN ThanhVien AS B ON A.Ma_nguoi_tao = B.ID LEFT JOIN ChiTietThanhVien AS C ON B.Ten_DN = C.Ten_dang_nhap LEFT JOIN ThanhVien AS D ON A.Ma_nguoi_duyet = D.ID LEFT JOIN ChiTietThanhVien AS E ON D.Ten_DN = E.Ten_dang_nhap LEFT JOIN CongTacThang AS F ON A.ID = F.Ma_ke_hoach_thang LEFT JOIN TinhTrangCongTac AS G ON F.ID = G.Ma_cong_tac_thang LEFT JOIN CongTac AS H ON F.Ma_cong_tac = H.ID WHERE A.ID = ?

#Ngay Le
#********************************
iso.sql.getAllNgayLe = SELECT ID AS MaNgayLe, Ngay, Thang FROM NgayLe

#Mon hoc TKB thay doi
#********************************
iso.sql.getCountThayDoiMonHocTKB = SELECT COUNT(*) FROM MonHocTKBThayDoi WHERE Ma_to_trinh = -2
iso.sql.getThayDoiMonHocTKBByMaNguoiTaoAndTinhTrangNew = SELECT A.ID AS MaMonHocTKBThayDoi, A.Ma_giao_vien AS MaGiaoVienThayDoi, ISNULL(E.Ho, '') + ' ' + ISNULL(E.Ten_lot, '') + ' ' + ISNULL(E.Ten, '') AS TenGiaoVienThayDoi, B.Ma_giao_vien AS MaGiaoVien, ISNULL(I.Ho, '') + ' ' + ISNULL(I.Ten_lot, '') + ' ' + ISNULL(I.Ten, '') AS TenGiaoVien, C.Ten_mon_hoc AS TenMonHoc FROM MonHocTKBThayDoi AS A LEFT JOIN MonHocTKB AS B ON A.Ma_mon_hoc_TKB = B.ID LEFT JOIN MonHoc AS C ON B.Ma_mon_hoc = C.ID LEFT JOIN ThanhVien AS D ON A.Ma_giao_vien = D.ID LEFT JOIN ChiTietThanhVien AS E ON D.Ten_DN = E.Ten_dang_nhap LEFT JOIN ThanhVien AS F ON B.Ma_giao_vien = F.ID LEFT JOIN ChiTietThanhVien AS I ON F.Ten_DN = I.Ten_dang_nhap WHERE A.Ma_nguoi_tao = ? AND A.Tinh_trang = ?
iso.sql.getThayDoiByMaMonHocTKB = SELECT A.ID AS MaMonHocTKBThayDoi, A.Ma_giao_vien AS MaGiaoVien, A.Tinh_trang AS TinhTrang, ISNULL(C.Ho, '') + ' ' + ISNULL(C.Ten_lot, '') + ' ' + ISNULL(C.Ten, '') AS TenGiaoVien FROM MonHocTKBThayDoi AS A LEFT JOIN ThanhVien AS B ON A.Ma_giao_vien = B.ID LEFT JOIN ChiTietThanhVien AS C ON B.Ten_DN = C.Ten_dang_nhap WHERE A.Ma_mon_hoc_TKB = ? AND A.Tinh_trang <>  '2'

#Chi tiet TKB thay doi
#********************************
iso.sql.getCountThayDoiChiTietTKB = SELECT COUNT(*) FROM ChiTietTKBThayDoi WHERE Ma_to_trinh = -2
iso.sql.getChiTietTKBThayDoiByMaMonHocTKB = SELECT ID AS MaChiTietTKBThayDoi, Ma_Chi_Tiet_TKB AS MaChiTietTKB, Ma_Mon_Hoc_TKB AS MaMonHocTKB, Buoi, Tuan, Thu_trong_tuan AS ThuTrongTuan, Ngay_hoc AS NgayHoc, Ma_phong AS MaPhong, Tinh_trang AS TinhTrang FROM ChiTietTKBThayDoi WHERE Tinh_trang <> '2' AND Ma_mon_hoc_TKB = ?
iso.sql.getChiTietTKBThayDoiByMaNguoiTaoAndTinhTrangNew = SELECT A.Ma_phong AS MaPhongThayDoi, Convert(varchar(10), A.Ngay_hoc, 103) AS NgayHocThayDoi, A.Buoi AS BuoiThayDoi, A.Thu_trong_tuan AS ThuTrongTuanThayDoi, A.Tuan AS TuanThayDoi, B.Ki_hieu_phong AS KiHieuPhongThayDoi, C.Buoi AS Buoi, C.Tuan AS Tuan, C.Thu_trong_tuan AS ThuTrongTuan, C.Ma_phong AS MaPhong, Convert(varchar(10), C.Ngay_hoc, 103) AS NgayHoc, D.Ki_hieu_phong AS KiHieuPhong, F.Ten_mon_hoc AS TenMonHocChiTiet FROM ChiTietTKBThayDoi AS A LEFT JOIN PhongBan AS B ON A.Ma_phong = B.ID LEFT JOIN ChiTietTKB AS C ON A.Ma_chi_tiet_TKB = C.ID LEFT JOIN PhongBan AS D ON C.Ma_phong = D.ID LEFT JOIN MonHocTKB AS E ON C.Ma_mon_hoc_TKB = E.ID LEFT JOIN MonHoc AS F ON E.Ma_mon_hoc = F.ID WHERE A.Ma_nguoi_tao = ? AND A.Tinh_trang = ?

#To Trinh
#********************************
iso.sql.getToTrinhSimpleByID = SELECT A.ID AS MaToTrinh, A.Ten, Convert(varchar(10), A.Ngay_gui, 103) AS NgayGui, Convert(varchar(10), A.Ngay_gui, 108) AS GioGui, Convert(varchar(10), A.Ngay_duyet, 103) AS NgayDuyet, Convert(varchar(10), A.Ngay_duyet, 108) AS GioDuyet, (ISNULL(C.Ho, '') + ' ' + ISNULL(C.Ten_lot, '') + ' ' + ISNULL(C.Ten, '')) AS TenNguoiTao, (ISNULL(E.Ho, '') + ' ' + ISNULL(E.Ten_lot, '') + ' ' + ISNULL(E.Ten, '')) AS TenNguoiDuyet FROM ToTrinh AS A LEFT JOIN ThanhVien AS B ON A.Ma_nguoi_tao = B.ID LEFT JOIN ChiTietThanhVien AS C ON B.Ten_DN = C.ten_dang_nhap LEFT JOIN ThanhVien AS D ON A.Ma_nguoi_duyet = D.ID LEFT JOIN ChiTietThanhVien AS E ON D.Ten_DN = E.ten_dang_nhap WHERE A.ID = ?

#Phan Cong Giao Vien
#********************************
iso.sql.GetBangPhanCongByID = SELECT A.ID AS MaBangPhanCong, A.Hoc_ki AS HocKi, A.Ma_nam_hoc AS MaNamHoc, A.Ma_he_dao_tao AS MaHeDaoTao, A.Ma_quyet_dinh AS MaQuyetDinh, A.Ten AS TenBangPhanCong, A.Tinh_trang AS TinhTrang, CONVERT(VARCHAR(10), A.Ngay_cap_nhat_cuoi, 110) AS NgayCapNhatCuoi, CONVERT(VARCHAR(10), A.Ngay_cap_nhat_cuoi, 108) AS GioCapNhatCuoi, CONVERT(VARCHAR(10), A.Ngay_duyet, 110) AS NgayDuyet, CONVERT(VARCHAR(10), A.Ngay_duyet, 108) AS GioDuyet, (ISNULL(D.Ho, '') + ' ' + ISNULL(D.Ten_lot, '') + ' ' + ISNULL(D.Ten, '')) AS TenNguoiTao, A.Nguoi_tao AS MaNguoiTao, (ISNULL(F.Ho, '') + ' ' + ISNULL(F.Ten_lot, '') + ' ' + ISNULL(F.Ten, '')) AS TenNguoiDuyet, A.Nguoi_duyet AS MaNguoiDuyet, B.ID AS MaChiTietBangPhanCong, G.Ly_thuyet AS LyThuyet, G.Thuc_hanh AS ThucHanh, H.Ten_mon_hoc AS TenMonHoc, ISNULL(J.Ho, '') + ' ' + ISNULL(J.Ten_lot, '') + ' ' + ISNULL(J.Ten, '') AS TenGiaoVien, B.Ma_giao_vien AS MaGiaoVien, B.Nhiem_vu AS NhiemVu, B.Ghi_chu AS GhiChu, M.Ki_hieu AS KiHieuLop, M.ID AS MaLop, N.Ten AS TenKhoa, N.ID AS MaKhoa, L.Ten AS TenHeDaoTao, O.Nam_bat_dau AS NamBatDau, O.Nam_ket_thuc AS NamKetThuc FROM BangPhanCong AS A INNER JOIN ChiTietBangPhanCong AS B ON A.ID = B.Ma_bang_phan_cong LEFT JOIN ThanhVien AS C ON A.Nguoi_tao = C.ID LEFT JOIN ChiTietThanhVien AS D ON C.Ten_DN = D.Ten_dang_nhap LEFT JOIN ThanhVien AS E ON A.Nguoi_duyet = E.ID LEFT JOIN ChiTietThanhVien AS F ON E.Ten_DN = F.Ten_dang_nhap INNER JOIN ChiTietMonHocCTDT AS G ON B.Ma_chi_tiet_CTDT = G.ID INNER JOIN MonHoc AS H ON G.Ma_mon_hoc = H.ID LEFT JOIN ThanhVien AS I ON B.Ma_giao_vien = I.ID LEFT JOIN ChiTietThanhVien AS J ON I.Ten_DN = J.Ten_dang_nhap INNER JOIN LopHoc AS M ON M.ID = B.Ma_lop INNER JOIN Khoa_trungtam AS N ON A.Ma_khoa = N.ID INNER JOIN HeDaoTao AS L ON L.ID = A.Ma_he_dao_tao INNER JOIN NamHoc AS O ON A.Ma_nam_hoc = O.ID WHERE A.ID = ? ORDER BY B.Ma_lop, J.Ho, J.Ten_lot, J.Ten
iso.sql.duyetBangPhanCongByID = UPDATE BangPhanCong SET Nguoi_duyet = ?, Tinh_trang = ?, Ly_do_reject = ?, Ngay_duyet = GETDATE() WHERE ID = ?
iso.sql.getBangPhanCongSimpleByID = SELECT A.ID AS MaBangPhanCong, A.Ten AS TenBangPhanCong, Convert(varchar(10), A.Ngay_gui, 103) AS NgayGui, Convert(varchar(10), A.Ngay_gui, 108) AS GioGui, Convert(varchar(10), A.Ngay_duyet, 103) AS NgayDuyet, Convert(varchar(10), A.Ngay_duyet, 108) AS GioDuyet, (ISNULL(C.Ho, '') + ' ' + ISNULL(C.Ten_lot, '') + ' ' + ISNULL(C.Ten, '')) AS TenNguoiTao, (ISNULL(E.Ho, '') + ' ' + ISNULL(E.Ten_lot, '') + ' ' + ISNULL(E.Ten, '')) AS TenNguoiDuyet, A.Nguoi_tao AS MaNguoiTao, A.Nguoi_duyet AS MaNguoiDuyet FROM BangPhanCong AS A LEFT JOIN ThanhVien AS B ON A.Nguoi_tao = B.ID LEFT JOIN ChiTietThanhVien AS C ON B.Ten_DN = C.ten_dang_nhap LEFT JOIN ThanhVien AS D ON A.Nguoi_duyet = D.ID LEFT JOIN ChiTietThanhVien AS E ON D.Ten_DN = E.ten_dang_nhap WHERE A.ID = ?
iso.sql.GuiHieuTruongByID = UPDATE BangPhanCong SET Ngay_gui = ?, Tinh_trang = ?, Ly_do_reject = NULL WHERE ID = ?
iso.sql.getBangPhanCongApprovedByHocKiAndMaNamHoc = SELECT DISTINCT C.ID AS Malop, C.Ki_hieu AS KiHieuLop, A.ID AS MaBangPhanCong, A.Ten AS TenBangPhanCong, A.Hoc_ki_nam_hoc AS HocKiNamHoc, D.Ten_chuyen_nganh AS TenChuyenNganh, F.Ma_chuong_trinh AS MaChuongTrinh, G.Ghi_chu AS SoHocSinh FROM BangPhanCong AS A INNER JOIN ChiTietBangPhanCong AS B ON A.ID = B.Ma_bang_phan_cong INNER JOIN LopHoc AS C ON B.Ma_lop = C.ID INNER JOIN ChuyenNganh AS D ON C.Ma_chuyen_nganh = D.ID INNER JOIN NamHoc AS E ON A.Ma_nam_hoc = E.ID INNER JOIN ChiTietMonHocCTDT AS F ON B.Ma_chi_tiet_CTDT = F.ID INNER JOIN MoChuyenNganh AS G ON C.Ma_chuyen_nganh = G.Ma_chuyen_nganh and C.Ma_quyet_dinh = G.Ma_quyet_dinh WHERE E.Nam_bat_dau = ? AND A.Hoc_ki = ? AND A.Tinh_trang = ? ORDER BY C.ID

#So len lop
#********************************
iso.sql.getSoLenLopByMaTKB = SELECT A.ID AS MaSoLenLop, A.Ma_TKB AS MaTKB, C.ID AS MaChiTietTKB, B.ID AS MaMonHocTKB, N.Ki_hieu AS KiHieuLop, K.Ten AS TenTrinhDo, O.Ten_chuyen_nganh AS TenNghe, A.Nam_bat_dau AS NamBatDau, A.Khoa AS Khoa, B.Ma_mon_hoc AS MaMonHoc, I.Ten_mon_hoc AS TenMonHoc, B.User3 AS SoTiet, B.Ma_giao_vien AS MaGiaoVien, (ISNULL(L.Ho, '') + ' ' + ISNULL(L.Ten_lot, '') + ' ' + ISNUll(L.Ten, '')) AS TenGiaoVien, Convert(VARCHAR(10), C.Ngay_hoc, 103) AS NgayHoc, C.Co_hieu AS CoHieu, C.User3 AS NoiDungBaiDay, D.MaThanhVien, (ISNULL(H.Ho, '') + ' ' + ISNULL(H.Ten_lot, '') + ' ' + ISNUll(H.Ten, '')) AS TenSinhVien, D.TinhTrangDiHoc FROM SoLenLop AS A INNER JOIN MonHocTKB AS B ON A.Ma_TKB = B.Ma_TKB INNER JOIN ChiTietTKB AS C On B.ID = C.Ma_mon_hoc_TKB INNER JOIN (SELECT A.ID AS MaDiemDanh, A.User2 AS Noi_dung_bai_day, B.Ma_thanh_vien AS MaThanhVien, C.Tinh_trang AS TinhTrangDiHoc, C.Ngay_hoc AS NgayHoc, A.Ma_CT_TKB AS MaTKB, A.Ma_mon_hoc AS MaMonHoc FROM DiemDanh AS A INNER JOIN ThanhVienDiemDanh AS B ON A.ID = B.Ma_diem_danh INNER JOIN ChiTietDiemDanh AS C On B.ID = C.Ma_TVDD WHERE A.Ma_CT_TKB = ?) AS D ON Convert(varchar(10), C.Ngay_hoc, 103) = Convert(varchar(10), D.NgayHoc, 103) AND B.Ma_mon_hoc = D.MaMonHoc INNER JOIN ThanhVien AS G ON D.MaThanhVien = G.ID INNER JOIN ChiTietThanhVien AS H ON G.Ten_DN = H.Ten_dang_nhap INNER JOIN MonHoc AS I ON B.Ma_mon_hoc = I.ID INNER JOIN ThanhVien AS J ON B.Ma_giao_vien = J.ID INNER JOIN ChiTietThanhVien AS L ON J.Ten_DN = L.Ten_dang_nhap INNER JOIN LopHoc AS N ON A.Ma_lop = N.ID INNER JOIN HeDaoTao AS K ON A.Ma_trinh_do = K.ID INNER JOIN ChuyenNganh AS O ON N.Ma_chuyen_nganh = O.ID WHERE A.Ma_TKB = ? ORDER BY I.Ten_mon_hoc, C.Ngay_hoc, C.Nhom
iso.sql.getSoLenLopByMaTKBAndMaGiaoVien = SELECT A.ID AS MaSoLenLop, A.Ma_TKB AS MaTKB, C.ID AS MaChiTietTKB, B.ID AS MaMonHocTKB, N.Ki_hieu AS KiHieuLop, K.Ten AS TenTrinhDo, O.Ten_chuyen_nganh AS TenNghe, A.Nam_bat_dau AS NamBatDau, A.Khoa AS Khoa, B.Ma_mon_hoc AS MaMonHoc, I.Ten_mon_hoc AS TenMonHoc, B.User3 AS SoTiet, B.Ma_giao_vien AS MaGiaoVien, (ISNULL(L.Ho, '') + ' ' + ISNULL(L.Ten_lot, '') + ' ' + ISNUll(L.Ten, '')) AS TenGiaoVien, Convert(VARCHAR(10), C.Ngay_hoc, 103) AS NgayHoc, C.Co_hieu AS CoHieu, C.User3 AS NoiDungBaiDay, D.MaThanhVien, (ISNULL(H.Ho, '') + ' ' + ISNULL(H.Ten_lot, '') + ' ' + ISNUll(H.Ten, '')) AS TenSinhVien, D.TinhTrangDiHoc FROM SoLenLop AS A INNER JOIN MonHocTKB AS B ON A.Ma_TKB = B.Ma_TKB INNER JOIN ChiTietTKB AS C On B.ID = C.Ma_mon_hoc_TKB INNER JOIN (SELECT A.ID AS MaDiemDanh, A.User2 AS Noi_dung_bai_day, B.Ma_thanh_vien AS MaThanhVien, C.Tinh_trang AS TinhTrangDiHoc, C.Ngay_hoc AS NgayHoc, A.Ma_CT_TKB AS MaTKB, A.Ma_mon_hoc AS MaMonHoc FROM DiemDanh AS A INNER JOIN ThanhVienDiemDanh AS B ON A.ID = B.Ma_diem_danh INNER JOIN ChiTietDiemDanh AS C On B.ID = C.Ma_TVDD WHERE Ma_CT_TKB = ?) AS D ON Convert(varchar(10), C.Ngay_hoc, 103) = Convert(varchar(10), D.NgayHoc, 103) AND B.Ma_mon_hoc = D.MaMonHoc INNER JOIN ThanhVien AS G ON D.MaThanhVien = G.ID INNER JOIN ChiTietThanhVien AS H ON G.Ten_DN = H.Ten_dang_nhap INNER JOIN MonHoc AS I ON B.Ma_mon_hoc = I.ID INNER JOIN ThanhVien AS J ON B.Ma_giao_vien = J.ID INNER JOIN ChiTietThanhVien AS L ON J.Ten_DN = L.Ten_dang_nhap INNER JOIN LopHoc AS N ON A.Ma_lop = N.ID INNER JOIN HeDaoTao AS K ON A.Ma_trinh_do = K.ID INNER JOIN ChuyenNganh AS O ON N.Ma_chuyen_nganh = O.ID WHERE A.Ma_TKB = ? AND B.Ma_giao_vien = ? ORDER BY I.Ten_mon_hoc, C.Ngay_hoc, C.Nhom
iso.sql.getThangTheoDoiByMaTKB = SELECT B.ID AS MaTVDD, B.Ma_thanh_vien AS MaSinhVien, (ISNULL(E.Ho, '') + ' ' + ISNULL(E.Ten_lot, '') + ' ' + ISNUll(E.Ten, '')) AS TenSinhVien, C.Tinh_trang AS TinhTrangDiHoc, Convert(VARCHAR(10), C.Ngay_hoc, 103) AS NgayHoc, DATEPART(DAY, C.Ngay_hoc) AS Ngay, DATEPART(MONTH, C.Ngay_hoc) AS Thang, DATEPART(YEAR, C.Ngay_hoc) AS Nam, A.Ma_CT_TKB AS MaTKB FROM DiemDanh AS A INNER JOIN ThanhVienDiemDanh AS B ON A.ID = B.Ma_diem_danh INNER JOIN ChiTietDiemDanh AS C On B.ID = C.Ma_TVDD INNER JOIN ThanhVien AS D ON B.Ma_Thanh_Vien = D.ID INNER JOIN ChiTietThanhVien AS E ON D.Ten_DN = E.Ten_dang_nhap WHERE C.Ngay_hoc < GETDATE()AND A.Ma_CT_TKB = ? ORDER BY DATEPART(YEAR ,C.Ngay_hoc), DATEPART(MONTH, C.Ngay_hoc), E.Ho, E.Ten_lot, E.Ten, C.Ngay_hoc

#Chi Tiet Bang Phan Cong
#********************************
iso.sql.getChiTietBangPhanCongByMaBangPhanCongAndMaLop = SELECT A.Ma_giao_vien AS MaGiaoVien, B.Ma_mon_hoc AS MaMonHoc, (ISNULL(D.Ho, '') + ' ' + ISNULL(D.Ten_lot, '') + ' ' + ISNULL(D.Ten, '')) AS TenGiaoVien FROM ChiTietBangPhanCong AS A INNER JOIN ChiTietMonHocCTDT AS B ON A.Ma_chi_tiet_CTDT = B.ID INNER JOIN ThanhVien AS C ON A.Ma_giao_vien = C.ID LEFT JOIN ChiTietThanhVien AS D ON C.Ten_DN = D.Ten_dang_nhap WHERE A.Ma_bang_phan_cong = ? AND A.Ma_lop = ?